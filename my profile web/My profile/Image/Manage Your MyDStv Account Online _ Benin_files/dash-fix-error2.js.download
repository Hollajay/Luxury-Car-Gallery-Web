riot.tag2('tag-fix-errors-service','<div class="full-view-ss"><section class="content-wrapper Fix-error-section-main clearfix {fixerrorStatus.fullviewclass}"><button type="button" class="payment-close" onclick="{backfix}">X</button><div class="Fix-error-content-section"><div class="Fix-error-package"><div class="Fix-error-package-Error-Code" if="{hideFixErrorPackagesection}"><div class="Fix-error-heading"><h2 class="master-head text-center"><b>{langTranslateApp.fix}</b> {langTranslateApp.dashfixerror}</h2> </div><div class="mb-4" if="{!app.noServicesLoaded}"><!--<h4>{langTranslateApp.dashfixerrorSelect} <b>{langTranslateApp.dashfixerrorPackage}</b></h4>--><h4>{langTranslateApp.fixErrorSelectThe} <b>{langTranslateApp.dashfixerrorSelect}</b></h4> </div><div class="Fix-error-section"><div class="col-md-12"><div class="d-flex relative align-items-center justify-content-between"><span class="arrows-Fix-error"></span></div><div class="Fix-error-slider" style=""><!--<div class="packageItem {package.primaryService.productName}" each="{package in packages}" > <label class="Fix-error-slider-Packages" for="{package.SerialNumber}_radiobtn"> <div class="backgroun-img"></div> <i class="icon-pack icon-{package.primaryService.productCode}"></i> <div class="price"> <span class="package-status-heading">Smartcard Number</span> <span class="package-status"> <label for="Package"> {package.SerialNumber}</label></div> <div class="price"><span class="package-status"><label for="Package"> {package.primaryService.status}</label><span class="{package.primaryService.status}"></span></span> </div> <div class="bottomBar pricebar" > <!--<div class="Get-now" style="display: none;">Select Package<input class="package-input" id="{package.SerialNumber}_radiobtn" alt="{package.primaryService.status}" name="test" type="radio" style="position: absolute; opacity: 0;" onchange="{OnPackageClick}" value="{package.SerialNumber}"></div>--><!-- <div class="Get-now">Selected This Smartcard <input class="package-input" id="{package.SerialNumber}_radiobtn" alt="{package.primaryService.status}" name="test" type="radio" style="position: absolute;" onchange="{OnPackageClick}" value="{package.SerialNumber}"></div> <div class="Konw-more"></div> </div> </label> </div>--><div class="smartcardItem {package.primaryService.productCode}-package {package.primaryService.productName}-package fix-package" each="{package in packages}"><label for="{package.SerialNumber}_radiobtn"><div class="smartcard-section-top"><div class="col-lg-6 col-sm-6 col-md-6 col-xs-6 decoder-img-left"><img src="/media/7655/explora-1.png"></div><div class="smartcard fix-smt col-lg-6 col-sm-6 col-md-6 col-xs-6">{langTranslateApp.loginSmartcardNumber}<div class="number">{package.SerialNumber}</div></div><div class="clearfix"></div></div><div class="smartcard-section-bottom {\'package-details contents \' + ptDashSmallFontClass}"><div class="col-lg-4 col-sm-4 col-md-4 col-xs-4 package-name three-section"><span>{langTranslateApp.loginPackage}</span><span class="second-span"><i class="icon-pack icon-{package.primaryService.productCode}"></i></div> <div class="col-lg-4 col-sm-4 col-md-4 col-xs-4 three-section"><span>{langTranslateApp.addon}</span><span class="second-span">{package.addonService}</span></div><div class="col-lg-4 col-sm-4 col-md-4 col-xs-4 three-section"> <span>{langTranslateApp.accStatus}</span> <span class="second-span"> <img src="/media/8268/icon-tick.svg" class="icon-background-img" if="{package.primaryService.status == \'Active\'}"><span class="icon-icon-warning" if="{package.primaryService.status == \'Disconnected\'}"></span><span id="status" if="{dstvApp.language == \'English\'}">{package.primaryService.status}</span><span id="status" if="{dstvApp.language == \'Portuguese\' && package.primaryService.status == \'Active\'}">Activo</span><span id="status" if="{dstvApp.language == \'Portuguese\' && package.primaryService.status == \'Disconnected\'}">Desconectado</span> </span></div><div class="clearfix"></div></div><div class="Get-now"><span class="selected-sc">{langTranslateApp.fixErrorSelectedSmartCard}</span><span class="unselected-sc">{langTranslateApp.fixErrorSelectedThisSmartCard}</span> <input class="package-input" id="{package.SerialNumber}_radiobtn" alt="{package.primaryService.status}" name="test" type="radio" style="position: absolute;" onchange="{OnPackageClick}" value="{package.SerialNumber}"><img src="/media/8268/icon-tick.svg" class="icon-background-img"></div></label></div></div></div></div> <div class="fix-error-code-wrapper" if="{!smartcardStatusDiscriptions}" ><h4 class="head">{langTranslateApp.fixErrorSelectAn} <b>{langTranslateApp.fixErrorErrorCode}</b></h4><div class="error-code-inner-wrapper"> <div class="ui-widget"> <select if="{app.errorCodesList}" id="combobox" name="select-errorcode" > <option></option> <option each="{errcode, index in app.errorCodesList.ErrorCodeCollectionByBusinessUnit}" class="custom-class" id="{errcode.ErrorCode}" value="{errcode.ErrorCode}">{errcode.ErrorCode} - {errcode.Description}</option> </select> </div> <div class="errorCodeDiscriptions"> <p class="errorCodeDesc"></p><p class="errorCodeDescNote"></p><button id="fixErrorFixButton" style="display:none;" type="button" class="btn btn-fix-error" onclick="{OnHowToFix}">{langTranslateApp.fixErrHowToFix}</button></div></div></div> <div class="smartcardStatusDiscriptions" if="{smartcardStatusDiscriptions}"><div class="textDisconnected"> <span class="main-disc">{langTranslateApp.dashFixErrorPackageInactiveState}</span> <p class="errorCodeDesc">{langTranslateApp.dashFixErrorPackageInactiveStateParagraph}</p><div><button id="fixErrorPayBtn" type="button" class="btn btn-fix-error text-uppercase" onclick="{PayNowFixError}">{langTranslateApp.fixErrorPayNow}</button></div></div></div><div if="{app.noServicesLoaded}" class="package-unactive-section clearfix"><div class="col-sm-1 text-center"><div class="iconDiv"><i class="icon icon-icon-fix-errors"></i></div></div><div class="col-sm-7 package-unactive-text">{langTranslateApp.dashNoServiceMessage1 + ". "+langTranslateApp.transHistoryPlease +langTranslateApp.dashNoServiceMessage2 + langTranslateApp.dashNoServiceMessage3}.</div><div class="col-sm-4 text-center"><a href="{contactNoserviceLink}" target="blank" class="btn anim-btn btn-white btn-bordered custom-button-headers">{langTranslateApp.subMenuContactUs}</a></div></div><div class="smartcardStatusPending" if="{smartcardStatusPending}"><div class="textDisconnected"> <span class="icon-icon-Disconnected"></span><span class="main-disc">{langTranslateApp.dashFixErrorTitlePending}</span> <p class="errorCodeDesc">{langTranslateApp.fixerrorPendingNote}</p></div></div></div><div class="container-fluid main-section" if="{state == \'requestinprocess\'}"><button type="button" class="payment-close" onclick="{backfix}">X</button><div class="popup success busy-processing"><div class="row"><img class="indicator-icon" src="/media/12089/pending-img.svg" alt="Pending Icon" /><h2>{langTranslateApp.requestBusyProcessing}</h2> <hr class="status-pay"> <h4 class="mb-3"><div><strong>{langTranslateApp.textImportant}:</strong></div> {langTranslateApp.systemBusyProcessing}</h4> <div class="text-center mb-3"><img src="/media/12088/decoder-switch-on.svg" alt="Decoder Image" /></div> <h4>{langTranslateApp.systemBusyProcessing2}</h4> </div><div class="Wrapper-white"><a href="javascript:void(0)" onclick="{GetDashboardOnfixErrorSuccess}" class="cta success-btn">{langTranslateApp.okGotIt}</a> <p>{langTranslateApp.dashFixErrorsStillStuck}</p> <a href="javascript:void(0)" onclick="{countactUS}" class="cta chat-btn">{langTranslateApp.chatToUs}</a> </div></div></div><div class="container-fluid main-section" if="{state == \'success\'}"><button type="button" class="payment-close" onclick="{backfix}">X</button><div class="popup success"><div class="row"><img class="indicator-icon" src="/media/11307/pay-success.svg" alt="" /><h2>{langTranslateApp.requestSubmitted}</h2> <h4 if="{selectdErrcode == \'Pincode Reset\'}">{langTranslateApp.requestProcessedSuccessfully} {langTranslateApp.requestProcessedSuccessfullyExtendedMsg}</h4><h4 if="{selectdErrcode != \'Pincode Reset\'}">{langTranslateApp.requestProcessedSuccessfully}</h4> </div><div class="Wrapper-white"><p>{langTranslateApp.dashFixErrorsMSGProcess} <b>{langTranslateApp.dashFixErrorsMSGProcessSub}</b> {langTranslateApp.dashFixErrorsMSGProcessSub1}</p> <a href="javascript:void(0)" onclick="{GetDashboardOnfixErrorSuccess}" class="cta success-btn">{langTranslateApp.okGotIt}<span class="icon icon-Arrow_right_thin"></span></a> </div></div></div><div class="container-fluid main-section" if="{state == \'error\'}"><button type="button" class="payment-close" onclick="{backfix}">X</button><div class="popup unsuccessful"><div class="row"><img class="indicator-icon" src="/media/11308/pay-fail.svg" alt="unsuccessful" /><h2>{langTranslateApp.dashboardRequestUnsuccessful}</h2> <h4>{error.error}</h4> </div><div class="Wrapper-white"><p>{langTranslateApp.dashPlzTryAgainAndContactUs}</p> <a href="javascript:void(0)" onclick="window.location.reload()" class="cta">{langTranslateApp.dashboardRetry}<span class="icon icon-Arrow_right_thin"></span></a> </div></div></div></div></div><div if="{state == \'processing\'}"><div class="fix-errors-loader-bg"><div class="loading-loader loading"><div class="col-sm-12 text-center white"><div class="spinner white"></div><div class="loading-message">{langTranslateApp.dashProcessing}</div></div></div></div></div></section></div>','','',function(opts){var self=this;app.errorCodeVideoAvailable=false;self.fixerrorStatus={};self.selectdErrcode="";self.on('before-mount',function(){});self.on('mount',function(){self.hideFixerrorContent=app.noServicesLoaded;self.contactNoserviceLink=dstvApp.ContactUsURL;self.InitializeFixErrorOperation();self.InitializeFixErrorSlider();self.GetFirstPackageSelected();jcf.replaceAll();jcf.refreshAll();self.update();riot.update();setTimeout(self.bindJCFDropdown,1200);});self.bindJCFDropdown=function(){if(app.loggedin){console.log('call1');const loadautocompleteLib=(callback)=>{const existingScript=document.getElementById('autocompleteLib');if(!existingScript){console.log('call2');const script=document.createElement('script');script.src='/scripts/jquery-ui.1.10.2.js';script.id='autocompleteLib';document.body.appendChild(script);script.onload=()=>{if(callback)callback();};}
console.log('call3');if(existingScript&&callback)callback();}
loadautocompleteLib();console.log('call4');$(function(){$.widget("custom.combobox",{_create:function(){this.wrapper=$("<span>").addClass("custom-combobox").insertAfter(this.element);this.element.hide();this._createAutocomplete();this._createShowAllButton();},_createAutocomplete:function(){var selected=this.element.children(":selected"),value=selected.val()?selected.text():"";this.input=$("<input>").appendTo(this.wrapper).val(value).attr("placeholder",langTranslateApp.errorcodetxt).addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:$.proxy(this,"_source")}).tooltip({classes:{"ui-tooltip":"ui-state-highlight"}});this._on(this.input,{autocompleteselect:function(event,ui){ui.item.option.selected=true;self.selectAutoCompleteCode(ui.item.value);this._trigger("select",event,{item:ui.item.option});},autocompletechange:"_removeIfInvalid"});},_createShowAllButton:function(){var input=this.input,wasOpen=false
$("<a>").attr("tabIndex",-1).attr("title","").attr("height","").tooltip().appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:"false"}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").on("mousedown",function(){wasOpen=input.autocomplete("widget").is(":visible");}).on("click",function(){input.trigger("focus");if(wasOpen){return;}
input.autocomplete("search","");});},_source:function(request,response){var matcher=new RegExp($.ui.autocomplete.escapeRegex(request.term),"i");response(this.element.children("option").map(function(){var text=$(this).text();if(this.value&&(!request.term||matcher.test(text)))
return{label:text,value:text,option:this};}));},_removeIfInvalid:function(event,ui){if(ui.item){return;}
var value=this.input.val(),valueLowerCase=value.toLowerCase(),valid=false;this.element.children("option").each(function(){if($(this).text().toLowerCase()===valueLowerCase){this.selected=valid=true;return false;}});if(valid){return;}
this.input.val("").attr("title",value+" didn't match any item").tooltip("open");this.element.val("");this._delay(function(){this.input.tooltip("close").attr("title","");},2500);this.input.autocomplete("instance").term="";},_destroy:function(){this.wrapper.remove();this.element.show();}});$("#combobox").combobox();$("#toggle").on("click",function(){$("#combobox").toggle();});});}}
self.selectAutoCompleteCode=function(errVal){self.selectdErrcode=errVal.toString().split(' ')[0];if(self.selectdErrcode.includes("Pincode")||self.selectdErrcode.includes("Redefinição")){self.PinCodeReset=errVal.toString().split('-')[0].trim();self.selectdErrcode=app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode.includes("Pincode")).ErrorCode}
if(self.selectdErrcode.includes("E16")){$(".errorCodeDescNote").append("<strong>"+langTranslateApp.textImportant+"</strong>: "+langTranslateApp.fixErrorE16SubHeaderText).show();}else{$(".errorCodeDescNote").html("").hide();}
if(app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode)!=undefined){if(app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).Type.trim().toLowerCase()=='api'){app.selectedErrorCodeType='Api';$("#fixErrorFixButton").html(langTranslateApp.fixErrorNow);}
else if(app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).Type.trim().toLowerCase()=="installer"){app.selectedErrorCodeType='installer';if(dstvApp.noInstallersCountryList.includes(window.culture.split('-')[1])){$("#fixErrorFixButton").html(langTranslateApp.subMenuContactUs);}else{$("#fixErrorFixButton").html(langTranslateApp.fixErrHowToFix);}}else if(app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).Type.trim().toLowerCase()=="customer"){app.selectedErrorCodeType='customer';$("#fixErrorFixButton").html(langTranslateApp.fixErrHowToFix);}else{}
$('.errorCodeDesc')[0].innerText=app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).LongDescription;console.log('Fix Error: Err code selected '+self.selectdErrcode+' ');$("#fixErrorFixButton").show();}else{$('.errorCodeDesc')[0].innerText="";$("#fixErrorFixButton").hide();}}
self.selectCode=function(e){self.selectdErrcode=$('select#select-errorcode').children("option:selected").val().toString().split(' ')[0];if(self.selectdErrcode.includes("Pincode")){self.PinCodeReset=$('select#select-errorcode').children("option:selected").val().toString().split('-')[0].trim();self.selectdErrcode=app.errorCodesList.entities.find(o=>o.properties.Code.includes("Pincode")).properties.Code;}
if(app.errorCodesList.entities.find(o=>o.properties.Code==self.selectdErrcode)!=undefined){if(app.errorCodesList.entities.find(o=>o.properties.Code==self.selectdErrcode).properties.IsApiDriven){app.selectedErrorCodeType='Api';$("#fixErrorFixButton").html(langTranslateApp.fixErrorNow);}
else if(app.errorCodesList.entities.find(o=>o.properties.Code==self.selectdErrcode).properties.IsInstallerDriven){app.selectedErrorCodeType='installer';if(dstvApp.noInstallersCountryList.includes(window.culture.split('-')[1])){$("#fixErrorFixButton").html(langTranslateApp.subMenuContactUs);}else{$("#fixErrorFixButton").html(langTranslateApp.fixErrHowToFix);}}else if(app.errorCodesList.entities.find(o=>o.properties.Code==self.selectdErrcode).properties.IsCustomerDriven){app.selectedErrorCodeType='customer';$("#fixErrorFixButton").html(langTranslateApp.fixErrHowToFix);}else{}
$('.errorCodeDesc')[0].innerText=app.errorCodesList.entities.find(o=>o.properties.Code==self.selectdErrcode).properties.ErrorCodeDetail;console.log('Fix Error: Err code selected '+self.selectdErrcode+' ');$("#fixErrorFixButton").show();}else{$('.errorCodeDesc')[0].innerText="";$("#fixErrorFixButton").hide();}}
self.OnHowToFix=function(e){if(app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).Type.trim().toLocaleLowerCase()=='api'){self.FixNow();}else{self.HowToFix();}}
self.GetFirstPackageSelected=function(){let dashboardPackageHolder=$('.Fix-error-slider');let firstPackage;try{firstPackage=dashboardPackageHolder[0].firstElementChild;app.selectedPackageForErrCodes=self.packages[0].SerialNumber;if(!app.noServicesLoaded){if(firstPackage){let radioButton=$(firstPackage.querySelector('input'));radioButton.attr('checked','checked');self.errorCodeSectionInitialize=true;self.selectedPackage=self.packages[0];if(self.selectedPackage.primaryService.status.toLowerCase()=="pending"){self.smartcardStatusPending=true;self.errorCodeSectionInitialize=false;}
if(self.selectedPackage.primaryService&&(self.selectedPackage.primaryService.status.toLowerCase()=='disconnected'||self.selectedPackage.primaryService.status.toLowerCase()=='suspended')){self.errorCodeDiscriptions=false;self.errorCodeSectionInitialize=false;self.smartcardStatusDiscriptions=true;}}}}
catch(e){console.log('package radio button exception')}}
self.InitializeFixErrorSlider=function(){$('.Fix-error-slider').not('.slick-initialized').slick({appendArrows:'.arrows-Fix-error',dots:false,infinite:false,nextArrow:'<span class="slick-next slick-arrow arrowColor" aria-label="Next" style="transform: translateY(-50%) rotate(180deg) !important; height:30px !important; width:30px !important; line-height:30px !important; top:auto !important;"></span>',prevArrow:'<span class="slick-prev slick-arrow arrowColor" aria-label="Previous" style="transform: translateY(-50%) rotate(0deg) !important; height:30px !important; width:30px !important; line-height:30px !important; top:-11px !important;"></span>',slidesToShow:3,slidesToScroll:1,autoplay:false,speed:500,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:2,infinite:true,}},{breakpoint:925,settings:{slidesToShow:2,slidesToScroll:1,infinite:true,}},{breakpoint:600,settings:{slidesToShow:1,slidesToScroll:1,}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1,}}]});}
self.InitializeFixErrorOperation=function(){self.packages=app.smartcards.filter(x=>x.primaryService&&!x.isDvsSc);self.CreateToken();self.hideFixErrorPackagesection=true;self.update();}
self.backfix=function(){window.HandleActiveTab('showAccount')}
self.CreateToken=function(){site.factory.GetJWT().then(function(token){self.token=token;})}
$(document).ready(function(){$(".available-options").on("click",function(){if($(".options").height()==200){$(".options").animate({height:"300px"});}
else if($(".options").height()==300){$(".options").animate({height:"200px"});}});});self.OnPackageClick=function(e){$(this).first('.bottomBar.pricebar .Get-now').addClass('hideRadio');self.errorCodeDiscriptions=false;self.smartcardStatusDiscriptions=false;self.errorCodeSectionInitialize=true;self.selectedPackage=e.item.package;app.selectedPacakge=e.item.package;app.selectedPackageForErrCodes=self.selectedPackage.SerialNumber;if(self.selectedPackage.primaryService&&(self.selectedPackage.primaryService.status.toLowerCase()=='disconnected'||self.selectedPackage.primaryService.status.toLowerCase()=='suspended')){self.errorCodeDiscriptions=false;self.errorCodeSectionInitialize=false;self.smartcardStatusDiscriptions=true;}
if(self.selectedPackage.primaryService.status.toLowerCase()=="pending"){self.smartcardStatusPending=true;self.errorCodeSectionInitialize=false;}
self.resetBackgroundColor();jcf.replaceAll();self.update();self.bindJCFDropdown();}
self.resetBackgroundColor=function(){var elements=document.getElementsByClassName('options');for(var i=0;i<elements.length;i++){elements[i].style.backgroundColor="";}}
self.FixNow=function(){if(self.selectedPackage.primaryService&&(self.selectedPackage.primaryService.status.toLowerCase()=='disconnected'||self.selectedPackage.primaryService.status.toLowerCase()=='suspended')){var paymentUrl='';if(!self.selectedPackage){self.state="error";self.error={};self.error.error=langTranslateApp.dashSelectValidCard;setTimeout(function(){location.reload();},100000);return;}
let smartcard=self.selectedPackage.SerialNumber;if(dstvApp.NoOnlinePaymentCountryList.includes(dstvApp.countryabbreviation)){site.factory.HandleHowToPay();return;}
else{if(dstvApp.DSOPayments&&dstvApp.DSOPayments.trim().toLowerCase()=='off'){window.location.href=dstvApp.PaymentBaseUrl+dstvApp.countryisocode+'/'+dstvApp.languageAbbreviation+'/payment/'+smartcard;}
else{}}}
self.state='processing';if(!self.selectedPackage.SerialNumber){self.state="error";self.error={};self.error.error=langTranslateApp.dashSelectValidCard;return;}
var k=self.selectedPackage.SerialNumber+'_'+self.selectdErrcode;if(self.PinCodeReset!=undefined)
{self.selectdErrcode=window.culture.includes("pt-")?"Pincode Reset":self.PinCodeReset;}
let smartcard=self.selectedPackage.SerialNumber;let data={country:dstvApp.country,smartCardNumber:smartcard,errorCode:self.selectdErrcode,type:app.selectedErrorCodeType};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}apifixerror/api/v2/Reauthorize?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Post(url,data,null,self.successPostCallback,self.errorPostCallback,false,false,true,true);}else{let url=`${dstvApp.DSOAPIUrl}apifixerror/api/v2/Reauthorize?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Post(url,data,self.token,self.successPostCallback,self.errorPostCallback);}
site.factory.trackData('FIXERROR-REQ',data,null)}
self.successPostCallback=function(data,pollstatus){self.state="requestinprocess";self.hideFixErrorPackagesection=false;self.fixerrorStatus.fullviewclass='responseWrapperFix';self.errorCodeSectionInitialize=false;self.errorCodeDiscriptions=false;$(window).scrollTop(0);site.factory.CaptureFeedback('DSTVFIXERROR_'+app.customernumber);site.factory.CaptureFeedback('DSTVFIXERRORCUSTOMER_'+app.customernumber);self.update();site.factory.trackData('FIXERROR-RES',null,data)}
self.errorPostCallback=function(error){self.state="error";self.hideFixErrorPackagesection=false;self.fixerrorStatus.fullviewclass='responseWrapperFix';if(error.responseJSON){self.error={};self.error.error=error.responseJSON.Message;}
else{self.error=typeof error.error.error=="string"?error.error:error.statusText;}
if(error.responseJSON.Message&&error.responseJSON.Message.includes("Your DStv account is suspended"))
self.state="error";if(error.responseJSON.Message&&error.responseJSON.Message.includes("Device not found for the smart card"))
self.state="error";self.errorCodeSectionInitialize=false;self.errorCodeDiscriptions=false;$('.failedErrorCode').show();$('.Fix-error-package-Error-Code').hide();$(window).scrollTop(0);self.update();site.factory.CaptureFeedback('DSTVFIXERRORCUSTOMER_'+app.customernumber);site.factory.trackData('FIXERROR-RES',null,error)}
self.GetDashboardOnfixErrorSuccess=function(){self.parent.HandleActiveTab("showAccount")}
window.countactUS=self.countactUS=function(){self.parent.HandleActiveTab("showAccount")
setTimeout(window.openChatWindow,1200);}
self.GetFixErrorCodeOnFailed=function(){self.parent.HandleActiveTab("showFixError")}
self.PayNowFixError=function(data,status){self.parent.HandleActiveTab("showPayment")
riot.mount('tag-dashboard-payments');}
self.HowToFix=function(){let smartcard=self.selectedPackage.SerialNumber;let data={country:dstvApp.country,smartCardNumber:smartcard,errorCode:self.selectdErrcode,type:app.selectedErrorCodeType};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}apifixerror/api/v2/Reauthorize?BusinessUnit=${dstvApp.businessunit}&Channel=mydstv&LanguageCode=${dstvApp.languageAbbreviation}`;site.factory.Post(url,data,null,self.successPostCallbackAPI,self.errorPostCallbackAPI,false,false,true,true);}
else{let url=`${dstvApp.DSOAPIUrl}apifixerror/api/v2/Reauthorize?BusinessUnit=${dstvApp.businessunit}&Channel=mydstv&LanguageCode=${dstvApp.languageAbbreviation}`;site.factory.Post(url,data,self.token,self.successPostCallbackAPI,self.errorPostCallbackAPI);}
site.factory.trackData('FIXERROR-REQ',data,null)}
self.successPostCallbackAPI=function(data,pollstatus){self.state=data.Status;if(data.ResponseMessage){if(data.ResponseMessage.Media){if(app.videoLink=data.ResponseMessage.Media.VideoUrl.length)
{app.videoLink=data.ResponseMessage.Media.VideoUrl[0].Url;app.errorCodeVideoAvailable=true;}
else{app.errorCodeVideoAvailable=false;}
app.imageLink=data.ResponseMessage.Media.ImageUrl[0].Url;}}
app.howToFixSteps=data.ResponseMessage.Steps;let params={showmodel:true,showclosebutton:true};if(dstvApp.noInstallersCountryList.includes(window.culture.split('-')[1])&&app.errorCodesList.ErrorCodeCollectionByBusinessUnit.find(o=>o.ErrorCode==self.selectdErrcode).Type.trim().toLowerCase()=="installer"){window.open(dstvApp.targetDomain+window.culture+"/help-contact-us","_blank");}else{riot.mount('tag-clear-error-codes',params);}}
self.errorPostCallbackAPI=function(error){self.state="error";self.hideFixErrorPackagesection=false;self.fixerrorStatus.fullviewclass='responseWrapperFix';if(error.responseJSON){self.error={};self.error.error=error.responseJSON.Message;}
else{self.error=typeof error.error.error=="string"?error.error:error.statusText;}
if(error.responseJSON.Message&&error.responseJSON.Message.includes("Your DStv account is suspended"))
self.state="error";if(error.responseJSON.Message&&error.responseJSON.Message.includes("Device not found for the smart card"))
self.state="error";self.errorCodeSectionInitialize=false;self.errorCodeDiscriptions=false;$('.failedErrorCode').show();$('.Fix-error-package-Error-Code').hide();$(window).scrollTop(0);self.update();site.factory.CaptureFeedback('DSTVFIXERRORCUSTOMER_'+app.customernumber);site.factory.trackData('FIXERROR-RES',null,error)}})
riot.tag2('tag-clear-error-codes','<div class="modal fade dashboardModal clear-error-codes commonModalPopup" id="commonModalPopup2" role="dialog"><div class="webform container modal-dialog modal-lg feedback-dialog"><div class="modal-content"><div class="modal-body"><div class="container-fluid main-section"><div class="popup"><div class="row"><div class="modal-content-inner"><div> <button type="button" class="payment-close movie-add-button" onclick="{ModalClose0202}" data-dismiss="modal">X</button> <h4>{langTranslateApp.clearErrCode}</h4> <h5>{app.selectedErrorCode}</h5> <h5>{langTranslateApp.fixErrRecommendedSolutions}</h5> <section id="channelScrambled"> <iframe if="{app.errorCodeVideoAvailable}" width="500" height="315" title="Clear error code video" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" src="{app.videoLink}"></iframe> <div id="videoSteps"> <div class="mb-1"><img src="{app.imageLink}" alt="Decoder image"></div><div class="row" each="{errcode, index in app.howToFixSteps}" > <div class="col-sm-12"> <div class="col-xs-3 col-sm-3"><img src="{errcode.Icon}" alt="Rescan Icon"></div><div class="col-xs-9 col-sm-9">{index+1}.{errcode.Text}</div></div></div></div></section> <section id="searchingSignal" if="{!app.errorCodeVideoAvailable}"> </section> <div class="modal-btn-group"><div><a if="{app.selectedErrorCodeType == \'customer\'}" class="btn btn-transparent btn-blue" href="javascript:void(0);" onclick="{ModalClose0202}" data-dismiss="modal">{langTranslateApp.fixErrClearedSuccessfully} <img src="/media/11834/success-tick-blue.svg"></a> <a if="{app.selectedErrorCodeType == \'installer\'}" class="btn btn-transparent btn-blue" href="javascript:void(0);" onclick="{ModalClose0202}" data-dismiss="modal">{langTranslateApp.fixErrClearedSuccessfully} <img src="/media/11834/success-tick-blue.svg"></a> </div> </div> </div></div> <div class="modal-footer text-center {app.selectedErrorCodeType}"><span if="{app.selectedErrorCodeType == \'customer\'}">{langTranslateApp.fixErrContactUsMsg}</span> <span if="{app.selectedErrorCodeType == \'installer\'}">{langTranslateApp.fixErrContactInstallerMsg}</span> <div><a if="{app.selectedErrorCodeType == \'customer\'}" class="btn btn-blue"  href="javascript:void(0);" data-dismiss="modal" onclick="{window.countactUS}">{langTranslateApp.chatToUs}</a><a if="{app.selectedErrorCodeType == \'installer\'}" class="btn btn-blue" href="javascript:void(0);" data-dismiss="modal" onclick="{openFindInstaller}">{langTranslateApp.subMenuNoDealersTitle}</a></div></div> </div></div></div><div class="clearfix"></div></div></div></div></div>','tag-clear-error-codes,[riot-tag="tag-clear-error-codes"],[data-is="tag-clear-error-codes"]{ visibility: visible; } tag-clear-error-codes select,[riot-tag="tag-clear-error-codes"] select,[data-is="tag-clear-error-codes"] select{ display: none !important; }','',function(opts){var self=this;self.on('mount',function(){if(opts.showmodel){$('#commonModalPopup2').modal('show');self.update();}});self.ModalClose0202=function(e){site.factory.CaptureFeedback('DSTVFIXERRORCUSTOMER_'+app.customernumber);window.HandleActiveTab('showAccount');}
self.openContactUS=function(e){var contactUsURL="";if(dstvApp.webUniCountryList.includes(window.culture.split('-')[1])){contactUsURL="https://www.dstv.com"+window.culture+"/help/contact-us"}else if(dstvApp.noInstallersCountryList.includes(window.culture.split('-')[1])){contactUsURL=window.culture+"/help-contact-us";}
else{contactUsURL=window.culture.includes("pt-")?window.culture+"/contacte-nos":window.culture+"/help-contact-us";}
window.RedirectTargetOrgin(e,contactUsURL);site.factory.CaptureFeedback('DSTVFIXERRORCONTACT_'+app.customernumber);window.HandleActiveTab('showAccount');}
self.openFindInstaller=function(e){var findInstallerURL="";if(dstvApp.webUniCountryList.includes(window.culture.split('-')[1])){findInstallerURL="https://www.dstv.com"+window.culture+"/buy/find-installer-or-dealer";}else if(dstvApp.noInstallersCountryList.includes(window.culture.split('-')[1])){findInstallerURL=window.culture+"/find-installer-or-dealer";}
else{findInstallerURL=window.culture.includes("pt-")?window.culture+"/localizar-agora":window.culture+"/find-installer-or-dealer";}
window.RedirectTargetOrgin(e,findInstallerURL);site.factory.CaptureFeedback('DSTVFIXERRORINSTALLER_'+app.customernumber);window.HandleActiveTab('showAccount');}});