var StyleMixin={init:function(){this.on('mount',function(){this.styleblock=document.getElementById('riot-dynamic-styles');if(!this.styleblock){this.styleblock=document.createElement('style');this.styleblock.setAttribute('id','riot-dynamic-styles');this.styleblock.type='text/css';document.body.appendChild(this.styleblock);}
this.sheet=this.styleblock.sheet;});},addCSSRule:function(selector,rules,idndex){if(this.sheet&&"insertRule"in this.sheet){this.sheet.insertRule(selector+"{"+rules+"}",this.sheet.cssRules.length);}
else if(this.sheet&&"addRule"in this.sheet){this.sheet.addRule(selector,package-inputrules,this.sheet.cssRules.length);}},editCSSRule:function(index,selector,rules){this.sheet.deleteRule(index);this.addCSSRule(selector,rules,this.sheet.cssRules.length);},updateCSSRule:function(selector,rules){var ruleIndex=-1;if(!this.sheet)
return;var theRules=this.sheet.cssRules?this.sheet.cssRules:this.sheet.rules;for(var i=0;i<theRules.length;i++){if(theRules[i].selectorText===selector){ruleIndex=i;break;}}
if(ruleIndex===-1){this.addCSSRule(selector,rules,this.sheet.cssRules.length);}
else{this.editCSSRule(ruleIndex,selector,rules);}}}
riot.mixin('promise',{promise:new function(){riot.observable(this);var self=this;this.get=function(url){var request=new XMLHttpRequest();request.promise=riot.observable();request.open('GET',url,true);request.onload=function(){var json;try{json=JSON.parse(request.responseText);}catch(e){json={};}
if(request.status>=200&&request.status<400)
request.promise.trigger('complete',{success:true,text:request.responseText,json:json});else
request.promise.trigger('complete',{success:false,text:request.responseText,json:json});};request.onerror=function(){request.promise.trigger('complete',{success:false,text:"connection error"});};request.send();return request.promise;};this.setdata=function(url,type,data,store,trigger,retries,promise){var request=new XMLHttpRequest();if(promise==undefined){app["loading"+store]="loading";site.trigger(trigger+'-loading');window.consolelog(trigger+"-loading : Started ");request.promise=riot.observable();}else{request.promise=promise;}
request.open(type,url,true);var timeout=500;request.onload=function(){var json;try{json=JSON.parse(request.responseText);}catch(e){json={};}
if(request.readyState===4&&request.status===200){if(store!=undefined&&store!==""){app[store]=json;window.SessionSave("app",app);}
window.consolelog("Data Success for "+store+" - "+trigger+'-loading-success');request.promise.trigger('complete',{success:true,text:request.responseText,json:json});site.trigger(trigger+'-loading-success',json,true);app["loading"+store]=undefined;site.trigger(trigger,json,true);}
else{if(retries===0){request.promise.trigger('complete',{success:false,text:request.responseText,json:json});site.trigger(trigger+"-loading-fail",json,false);app["loading"+store]=undefined;site.trigger(trigger,json,false);var trackData={};trackData.Result=json;trackData.URL=url;trackData.Type=type;trackData.Store=store+" - "+trigger+"-loading-fail";site.trigger("track-api-retry-fail",trackData);}else{setTimeout(function(){self.setdata(url,type,data,store,trigger,retries-1,request.promise);},timeout);}}};request.send(data);return request.promise;}
this.all=function(){var completed=[],isArr=Array.isArray(arguments[0]);var args=isArr?arguments[0]:arguments;var narg=args.length,entries=0;for(var i=0;i<narg;i++){args[i].index=i;args[i].one('complete',function(a){completed[this.index]=a;if(++entries===narg)
self.trigger.apply(null,['complete'].concat(isArr?[completed]:completed));});}
return self;}
return this;}});riot.mixin('loader',{loadscript:function(scriptSrc,callback){var head=document.querySelector('head');var selector="script[src='"+scriptSrc+"']";var script=document.querySelector(selector);if(script==undefined){script=document.createElement('script');script.type='text/javascript';script.src=scriptSrc;head.appendChild(script);}
if(script.callbacks==undefined)
script.callbacks=[];script.callbacks.push(callback);script.doCallbacks=function(){script.callbacks.forEach(function(c,i){c();});}
script.onload=function(){script.doCallbacks();}
script.onreadystatechange=function(){if(this.readyState==='complete'){script.doCallbacks();}}}});riot.mixin('tracker',{track:function(action,data,result){}})
riot.tag2('navigate','<a href="{document.querySelector(\'router\').getBasePath()+opts.to}" onclick="{navigateToRoute}"><yield></yield></a>','','',function(opts){var self=this;this.navigateToRoute=function(e){e.preventDefault();riot.route(self.opts.to,self.opts.title||null,self.opts.replace?true:false);}});riot.tag2('route','<yield></yield>','','',function(opts){this.on('mount',function(e){if(Object.keys(this.tags).length===0){this.parent&&this.parent.setRoute&&this.parent.setRoute(this.opts.path,this.opts.component);}});this.setRoute=function(path,component){this.parent&&this.parent.setRoute&&this.parent.setRoute(this.opts.path+path,component);}});riot.tag2('router','<div ref="riotcontainer" class="route-container"><yield></yield></div><div ref="riotroot" class="riot-root"></div>','','',function(opts){var self=this;var $appRoot=null;var currTag=null;var _isRouteRendedered=false;var routeParams={};function unmountCurrRoute(){if(currTag&&currTag.unmount){currTag.unmount();}}
function createRouteWithTagName(tagName){var tag='<'+tagName+' class="route-'+tagName+'"></'+tagName+'>';unmountCurrRoute();$appRoot.innerHTML=tag;var mountedTag=false;try{if(typeof window==='undefined'){$appRoot.innerHTML=riot.render(tagName,routeParams);}else{mountedTag=riot.mount(tagName+'.route-'+tagName,routeParams);}}
catch(e){console.log(e);}
if(!mountedTag||mountedTag.length===0){site.trigger('tagNotFound',tagName);if(self.opts['onTagnotfound']&&self.opts['onTagnotfound']instanceof Function){self.opts['onTagnotfound'](tagName);}}
else{site.trigger('routeChanged',tagName);app.currentroute=tagName;if(self.opts['onRoutechange']&&self.opts['onRoutechange']instanceof Function){self.opts['onRoutechange'](tagName);}
currTag=mountedTag[0];}}
function changeRoute(newRoute){if(typeof(newRoute)==='string'){createRouteWithTagName(newRoute);}else if(newRoute instanceof Function){var result=newRoute();if(typeof(result)==='string'){createRouteWithTagName(newRoute);}else if(result instanceof Promise){result.then(function(tagName){createRouteWithTagName(tagName);});}}}
this.setRoute=function(path,component){(function(path,component){var tokenRegExp=/:([a-z]*)/ig;var params=path.match(tokenRegExp);var param1=function(param){return param.length>0?param.substring(1):''}
params=params&&params.map(param1(param))||params;path=path.replace(tokenRegExp,'*');if(typeof window==='undefined'&&!_isRouteRendedered){var serverSidePath=new RegExp(path.replace(/\*/g,'([^/?#]+?)').replace(/\.\./g,'.*')+'$');var loc=self.opts.location||self.parent&&self.parent.opts.location;if(serverSidePath.test(loc)){var matches=loc.match(serverSidePath)
matches.length&&matches.shift();routeParams={};params&&params.forEach(function(param,index){routeParams[param]=matches[index];});_isRouteRendedered=true;changeRoute(component);}}else if(typeof window!=='undefined'){route(path,function(){routeParams={};params&&params.forEach(function(param,index){routeParams[param]=arguments[index];});changeRoute(component);});route.start(true);}})(path,component)}
this.on('mount',function(e){if(!this.opts.showRoutes){var routeContainer=this.refs.riotcontainer;routeContainer.remove&&routeContainer.remove();}
$appRoot=this.refs.riotroot;this.opts.baseRoute&&route.base(this.opts.baseRoute);this.root.getBasePath=function(){return self.opts.baseRoute||'#';}});});riot.tag2('tag-getdata','<yield></yield>','','',function(opts){var self=this;this.mixin('promise');self.mixin('tracker');self.deleteAllCookies=function(){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=cookies[i];var eqPos=cookie.indexOf("=");var name=eqPos>-1?cookie.substr(0,eqPos):cookie;document.cookie=name+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT";}};self.on("mount",function(){if(window.location.href.includes(dstvApp.dstvLiveChatURL)){let params=new URLSearchParams(window.location.search);if(params.get("endchat")==="true"){window.endChatForced();self.deleteAllCookies();let paramsSmartCard=params.get("smartcard");let storageKeyLiveChat="ch_"+paramsSmartCard;localStorage.removeItem(storageKeyLiveChat);return;}
self.deleteAllCookies();let paramsSmartCard=params.get("smartcard");let storageKeyLiveChat="ch_"+paramsSmartCard;localStorage.removeItem(storageKeyLiveChat);app.loggedin=true;app.mobileLivechat=true;app.endMobileLiveChat=false;document.title="DStv LiveChat";riot.mount('tag-livechat');return;}
if(app.loggedin&&window.reloadData){site.trigger("logout");window.location.reload();return 0;}
if(app.loggedin){if(window.location.pathname==window.culture||window.location.pathname==window.culture+"/")
$('#dashBoardHomeNav').css('display','none')}
$('#loginLinkLabel').click(function(e){e.preventDefault();let returnURL=window.location.href.includes(dstvApp.DstvThanksURL)?dstvApp.DstvThanksURL:undefined;riot.mount('tag-sign-in',{returnURL:returnURL});});});site.on('logout',function(){app.ciamLogin=undefined;site.factory.trackData('LOGOUT',null,null);localStorage.clear();app.decoders=undefined;app.smartcard=undefined;app.smartcards=undefined;app[app.customernumber]=undefined;app.linkdecoder=undefined;app.holidayviewing={};app.alldecodersloaded=undefined;app.contactdetails=undefined;app.duepaymentaccounts=undefined;app.holidayaccountnumbers=undefined;app.holidaydecodersdata=undefined;app.customernumber="";app.boxofficeaccountnumbers=undefined;app.residentialaccountnumbers=undefined;app.showmaxData=undefined;app.loggedin=undefined;app.customername=undefined;app.eazySigninParam=undefined;app.primaryaccountnumber=undefined;app.accounts=undefined;app.customercontactdetails=undefined;app.customeraddressdetails=undefined;app.suburbsbycity=undefined;app.addressdetails=undefined;app.allcitieslist=undefined;app.finalcitieslist=undefined;app.paymentduedetails=undefined;app.provincelist=undefined;app.boxOfficeMovies=undefined;app.showMaxDetails=undefined;app.topUpAmountList=undefined;app.connection=undefined;app.customerDetails=undefined;app.deadlineTime=undefined;app.showmaxUpgradeReq=undefined;app.BOMoviePricing=undefined;app.topUpAmountList=undefined;app.showmaxCardCaption=undefined;app.isNotPrimePackage=undefined;app.sessionID=undefined;app.hideMovieAddonCard=undefined;app.movieAddonStatusDetails=undefined;app.movieAddOnDetails=undefined;app.isHideMovieAddonSelfserviceCard=undefined;app.isDvsHybridCustomer=undefined;app.isDvsCustomer=undefined;app.hideFixError=undefined;app.isConnectLogin=undefined;app.SmartCardNumber=undefined;app.connectCustomerDetails=undefined;app.isDVSJourney=undefined;app.isResumeJourney=undefined;app.selectedProductCode=undefined;app.umbracopackages=undefined;app.allchannels=undefined;app.allchannelgenres=undefined;app.applyingSignIn=undefined;app.statusCode=undefined;window.SessionRemove("app");window.SessionRemove("app.decoders");window.SessionRemove("app.linkdecoder");window.SessionRemove("app.holidayviewing");window.SessionRemove("app.alldecodersloaded");window.SessionRemove("app.contactdetails");window.SessionRemove("app.duepaymentaccounts");window.SessionRemove("app.holidayaccountnumbers");window.SessionRemove("app.holidaydecodersdata");window.SessionRemove("app.boxofficeaccountnumbers");window.SessionRemove("app.residentialaccountnumbers");window.SessionRemove("app.customernumber");window.SessionRemove("app.primaryaccountnumber");window.SessionRemove("app.showmaxData");window.SessionRemove("app.accounts");window.SessionRemove("app.customercontactdetails");window.SessionRemove("app.customeraddressdetails");window.SessionRemove("app.suburbsbycity");window.SessionRemove("app.addressdetails");window.SessionRemove("app.allcitieslist");window.SessionRemove("app.finalcitieslist");window.SessionRemove("app.paymentduedetails");window.SessionRemove("app.provincelist");window.SessionRemove("app.boxOfficeMovies");window.SessionRemove("app.showMaxDetails");window.SessionRemove("app.topUpAmountList");window.SessionRemove("app.connection");window.SessionRemove("app.customerDetails");window.SessionRemove("app.deadlineTime");window.SessionRemove("app.showmaxUpgradeReq");window.SessionRemove("app.BOMoviePricing");window.SessionRemove("app.topUpAmountList");window.SessionRemove("app.showmaxCardCaption");window.SessionRemove("app.isNotPrimePackage");window.SessionRemove("app.sessionID");window.SessionRemove("app.hideMovieAddonCard");window.SessionRemove("app.movieAddonStatusDetails");window.SessionRemove("app.movieAddOnDetails");window.SessionRemove("app.isHideMovieAddonSelfserviceCard");window.SessionRemove("app.isDvsHybridCustomer");window.SessionRemove("app.isDvsCustomer");window.SessionRemove("app.hideFixError");window.SessionRemove("app.isConnectLogin");window.SessionRemove("app.SmartCardNumber");window.SessionRemove("app.connectCustomerDetails");window.SessionRemove("app.isDVSJourney");window.SessionRemove("app.isResumeJourney");window.SessionRemove("app.selectedProductCode");window.SessionRemove("app.umbracopackages");window.SessionRemove("app.allchannels");window.SessionRemove("app.allchannelgenres");window.SessionRemove("app.dvsPackages");window.SessionRemove("app.applyingSignIn");window.SessionRemove("app.statusCode");site.trigger("loggedout");self.update();});site.on("setdata",function(url,type,data,store,trigger,retries){self.promise.all(self.promise.setdata(url,type,data,store,trigger,retries)).one('complete',function(a){});});});riot.tag2('tag-header','<div if="{opts.view == \'homepage\'}" class="search-bar home-search" ref="searchbarhold"><tag-type-a-head myid="{opts.mysearchid}" searchsrc="{opts.searchurlsrc}" resultdisplay="{opts.searchresultdisplay}" resulturl="{opts.searchresulturl}" placeholdertext="{opts.searchplaceholder}" displayslide="{opts.displaysearchslide}" view="{opts.view}"><yield from="searcher"></yield></tag-type-a-head><yield from="content"></yield></div><div if="{opts.view == \'generalpage\'}" class="search-bar general-page-head overlay fadeIn" ref="searchbarhold"><tag-type-a-head myid="{opts.mysearchid}" searchsrc="{opts.searchurlsrc}" resultdisplay="{opts.searchresultdisplay}" resulturl="{opts.searchresulturl}" placeholdertext="{opts.searchplaceholder}" displayslide="{opts.displaysearchslide}" view="{opts.view}" inpage="true"><yield from="searcher"></yield></tag-type-a-head></div><div if="{opts.view == \'page404\'}" class="search-bar error-404-head" ref="searchbarhold"><tag-type-a-head myid="{opts.mysearchid}" searchsrc="{opts.searchurlsrc}" resultdisplay="{opts.searchresultdisplay}" resulturl="{opts.searchresulturl}" placeholdertext="{opts.searchplaceholder}" displayslide="{opts.displaysearchslide}" view="{opts.view}"><yield from="searcher"></yield></tag-type-a-head><div class="not-found-nav-holder"><ul class="list-inline not-found-menu text-center"><li><a href="/home/">Home</a></li><li><a href="/home/#my-viewing">Holiday Viewing</a></li><li><a href="/how-to-pay/">How To Pay</a></li><li><a href="/contact-us/">Contact Us</a></li></ul></div></div>','tag-header,[riot-tag="tag-header"],[data-is="tag-header"]{ visibility: visible; }','',function(opts){var self=this;self.bgSrc='';var country="";var selectedLanguage="";var windowurl=window.location;sessionStorage.setItem('countryCode',dstvApp.countryabbreviation);self.on('mount',function(){if(app.loggedin){$('#countryDropdown').css({'cursor':'default'});$('.icon-ico-arrow-down').hide();}
$("body").addClass(window.culture.replace("/",""));$(window).load(function(){if((app.isVIVR&&!app.loggedin)||app.ciamAuthCode){$('#loader').show();}else{$('#loader').hide();}});var scroll_pos=0;$(document).scroll(function(){scroll_pos=$(this).scrollTop();if(scroll_pos>50){$("header").addClass("fixed-position");}else{$("header").removeClass("fixed-position");}});});});riot.tag2('tag-initialise','<yield></yield><tag-getdata></tag-getdata>','','',function(opts){var self=this;self.bgSrc='';var dstvurl="https://www.dstv.com/";var zambia_logo="/media/4547/logo-zambia.png";self.on('mount',function(){$(window).load(function(){$('#loader').hide();});countryHomeFlagIconcode=sessionStorage.getItem('countryHomeFlagIcon');$('#countryIcon').attr('src',"/countryicons/codes/"+countryHomeFlagIconcode+".svg");$('.inlinePop').click(function(){$('body.package-landing').css('overflow','hidden');setTimeout(function(){$("#cboxClose").on("click",function(){resetScroll();});},1000)});$(".mapwhiteBox h2").before("<span class='contact-close-btn'><i class='icon-Close_M pl-1'></i></span>");$(".mapwhiteBox .wg2k_submitField.col-md-12.submit-btn-rounded").after('<div class="footer-contact-from">GET IN TOUCH <a href="" target="_blank" class="twitterurl"><img src="/media/4806/contact-tw.jpg" hspace="5"></a><a href="" target="_blank" class="facebookurl"><img src="/media/4805/contact-fb.jpg" hspace="5"></a></div>');var twitter=$('#twitter').val();$(".twitterurl").attr("href",twitter);var facebook=$('#facebook').val();$(".facebookurl").attr("href",facebook);$(".contact-us-text-btn").click(function(){$(".mapwhiteBox").show();$('.gm-style .gm-style-iw').hide();});$(".contact-close-btn").click(function(){$(".mapwhiteBox").hide();$('.gm-style .gm-style-iw').show();});$(".map-contact-btn").on("click",function(){$("html, body").animate({scrollTop:300},"slow");});$(".map-contact-btn1").on("click",function(){$("html, body").animate({scrollTop:1500},"slow");});$('.call-button').click(function(){$('body.package-landing').css('overflow','hidden');setTimeout(function(){$("#cboxClose").on("click",function(){resetScroll();});},1000)});function resetScroll(){$('body.package-landing').css('overflow','scroll');$('body.business-pay').css('overflow','scroll');}
$('#cboxClose').click(function(){$('#colorbox').hide();});$(document).ready(function(){$('<div class="overlayBottom"> <span id="expandIcon"> <img src="/media/4561/down_arrow.svg" width="40px"></span></div>').insertAfter(".single-new-article p:last-child");$('#expandIcon').click(function(){$('.single-new-article .mb64').toggleClass('fullHeight');});});$(window).load(function(){});$(".grid-section:nth-child(2)").attr("id","main-scroll");var scroll_pos=0;$(document).scroll(function(){scroll_pos=$(this).scrollTop();if(scroll_pos>30){$("#header").addClass("fixed-position");}else{$("#header").removeClass("fixed-position");}});$(".search-filed").on("keyup",function(){var value=$(this).val().toLowerCase();$(".country-row .column a").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(value)>-1);});let totalResult=$(".country-row .column a").length;let hiddenRecordCount=$(".country-row .column a").filter((x,i)=>i.style.display==='none').length;if(hiddenRecordCount==totalResult){$('#nocountryfound').remove();$('.country-row').append('<p id="nocountryfound" class="result-no">'+langTranslateApp.noResult+'</p>');$('#nocountryfound').show();}
else{$('#nocountryfound').remove();}});$(document).ready(function(){$('.installtion').click(function(){$(".pvrDescription").show();$(".pvr1Description").hide();});$('.caret').click(function(){$(".pvrDescription").hide();$(".pvr1Description").show();});$("#myDiv .dropdown-menu li").click(function(){var selText=$(this).text();var imgSource=$(this).find('img').attr('src');var imgClass=$(this).find('img').attr('class');var img='<img src="'+imgSource+'" class="'+imgClass+'"/>';var liImgSrc=$(this).parents('.btn-group').find('.dropdown-toggle').find('img').attr('src');var liImgClass=$(this).parents('.btn-group').find('.dropdown-toggle').find('img').attr('class');var imgLi='<img src="'+liImgSrc+'" class="'+liImgClass+'"/>';$(this).parents('.btn-group').find('.dropdown-toggle').html(img+' '+selText+' <span class="caret"></span>');$(this).parents('.btn-group').find('.dropdown-menu li').html(imgLi+' '+selText+' <span class=""></span>');$('.'+imgClass).click();if(imgClass==='installtion'){$(".pvrDescription").show();$(".pvr1Description").hide();}
else if(imgClass==='pvr'){$(".pvrDescription").hide();$(".pvr1Description").show();}});});if(sessionStorage.getItem('selectedFlag')){$('.img-globe').addClass("countryactive");$("#my_image").attr("src","second.jpg");$('.logo img').attr('src',zambia_logo);$('.logo').addClass("country-logo");$('.country  .icon-globe').hide();}
var country="";if(country.toLowerCase()=='test'){$('.lang-dropdown-menu').removeAttr('disabled');selectedLanguage=$(":selected",'.lang-dropdown-menu').text().toLowerCase();}
else{$('.lang-dropdown');$('.jcf-select  .jcf-select-text').css("color","gray");selectedLanguage=$(":selected",'.lang-dropdown-menu').text().toLowerCase();$('.lang-dropdown-menu');}
$('.flag.ao , .flag.mz').click(function(){$('.jcf-select-text').css("color","white");});$('.flags-icons-menu .column a.flags').click(function(e){country=$(this).attr("class").replace('flags','').trim();sessionStorage.setItem('countryHomeFlagIcon',country);if(country.toLowerCase()=='test'){$('.lang-dropdown-menu').removeAttr('disabled');selectedLanguage=$(":selected",'.lang-dropdown-menu').text().toLowerCase();}
else{e.preventDefault();e.stopImmediatePropagation();if(country=='sa'){window.location="http://www.dstv.co.za";}
else if(!dstvApp.targetcountries.includes(country)){countryHomeFlagIconcode=sessionStorage.getItem('countryHomeFlagIcon');$('#countryIcon-newhome').attr('src',"/countryicons/codes/"+countryHomeFlagIconcode+".svg");window.open(window.location.origin+'/home');}
else{e.preventDefault();if(window.location.href.indexOf("decoders")>-1){window.location.href=window.location.origin+'/en-'+country+"/decoders-list/";}else if(window.location.href.indexOf("packages")>-1){window.location.href=window.location.origin+'/en-'+country+langTranslateApp.subMenuGetComparePackagesLink;}else{if(dstvApp.liveTargetCountries.includes(country)){if(window.location.pathname.includes(window.culture)){let currentLang=window.culture.split('-')[0];let targateLang=$(this).attr('href').split('-')[0];if(currentLang==targateLang)
window.location=window.location.origin+window.location.pathname.replace(window.culture,$(this).attr('href'));else
window.location=window.location.origin+$(this).attr('href');}
else
window.location=window.location.origin+$(this).attr('href');}else{window.location=window.location.origin+window.location.pathname.replace(window.location.pathname,$(this).attr('href'));}}}}});});});riot.tag2('tag-input','<div if="{opts.type != \'checkbox\' && opts.type != \'radio\' && opts.type != \'select\' && opts.type != \'hidden\' && opts.type != \'textarea\'}" class="group {\'hasvalue\' : opts.value != \'\' && opts.type != \'submit\'} {opts.cls} "><input if="{opts.type != label}" placeholder=" " trigger="{clicktrigger: opts.clicktrigger}" pattern="{opts.pattern}" type="{opts.type}" id="{opts.fieldid}" class="{opts.cls} addvars form-control"><span class="input-group-btn search-btn" if="{opts.icon}"><span><span class="{opts.icon}"></span></span></span><div id="{opts.results}" if="{opts.results}"></div><label for="{opts.name}" if="{opts.label}" class="lbl text" aria-label="{opts.label}">{opts.label}</label><span class="help-block" if="{opts.error}">{opts.error}</span><span class="error-holder"></span></div><div if="{opts.type == \'hidden\'}" class="hidden-field"><input class="{opts.cls} addvars" type="text" id="{opts.fieldid}"></div><div if="{opts.type == \'checkbox\'}" style="overflow:hidden"><div class="checkbox"><input if="{opts.type != label}" type="{opts.type}" trigger="{clicktrigger: opts.clicktrigger}" id="{opts.fieldid}" class="{opts.cls} addvars"><label> {opts.label} </label><span class="error-holder"></span></div></div><div if="{opts.type == \'radio\'}" style="overflow:hidden"><div class="radio-option" temp="{current} {opts.value}"><div class="inner"></div><input if="{opts.type != label}" type="{opts.type}" groupname="{opts.radiogroup}" trigger="{clicktrigger: opts.clicktrigger}" id="{opts.fieldid}" class="{opts.cls} addvars"></div><span>{opts.label}</span><span class="error-holder"></span></div><div if="{opts.type == \'textarea\'}" class="group {\'hasvalue\' : opts.value != \'\'} form-textarea"><textarea rows="3" id="{opts.fieldid}" class="{opts.cls} addvars"></textarea><label for="{opts.name}" if="{opts.label}" class="lbl">{opts.label}</label><span class="help-block" if="{opts.error}">{opts.error}</span><span class="error-holder"></span></div>','tag-input,[riot-tag="tag-input"],[data-is="tag-input"]{ visibility: visible; } tag-input .hidden-field,[riot-tag="tag-input"] .hidden-field,[data-is="tag-input"] .hidden-field,tag-input div[type=hidden].form-group,[riot-tag="tag-input"] div[type=hidden].form-group,[data-is="tag-input"] div[type=hidden].form-group{ min-height: 0; height: 0; overflow: hidden; min-height: 0; } tag-input .group,[riot-tag="tag-input"] .group,[data-is="tag-input"] .group{ position: relative; overflow: visible; } tag-input .password-meter .progress,[riot-tag="tag-input"] .password-meter .progress,[data-is="tag-input"] .password-meter .progress{ display: none; } tag-input .password-meter .hasvalue .progress,[riot-tag="tag-input"] .password-meter .hasvalue .progress,[data-is="tag-input"] .password-meter .hasvalue .progress{ display: block; } tag-input .help-block,[riot-tag="tag-input"] .help-block,[data-is="tag-input"] .help-block{ opacity: 0; display: none; } tag-input .help-block,[riot-tag="tag-input"] .help-block,[data-is="tag-input"] .help-block{ opacity: 0; top: 10px; line-height: 15px; margin-top: 10px; position: absolute; left: 10px; -moz-transition: all ease 0.3s; -o-transition: all ease 0.3s; -webkit-transition: all ease 0.3s; transition: all ease 0.3s; font-style: italic; color: #999; } tag-input .error ~ .help-block,[riot-tag="tag-input"] .error ~ .help-block,[data-is="tag-input"] .error ~ .help-block{ display: none; } tag-input .form-group:hover .help-block,[riot-tag="tag-input"] .form-group:hover .help-block,[data-is="tag-input"] .form-group:hover .help-block{ opacity: 1; top: 45px; } tag-input input:-webkit-autofill ~ label.lbl,[riot-tag="tag-input"] input:-webkit-autofill ~ label.lbl,[data-is="tag-input"] input:-webkit-autofill ~ label.lbl,tag-input textarea:-webkit-autofill ~ label.lbl,[riot-tag="tag-input"] textarea:-webkit-autofill ~ label.lbl,[data-is="tag-input"] textarea:-webkit-autofill ~ label.lbl{ top: -22px !important; font-size: 13px; color: #777; }','',function(opts){var self=this;self.on('mount',function(){if(opts.helptext){var x=opts.helptext;$(self.root).find(".help-block").html(x);}
if(opts.type=="checkbox"){if(opts.value.toLowerCase()=="true"){$(self.root).find('input[type=checkbox]').prop('checked',true);$(self.root).find('.checkbox-option').addClass('checked');}
else{$(self.root).find('input[type=checkbox]').prop('checked',false);$(self.root).find('.checkbox-option').removeClass('checked');}}
$('form,input').attr("autocomplete","off");var input;switch(opts.type){case 'textarea':input=$(self.root).find("textarea.addvars")[0];break;case 'checkbox':input=$(self.root).find(".checkbox .addvars")[0];break;case 'textarea':input=$(self.root).find("textarea.addvars")[0];break;case 'text':case 'email':case 'password':case 'date':case 'tel':case 'number':input=$(self.root).find("input.addvars")[0];break;default:input=$(self.root).find(".addvars")[0];}
if(self.opts.cls=="password-meter"){$(self.root).parent().addClass("password-meter");$(input).pwstrength({ui:{showVerdictsInsideProgressBar:true}});};Object.keys(opts).forEach(function(key,i){if("label clicktrigger columns class riot-tag type validation".indexOf(key)==-1){if(key=="propenabled"&&opts[key]=="false"){input.setAttribute('disabled','');}
if(key=="mask"&&opts[key]!=undefined){input.setAttribute('data-mask',opts[key]);}
if(input==undefined){console.log("input not found"+self.root+self.opts.type);return;}
if(opts[key]!=""&&opts[key]!=undefined){if(key!="value"||key=="value"&&opts.type!="checkbox"&&opts.type!='radio'&&opts.type!='select'&&opts.type!='textarea'){input.setAttribute(key,opts[key]);self.root.removeAttribute(key);}}}});$(self.root).addClass("form-group");if(self.opts.validation){Object.keys(self.opts.validation).forEach(function(key,i){if("ignore".indexOf(key)==-1){if(key=="required"){input.setAttribute("required","");input.setAttribute("data-rule-"+key,self.opts.validation[key].value);input.setAttribute("data-msg-"+key,self.opts.validation[key].message);}
else{input.setAttribute("data-rule-"+key,self.opts.validation[key].value);input.setAttribute("data-msg-"+key,self.opts.validation[key].message);}}});}
$(self.root).on("click","[trigger=clicktrigger]",function(e){site.trigger(opts.clicktrigger,e);});self.update();self.thisroot=self.root;self.input=$(self.root).find("input[type=text], input[type=password], input[type=email], input[type=tel], input[type=number], textarea");self.checkboxoption=$(self.root).find(".checkbox-option");self.radiooption=$(self.root).find(".checkbox-option");if(self.input.val()){self.input.parent().addClass("hasvalue");}
else{self.input.parent().removeClass("hasvalue");}
$(self.input,self.checkboxoption,self.radiooption).on('keyup blur touchstart mouseup change',function(){if(self.input.val()){self.input.parent().addClass("hasvalue");}
else{self.input.parent().removeClass("hasvalue");}});$(self.input).on('focus',function(){if(self.input.val()){self.input.parent().addClass("hasvalue");}
else{self.input.parent().removeClass("hasvalue");}});$(self.input).focusin(function(){self.input.parent().addClass("hasfocus");});$(self.input).focusout(function(){self.input.parent().removeClass("hasfocus");});if($("input[name=NameOfEmployer]").val()!==undefined){$("#search-query").val($("input[name=NameOfEmployer]").val());}
self.selectedDate=self.opts.value;});self.on("update",function(){var input;switch(opts.type){case 'textarea':input=$(self.root).find("textarea.addvars")[0];break;case 'checkbox':input=$(self.root).find(".checkbox .addvars")[0];break;case 'textarea':input=$(self.root).find("textarea.addvars")[0];break;case 'text':case 'email':case 'password':case 'tel':case 'date':case 'number':input=$(self.root).find("input.addvars")[0];break;default:input=$(self.root).find(".addvars")[0];}
if($(self.root).find(".date-picker").length>0){$(input).val(moment(self.selectedDate).format('dddd D MMMM YYYY'));$(self.root).find(".date-picker").datepicker({dateFormat:'DD d MM yy',altFormat:"yyyy-mm-dd",defaultDate:moment(self.selectedDate).format('dddd D MMMM YYYY'),numberOfMonths:1,onSelect:function(selected,evnt){self.selectedDate=selected;if($(this).val()){$(this).parent().addClass("hasvalue");}
else{$(this).parent().removeClass("hasvalue");}
if($(this).hasClass("error")){$(this).valid();}}});}
if(self.input!=undefined&&self.input.val()!=""){self.input.parent().addClass("hasvalue");}});});riot.tag2('tag-loading','<div class="loading-veil" if="{loaderVisible == true}"><div class="loading-loader"><div class="col-sm-12 text-center"><div class="spinner"></div><br><div class="loading-message">{messageHeader}</div></div></div></div>','tag-loading,[riot-tag="tag-loading"],[data-is="tag-loading"]{ visibility: visible; } tag-loading .loading-veil,[riot-tag="tag-loading"] .loading-veil,[data-is="tag-loading"] .loading-veil{ background-color: rgba(0, 0, 0, 0.80); position: fixed; top: 0; bottom: 0; left: 0; right: 0; z-index: 10001; height: 100%; } tag-loading .loading-loader,[riot-tag="tag-loading"] .loading-loader,[data-is="tag-loading"] .loading-loader{ overflow: hidden; max-width: 50%; width: 50%; position: fixed; padding: 5px 0px; -webkit-transition: .3s; -o-transition: .3s; -webkit-transition: all .3s ease; -moz-transition: all .3s ease; transition: .3s; transition: all .3s ease; top: 50%; left: 50%; -moz-transform: translateX(-50%) translateY(-50%); -ms-transform: translateX(-50%) translateY(-50%); -o-transform: translateX(-50%) translateY(-50%); -webkit-transform: translateX(-50%) translateY(-50%); transform: translateX(-50%) translateY(-50%); max-width: 160px; }','',function(opts){var self=this;self.loaderVisible=false;self.meaageHeader="Loading";self.messageBody="";site.on('showLoader',function(data){self.loaderVisible=true;if(data){self.messageHeader=data.messageHeader;self.messageBody=data.messageBody;}
else{self.messageHeader="Loading";self.messageBody="";}
self.update();})
site.on('hideLoader',function(){self.loaderVisible=false;self.update();})});riot.tag2('tag-raw','','','',function(opts){this.root.innerHTML=opts.content});riot.tag2('tag-raw-cardback','','','',function(opts){this.root.innerHTML=opts.content});riot.tag2('tag-select','<div if="{opts.type == \'select\'}"><div class="select-option group {\'hasvalue\' : opts.value != \'\'}"><select data-jcf="{â—wrapNativeâ—: false, â—wrapNativeOnMobileâ—: false, â—fakeDropInBodyâ—: false, â—useCustomScrollâ—: false}" name="{opts.name}" class="{opts.cls} addvars" onchange="{opts.onchangeevent ? opts.onchangeevent : changed}" id="{opts.fieldid}" value="{current}" no-reorder><option value="">{opts.defaultoption == \'\' ? \'Select\' : opts.defaultoption}</option><option each="{opt in selectedoptions}" value="{opt.value}" __selected="{opts.value == opt.value}">{parent.opts.processaccountnumbers ? site.factory.GetAccountType(parent.opts.processaccountnumbers, opt.displayValue) : site.factory.translate(opt.displayValue)}</option></select><span class="help-block" if="{opts.error}">{opts.error}</span><span class="error-holder"></span></div></div>','tag-select,[riot-tag="tag-select"],[data-is="tag-select"]{ visibility: visible; } tag-select select,[riot-tag="tag-select"] select,[data-is="tag-select"] select{ -webkit-appearance: none; -moz-appearance: none; appearance: none; text-overflow: \'\'; text-indent: 0.01px; text-overflow: ""; } tag-select select::-ms-expand,[riot-tag="tag-select"] select::-ms-expand,[data-is="tag-select"] select::-ms-expand{ display: none; } tag-select .lbl,[riot-tag="tag-select"] .lbl,[data-is="tag-select"] .lbl{ color: #aaa; font-size: 14px; font-weight: normal; position: absolute; pointer-events: none; left: 20px; top: 14px; text-transform: uppercase; } tag-select .hasvalue label.lbl,[riot-tag="tag-select"] .hasvalue label.lbl,[data-is="tag-select"] .hasvalue label.lbl,tag-select .hasfocus label.lbl,[riot-tag="tag-select"] .hasfocus label.lbl,[data-is="tag-select"] .hasfocus label.lbl{ top: -25px !important; font-size: 13px; color: #777; } tag-select .password-meter .progress,[riot-tag="tag-select"] .password-meter .progress,[data-is="tag-select"] .password-meter .progress{ display: none; } tag-select .password-meter .hasvalue .progress,[riot-tag="tag-select"] .password-meter .hasvalue .progress,[data-is="tag-select"] .password-meter .hasvalue .progress{ display: block; } tag-select .help-block,[riot-tag="tag-select"] .help-block,[data-is="tag-select"] .help-block{ opacity: 0; display: none; } tag-select .help-block,[riot-tag="tag-select"] .help-block,[data-is="tag-select"] .help-block{ opacity: 0; top: 10px; position: absolute; left: 10px; -moz-transition: all ease-in-out 0.3s; -o-transition: all ease-in-out 0.3s; -webkit-transition: all ease-in-out 0.3s; transition: all ease-in-out 0.3s; font-style: italic; color: #999; } tag-select .error ~ .help-block,[riot-tag="tag-select"] .error ~ .help-block,[data-is="tag-select"] .error ~ .help-block{ display: none; } tag-select .error ~ .lbl,[riot-tag="tag-select"] .error ~ .lbl,[data-is="tag-select"] .error ~ .lbl{ color: #f02700; } tag-select .form-group:hover .help-block,[riot-tag="tag-select"] .form-group:hover .help-block,[data-is="tag-select"] .form-group:hover .help-block{ opacity: 1; top: 50px; line-height: 1; } tag-select input:-webkit-autofill ~ label.lbl,[riot-tag="tag-select"] input:-webkit-autofill ~ label.lbl,[data-is="tag-select"] input:-webkit-autofill ~ label.lbl{ top: -22px !important; font-size: 13px; color: #777; }','',function(opts){var self=this;self.current=opts.value==undefined?opts.value==undefined?"":opts.val:opts.value;self.checkselected=function(opt){if(self.current===opt.value||self.current===opt.val){return true;}else{return false;}}
self.changed=function(e){site.trigger('select-updated',e);}
self.selectedoptions=opts.selectoptions;self.updateMe=function(){self.selectedoptions=opts.selectoptions;var input=$(self.root).find("select.addvars")[0];if(input.enabled&&input.enabled=="false"){input.setAttribute('disabled','')}
if(input.type&&input.type=="select-one"){for(option in input.options){if(input.options.hasOwnProperty(option)){if(input.options[option].value==opts.value){if(opts.onchangeevent!=undefined&&opts.value!=""){site.trigger("update-fields",{"selectedPropName":input.name,"selectedText":input.options[option].text})}}}}}}
self.on('update',self.updateMe);self.on('update',function(){console.log("select updated");});self.on('mount',function(){if(opts.helptext){var x=opts.helptext;$(self.root).find(".help-block").html(x);}
$('form,input').attr("autocomplete","off");var input=$(self.root).find("select.addvars")[0];Object.keys(opts).forEach(function(key,i){if("label clicktrigger columns class riot-tag type validation selectoptions onchangeevent processaccountnumbers".indexOf(key)==-1){input.setAttribute(key,opts[key]);self.root.removeAttribute(key);}});if(input.enabled&&input.enabled=="false"){input.setAttribute('disabled','')}
if(input.type&&input.type=="select-one"){for(option in input.options){if(input.options.hasOwnProperty(option)){if(input.options[option].value==opts.value){$(input).val(opts.value);if(opts.onchangeevent!=undefined&&opts.value!=""){site.trigger("update-fields",{"selectedPropName":input.name,"selectedText":input.options[option].text})}}}}}
if(self.opts.validation){Object.keys(self.opts.validation).forEach(function(key,i){if("ignore".indexOf(key)==-1){input.setAttribute("required","");if(key=="required"){input.setAttribute("data-rule-"+key,self.opts.validation[key].value);input.setAttribute("data-msg-"+key,self.opts.validation[key].message);}
else{input.setAttribute("data-rule-"+key,self.opts.validation[key].value);input.setAttribute("data-msg-"+key,self.opts.validation[key].message);}}});}
self.thisroot=self.root;self.select=$(self.root).find("select");$(self.select).on('change',function(){if(self.select.find(":selected").attr("value")!=undefined&&self.select.find(":selected").val()!=""){self.select.parent().addClass("hasvalue");}else{self.select.parent().removeClass("hasvalue");}});if(self.select.find(":selected").attr("value")!=undefined&&self.select.find(":selected").val()!=""){self.select.parent().addClass("hasvalue");}
else{self.select.parent().removeClass("hasvalue");}
$(self.root).addClass("form-group");});});riot.tag2('tag-selfservice-nav','<section class="{opts.sectionclass} pt-sm-0 pb-xs-3"> <div class="container"> <div class="pb-0"> <div class="my-profile pb-3"> <div class="row"> <div class="col-md-12 sub-nav-col"> <ul class="list-inline faux-tabs mb-4 list-inline category-list-menu account-nav nav navbar-nav"> <li class="{activemenu != undefined && activemenu.indexOf(\'my-profile\') > 0 ? \'active\' : \'\'} sub-nav-holder" if="{window.culture != \'/en-ng\'}"> <div class="dropdown"> <button id="drop-my-profile" type="button" class="btn btn-link" data-toggle="dropdown" ref="drop-my-profile" aria-haspopup="true" aria-expanded="false">{langTranslateApp.subMenuMyProf} <span class="custom-caret"></span></button> <ul class="dropdown-menu" aria-labelledby="drop-my-profile"> <li class="{activemenu != undefined && activemenu.indexOf(\'update-details\') > 0 ? \'active\' : \'\'}"><a href="#my-profile/update-details" class="dropmyprofile-update-details">{langTranslateApp.contactUpdateDetails}</a></li> </ul> </div> </li> <li class="{activemenu != undefined && activemenu.indexOf(\'my-account\') > 0 ? \'active\' : \'\'} sub-nav-holder"> <div class="dropdown"> <button id="drop-my-account" type="button" class="btn btn-link" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{langTranslateApp.subMenuMyAcc.toUpperCase()} <span class="custom-caret"></span></button> <ul class="dropdown-menu" aria-labelledby="drop-my-account"> <li class="{activemenu != undefined && activemenu.indexOf(\'view-balance\') > 0 ? \'active\' : \'\'}"><span class="dropmyaccount-make-payment"><a href="#my-account/view-balance">{langTranslateApp.subMenuViewMyBal}</a></span></li> <li class="{activemenu != undefined && activemenu.indexOf(\'transaction-history\') > 0 ? \'active\' : \'\'}"><a href="#my-account/transaction-history" class="dropmyaccount-transaction-history">{langTranslateApp.payPaymentHistory.toUpperCase()}</a></li> </ul> </div> </li> <li class="{activemenu != undefined && activemenu.indexOf(\'my-package\') > 0 ? \'active\' : \'\'} sub-nav-holder"> <div class="dropdown"> <button id="drop-my-package" type="button" class="btn btn-link" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">{langTranslateApp.subMenuMyPkg} <span class="custom-caret"></span></button> <ul class="dropdown-menu" aria-labelledby="drop-my-package"> <li class="{activemenu != undefined && activemenu.indexOf(\'fix-errors\') > 0 ? \'active\' : \'\'}"><a href="#my-package/fix-errors" class="dropmypackage-fix-errors">{langTranslateApp.fixErrorHeader}</a></li> <li class="{activemenu != undefined && activemenu.indexOf(\'change-package\') > 0 ? \'active\' : \'\'}"><span class="dropmypackage-change-package"><a href="#my-package/change-package">{langTranslateApp.pkgChangePackage}</a></span></li> </ul> </div> </li> </ul> </div> </div> </div> <div class="headerh3"> <h3 class="page-header {\'nouppercase\' : opts.uppercase} ">{opts.pagename}</h3> </div> </div> <yield></yield> <div class="update-detailes"> <div class="update-details mt-3"> <h4 class="mobile-header">{langTranslateApp.contactDetails}</h4> <div class="form-on-white first-form"> <div class="row step2 pb-2 pt-5 pt-sm-2"> <div class="col-xs-12"> <div class="text-info"></div> <div data-is="tag-form" formview="false"> <form ref="form" novalidate="novalidate" autocomplete="off"> <div> <fieldset> <div class="two-col"> <div> <div type="text" label="Title" class="form-group"> <div class="group hasvalue serial"> <input readonly="readonly" type="text" class="serial addvars" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.Title} name="title"> <div class="wrapper"> <span class="glyphicon glyphicon-info-sign"></span> <div class="tooltip">{langTranslateApp.accToolTip} <a href="{window.culture}/{langTranslateApp.subMenuContactUsLink}" target="_blank">{langTranslateApp.subMenuContactUs}</a></div> </div> <label class="lbl text" for="title" aria-label="Title">{langTranslateApp.contactTitle}</label> </div> </div> </div> <div> <div type="text" label="Name" class="form-group"> <div class="group hasvalue serial"> <input readonly="readonly" type="text" class="serial addvars" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.FirstName} name="firstName"> <div class="wrapper"> <span class="glyphicon glyphicon-info-sign"></span> <div class="tooltip">{langTranslateApp.accToolTip} <a href="{window.culture}/{langTranslateApp.subMenuContactUsLink}" target="_blank">{langTranslateApp.subMenuContactUs}</a></div> </div> <label class="lbl text" for="firstName" aria-label="First Name">{langTranslateApp.contactFirstName}</label> </div> </div> </div> <div> <div type="text" label="Surname" class="form-group"> <div class="group hasvalue serial"> <input readonly="readonly" type="text" class="serial addvars" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.Surname} name="surname"> <div class="wrapper"> <span class="glyphicon glyphicon-info-sign"></span> <div class="tooltip">{langTranslateApp.accToolTip} <a href="{window.culture}/{langTranslateApp.subMenuContactUsLink}" target="_blank">{langTranslateApp.subMenuContactUs}</a></div> </div> <label class="lbl text" for="surname" aria-label="Surname">{langTranslateApp.contactSurname}</label> </div> </div> </div> <div> <div type="text" label="Email Address" class="for m-group"> <div class="group hasvalue serial"><input placeholder=" " id="emailAddress" type="text" class="serial addvars form-control" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.EmailAddress.trim()} name="emailAddress" data-rule-email="true" data-msg-email="Please enter a valid email address"><label class="lbl text" for="emailAddress" aria-label="Email Address">{langTranslateApp.contactEmail}</label><span class="error-holder"></span></div> </div> </div> <div> <div type="tel" label="Mobile Tell" class="form-group"> <div class="group hasvalue serial"><span class="img-globe flagfortelephone" style="{dstvApp.flagposition}" title="{dstvApp.country} +{dstvApp.countryCode}"></span><input placeholder=" " id="cellNumber" type="tel" class="serial addvars form-control" style="padding-left: 30px;" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.MobileTel} error={dstvApp.cellnumbermessage} name="cellNumber" data-rule-checkphoneformat="true" data-msg-checkphoneformat={dstvApp.cellnumbermessage} data-rule-maxlength={dstvApp.cellnumbermaxlength} data-msg-maxlength={dstvApp.cellnumbermaxmessage} data-rule-required="true" data-msg-required={dstvApp.cellnumberrequiredmessage}><label class="lbl text" for="cellNumber" aria-label="Cell Number">{langTranslateApp.contactMobile}</label><span class="lbl text requiredField">*</span><span class="error-holder"></span></div> </div> </div> <div> <div type="tel" label="Home Tel" class="form-group"> <div class="group serial"><span class="img-globe flagfortelephone" style="{dstvApp.flagposition}" title="{dstvApp.country} +{dstvApp.countryCode}"></span><input placeholder=" " id="homeTel" type="tel" class="serial addvars form-control" style="padding-left: 30px;" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.HomeTel} name="homeNumber" data-rule-checkphoneformat="true" data-msg-checkphoneformat={dstvApp.homenumbermessage} data-rule-maxlength={dstvApp.cellnumbermaxlength} data-msg-maxlength={dstvApp.cellnumbermaxmessage}><label class="lbl text" for="homeNumber" aria-label="Home Number">{langTranslateApp.contactHomeTel}</label><span class="help-block hidden">{dstvApp.homenumbermessage}</span><span class="error-holder"></span></div> </div> </div> <div> <div type="tel" label="Work Tel" class="form-group"> <div class="group serial"><span class="img-globe flagfortelephone" style="{dstvApp.flagposition}" title="{dstvApp.country} +{dstvApp.countryCode}"></span><input placeholder=" " id="workTel" type="tel" class="serial addvars form-control" style="padding-left: 30px;" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.WorkTel} name="workNumber" data-rule-checkphoneformat="true" data-msg-checkphoneformat={dstvApp.worknumbermessage} data-rule-maxlength={dstvApp.cellnumbermaxlength} data-msg-maxlength={dstvApp.cellnumbermaxmessage}><label class="lbl text" for="workNumber" aria-label="Work Number">{langTranslateApp.contactWorkTel}</label><span class="help-block hidden">{dstvApp.worknumbermessage}</span><span class="error-holder"></span></div> </div> </div> <div> <div type="tel" label="Fax Tel" class="form-group"> <div class="group hasvalue serial"><span class="img-globe flagfortelephone" style="{dstvApp.flagposition}" title="{dstvApp.country} +{dstvApp.countryCode}"></span><input id="faxNumber" type="tel" class="serial addvars" style="padding-left: 30px;" autocomplete="off" datais="tag-input" cls="serial" value={app.customercontactdetails.FaxTel} name="faxNumber" data-rule-maxlength={dstvApp.cellnumbermaxlength} data-msg-maxlength={dstvApp.cellnumbermaxmessage}><label class="lbl text" for="faxtel" aria-label="Fax Tel">{langTranslateApp.contactFax}</label><span class="help-block hidden">{dstvApp.faxnumbermessage}</span><span class="error-holder"></span> </div> </div> </div> </div> </fieldset> </div> </form> </div> </div> <div class="next-form" style="display:block"> <p></p> <h4 class="mobile-header">{langTranslateApp.contactAddressDetails}</h4> <div class="form-on-white"> <div class="row step2 pb-2 pt-5 pt-sm-2"> <div class="col-xs-12"> <div class="text-info"></div> <div data-is="tag-form" formview="false"> <form ref="form" novalidate="novalidate" autocomplete="off"> <div> <fieldset> <div class="two-col"> <div> <div type="text" label="Country" class="form-group"> <div class="group serial"><input id="txtCountry" readonly="readonly" placeholder=" " type="text" class="serial addvars form-control" autocomplete="off" datais="tag-input" cls="serial" value={app.customeraddressdetails.Country} name="country"> <label class="lbl text" for="country" aria-label="Country">{langTranslateApp.contactCountry}</label><span class="error-holder"></span></div> </div> </div> <div> <div type="select" label="Province" class="form-group"> <div> <div class="select-option group hasvalue serial"> <select no-reorder="" id="ddlProvince" name="province" class="addvars jcf-hidden" value="{app.customeraddressdetails.Province}" datais="tag-select" error="undefined" cls="serial" defaultoption="Select Province" required="" data-rule-required="true" data-msg-required="Please provide Province"> <option class="hide" value="">Select Province</option> <option each="{province, index in app.provincelist.ProvinceList}" value="{province.Description}" selected="{ app.customeraddressdetails && app.customeraddressdetails.Province.toLowerCase() === province.Description.toLowerCase()}">{province.Description}</option> </select> <label class="lbl text" for="provinceName" aria-label="Province">{langTranslateApp.contactProvince}</label> <span class="error-holder"></span> </div> </div> </div> </div> <div> <div type="select" label="City" class="form-group"> <div> <div class="select-option group hasvalue serial"> <select no-reorder="" id="ddlCity" name="city" class="addvars jcf-hidden" value="{app.customeraddressdetails.City}" datais="tag-select" error="undefined" cls="serial" defaultoption="Select City" required="" data-rule-required="true" data-msg-required="Please provide City"> <option class="hide" value="">Select city</option> <option each="{cities, index in app.finalcitieslist.CityList}" value="{cities}" selected="{ app.customeraddressdetails && app.customeraddressdetails.City.toLowerCase() == cities.toLowerCase()}">{cities}</option> </select> <label class="lbl text" for="cityName" aria-label="City">{langTranslateApp.contactCity}</label> <span class="error-holder"></span> </div> </div> </div> </div> <div> <div type="select" label="Suburb" class="form-group"> <div> <div class="select-option group serial"> <select no-reorder="" id="ddlSuburb" name="suburb" class="addvars jcf-hidden" datais="tag-select" error="Please provide Suburb" cls="serial" defaultoption="Select Suburb" required="" data-rule-required="true" data-msg-required="Please provide Suburb"> <option class="hide" value="{app.customeraddressdetails.Suburb}">Select suburb</option> <option each="{suburbs, index in app.suburbsbycity.SuburbPostalCodeList}" value="{suburbs.Suburb}" selected="{app.customeraddressdetails && app.customeraddressdetails.Suburb.toLowerCase() == suburbs.Suburb.toLowerCase()}">{suburbs.Suburb}</option> </select> <label class="lbl text" for="suburbName" aria-label="Suburb">{langTranslateApp.contactSuburb}</label> <span class="error-holder"></span> </div> </div> </div> </div> <div> <div type="text" label="House Number" class="form-group"> <div class="group serial"><input id="houseNumber" placeholder=" " type="text" value={app.customeraddressdetails.HouseNumber} class="serial addvars form-control" autocomplete="off" datais="tag-input" cls="serial" name="physicalBuildingName"><label class="lbl text" for="physicalBuildingName" aria-label="Physical Building Name">{langTranslateApp.contactHouseNumber}</label><span class="error-holder"></span></div> </div> </div> <div> <div type="text" label="Street Name" class="form-group"> <div class="group hasvalue serial"><input id="streetName" placeholder=" " type="text" class="serial addvars form-control" autocomplete="off" datais="tag-input" cls="serial" value={app.customeraddressdetails.Street} name="physicalStreet"><label class="lbl text" for="physicalStreet" aria-label="Physical Street">{langTranslateApp.contactPhysicalStreet}</label><span class="error-holder"></span></div> </div> </div> <div> <div type="hidden" label="Postal Code" class="form-group"> <div class="group serial"><input readonly="readonly" type="text" id="txtPostalCode" value={app.customeraddressdetails.PostalCode} class="serial addvars form-control" autocomplete="off" datais="tag-input" cls="serial" error="Please provide Postal Code" name="physicalPostalCode" required="" data-rule-required="true" data-msg-required="Please provide Postal Code"><label class="lbl text" for="postalcode" aria-label="Postal Code">{langTranslateApp.contactPostalCode}</label></div> </div> </div> </div> </fieldset> </div> </form> </div> </div> <div class="col-xs-12 btn-area pt-5 pb-3 pt-sm-2 pb-sm-2"><button type="button" class="btn btn-default btn-rounded anim-btn cancel-btn"><span class="anim-span"></span>{langTranslateApp.contactCancel}</button><a id="btnSubmit" href="#" onclick={submitUpdateDetails} class="btn btn-primary btn-rounded anim-btn"><span class="anim-span"></span>{langTranslateApp.contactUpdate}</a></div> </div> </div> </div> </div> </div> <div class="row step2 notify pb-2 pt-4 pt-sm-2" id="updateSuccess" style="display:none"> <div> <div class="col-xs-12 text-center"> <div class="inline-block mb-2"><span class="ti icon-Tick_large down-ico"></span></div> </div> <div class="col-xs-12"> <div class="text-info text-center"> <h4 class="mt-3">GREAT! YOUR DETAILS HAVE BEEN UPDATED SUCCESSFULLY</h4> <p><a class="btn btn-primary" id="updateSuccessMessageBtn" href="/#my-profile/update-details">View my profile</a></p> </div> </div> </div> </div> <div class="relative" id="updateProcessing" style="display:none;min-height:300px;"> <div class="loading-loader loading"> <div class="col-sm-12 text-center black-text"> <div class="spinner black-text"></div> <div class="loading-message">{langTranslateApp.dashProcessing}</div> </div> </div> </div> <div class="row step2 notify pb-2 pt-2 pt-sm-2" id="updateError" style="display:none"> <div> <div class="col-xs-12"> <div class="text-info text-center"> <h4 class="mt-3">{langTranslateApp.dashboardLooksLikeProblem}</h4> <p>We were unable to process your request. We\'re sorry for any inconvenience, please try again later or if the problem persists, contact us.</p> <a href="{window.culture}/{langTranslateApp.subMenuContactUsLink}/" class="btn btn-primary mt-3 mb-1">{langTranslateApp.subMenuContactUs}</a> </div> </div> </div> </div> </div> </div> </div> <div class="container"> <div class="changepackagesPS"> <div> <h3 class="pageheader hidden">{langTranslateApp.pkgChangePackage}</h3> <div> <div class="row pb-2 change-package"> <div class="col-xs-12"> <div class="text-info"> <h4 class="package-change-info text-center">{langTranslateApp.pkgHeader}</h4> </div> <div class="list-info package-change-info"> <ul class="decoders"></ul> </div> </div> </div> </div> </div> <div class="package-select-sec"> <div class="row pb-2 pt-5 change-package"> <div class="col-xs-12"> <div class="text-info"> <div class="current-package-header mb-3"> <h4>{langTranslateApp.pkgCurrentlyOn} <strong id="currentlyOnID" class="text-primary"></strong></h4> <div class=""> <div> <div> <div class="current-package-block" ref="" style="background-color:#2bb34d"> <div class="current-package-image img-bg family-pack" style="background-image: url(/media/5138/compact-img.jpg)"></div> <div class="current-package-name">DStv Compact</div> <div class="current-pricebar"> <div class="current-pack-price">{dstvApp.countrycurrency} 305</div> </div> </div> </div> </div> </div> __ </div> </div> <div class="change-package-info text-info"> <h4 class="">{langTranslateApp.pkgEntertainmentAddOn} :</h4> <br> <ul class="packages"></ul> <div class="addOn"> <div class="text-info"> <h4 class="">{langTranslateApp.pkgAddChange}</h4> </div> <ul class="addOnpackages"></ul> </div> </div> <div class="no-package" style="display:none"> <div class="package-error-message"> </div> </div> <div id="paymentSummaryDiv" class="col-md-12 paymentSummary"></div> <div class="col-xs-12 btn-area pt-5 pb-3 pt-sm-2 pb-sm-2"><button class="cancel-butn-package btn btn-default btn-rounded anim-btn"><span class="anim-span "></span>{langTranslateApp.contactCancel}</button></div> </div> </div> </div> <div class="package-select-date-info"> <div class="row pb-2 pt-5 change-package"> <div class="col-xs-12"> <div class="text-info"> <h4 class="text-center">The package you have selected is lower than your existing package so we need to schedule the change from your current <strong class="text-primary">DStv Premium</strong> package to <strong>DStv Family</strong>. <br><br> Please pick a date for the switch that youre comfortable with from the options below.</h4> </div> <ul class="change-date"> <li class="feb-date" data-date-value="2019-02-23T12:00"> <div class="date-block"><span class="c-day">23 </span><span class="c-month">February </span><span class="c-year"> 2019</span><span class="icon-Tick_large check-select"></span></div> </li> <li data-date-value="2019-03-23T12:00"> <div class="date-block"><span class="c-day">23 </span><span class="c-month">March </span><span class="c-year"> 2019</span><span class="icon-Tick_large check-select"></span></div> </li> <li data-date-value="2019-04-23T12:00"> <div class="date-block"><span class="c-day">23 </span><span class="c-month">April </span><span class="c-year"> 2019</span><span class="icon-Tick_large check-select"></span></div> </li> </ul> </div> <div class="col-xs-12 btn-area pt-5 pb-3 pt-sm-2 pb-sm-2"><button class="cancel-butn-package-last btn btn-default btn-rounded anim-btn"><span class="anim-span"></span>Cancel</button></div> </div> </div> <div class="confirm-date-info"> <div> <div class="row pb-2 pt-5 change-package"> <div class="col-xs-12"> <ul class="change-confirm"> <li> <div class="confirm-block c-pack"><span>Your new package is <strong class="text-primary" style="color:#2bb34d">Family</strong></span></div> </li> <li> <div class="confirm-block c-date"><span>To be effective on <strong class="text-primary">23 February 2019</strong></span></div> </li> <li> <div class="confirm-block c-amount"><span>New monthly cost <strong class="text-primary">{dstvApp.countrycurrency}205.00</strong></span></div> </li> </ul> </div> <div class="col-xs-12 btn-area pt-5 pb-3 pt-sm-2 pb-sm-2"><button class="confirm-date-info-btn btn btn-default btn-rounded anim-btn"><span class="anim-span"></span>Cancel</button><a href="#" class="btn btn-primary btn-rounded anim-btn "><span class="anim-span"></span>Confirm</a></div> </div> </div> </div> </div> <div class="container"> <div class="my-profile my-profile-sec"> <div class="row pt-3"> <div class="p-0"> <div> <div class="row" id="smartcardblock"> <label class="selectcard">{langTranslateApp.balSelectSmartCard} :</label> <div class="col-sm-4 col-md-4"> <div if="{app.smartcards != undefined}"> <select onchange="{updateActiveTenureDetails}" id="selectsmartcard" name="selectsmartcard"> <option if="{app.smartcards != undefined}" each="{smartcard, index in app.smartcards}" id="{smartcard.SerialNumber}" value="{smartcard.SerialNumber}" class="custom-class">{smartcard.SerialNumber}</option> </select> </div> </div> </div> <div class=""> <div id="mainblock" class="col-md-6 col-sm-12" if="{ app.paymentduedetails.properties.amountToPay != undefined }"> <div class="row"> <div class="col-sm-12"> <div class="box-holder p-3 pt-4 mb-2" style="height: 268px;"> <h2 class="mb-5 uppercase total-amount">{langTranslateApp.accTotalPay}</h2> <div class="c100 big {site.factory.pieClassesGeneral(site.factory.getDateDiffValue(app.paymentduedetails.properties.dueDate.value),app.paymentduedetails.properties.amountToPay.value)}"> <div class="c-inner"> <div> <a href="javascript:;"> <ol> <li class="cvmtooltip">{site.factory.getDateDiff(app.paymentduedetails.properties.dueDate.value)} {langTranslateApp.balDays}</li> <li>{langTranslateApp.balLeftToPay}</li> <li class="price">{dstvApp.countrycurrency} {app.paymentduedetails.properties.amountToPay.value< 0?0 : app.paymentduedetails.properties.amountToPay.value}</li> <li if="{dstvApp.country == \'angola\'}" class="cvmtooltip">{langTranslateApp.angolaJVText}</li> </ol> </a> </div> </div> <div class="slice"> <div class="bar"></div> <div class="fill"></div> </div> </div> <div if="{ app.filteredResult != undefined }" style="margin-bottom: 35px;" class="text-center" ><a href="javascript:;" id="payOnTime" class="btn btntooltip {payOnTimeCss} tooltips" data-html="true" style="text-transform:none;font-weight:400;">{payOnTimeButtonText}<span id="payOnTimeTooTip" class="tooltipstext">{payOnTimeTooTip}</span><span><span class="glyphicon glyphicon-info-sign"></span></span></a><a href="javascript:;" id="activeTenureDuration" class="btn btntooltip {activeTenureDurationCss} tooltips" style="text-transform:none;font-weight:400;">{activeTenureButtonText}<span class="tooltipstext">{activeTenureDurationToolTip}</span><span><span class="glyphicon glyphicon-info-sign"></span></span></a></div> <a id="viewBalancePayBtn" href="#" data-target="totalamounttopay" class="btn btn-default dark residentialgeneral-button">{langTranslateApp.subMenuPayNow.toUpperCase()}</a> </div> </div> </div> </div> <div id="paymentGrid" class="col-md-6 hidden"> <div class="row"> <div class="col-sm-6 col-sm-8 shPaymentblock mb-2"> <div class="box-holder"> <h2 class="mb-5 uppercase">RESIDENTIAL</h2> <div class="c100 small {site.factory.pieClassesGeneral(site.factory.getDateDiffValue(app.paymentduedetails.properties.dueDate.value),app.paymentduedetails.properties.amountToPay.value)}"> <div class="c-inner"> <div> <a name="residentialgeneral" href="/#my-account/transaction-history"> <ol> <li>{site.factory.getDateDiff(app.paymentduedetails.properties.dueDate.value)} DAYS</li> <li>LEFT TO PAY</li> <li class="price">{dstvApp.countrycurrency} {app.paymentduedetails.properties.balanceAmount.value}</li> </ol> </a> </div> </div> <div class="slice"> <div class="bar"></div> <div class="fill"></div> </div> </div> <a href="#" data-target="landing" class="btn btn-default dark light-button disabled">PAID</a> </div> </div> </div> </div> </div> </div> </div> <div></div> </div> </div> </div> </div> </div></section>','tag-selfservice-nav,[riot-tag="tag-selfservice-nav"],[data-is="tag-selfservice-nav"]{ visibility: visible; }','',function(opts){var self=this;this.mixin('promise');if(app.loggedin){$('.newMenu').css('display','none');$('#navNewClick').css('display','none');$('.headerrightsidemenu').css('float','right');$('#siteCulture').click(function(e){e.preventDefault();return;})
$('#siteCulture').css('cursor','default');;}
self.on('mount',function(){$('[data-toggle="popover"]').popover();$('body').on('click',function(e){if($(e.target).data('toggle')!=='popover'&&$(e.target).parents('.popover.in').length===0){$('[data-toggle="popover"]').popover('hide');}});});});riot.tag2('tag-tab','<div class="my-tab-content"><yield></yield></div>','tag-tab,[riot-tag="tag-tab"],[data-is="tag-tab"]{ visibility: visible; }','',function(opts){var self=this;var thistag=$(self.root);var parentactive=false;self.on('mount',function(){});app.on('checkactive',function(data){if(data===opts.tabname){thistag.find(".my-tab-content").removeClass("hidden");}else{thistag.find(".my-tab-content").addClass("hidden");}});});riot.tag2('tag-tabs','<nav class="nav-tab pb-5 pb-md-4 mb-11 mb-md-4 object-non-visible" data-animation-effect="fadeIn" data-effect-delay="100"><ul class="tabset list-inline"><li if="{tabs.length > 1}" each="{tab, i in tabs}" class="{active: parent.isActiveTab(tab)}"><a href="javascript:void(0)" class="tabItem {is-active: parent.isActiveTab(tab)}" onclick="{parent.toggleTab}">{tab.opts.tabname}</a></li><li if="{tabs.length == undefined}" class="{active: parent.isActiveTab(tabs)}"><a href="javascript:void(0)" class="tabItem {is-active: parent.isActiveTab(tabs)}" onclick="{parent.toggleTab}">{tabs.opts.tabname}</a></li></ul></nav><div class="tab-content object-non-visible" data-animation-effect="fadeIn" data-effect-delay="200"><yield></yield></div>','tag-tabs,[riot-tag="tag-tabs"],[data-is="tag-tabs"]{ visibility: visible; } tag-tabs .tabs-wrapper,[riot-tag="tag-tabs"] .tabs-wrapper,[data-is="tag-tabs"] .tabs-wrapper{ position: relative; display: inline-block; width: 100%; height: 50px; overflow: hidden; } tag-tabs .scrolltab-scroller,[riot-tag="tag-tabs"] .scrolltab-scroller,[data-is="tag-tabs"] .scrolltab-scroller{ position: absolute; z-index: 1; -webkit-tap-highlight-color: rgba(0,0,0,0); display: block; width: auto; height: 50px; white-space: nowrap; } tag-tabs .scrolltab-scroller ul,[riot-tag="tag-tabs"] .scrolltab-scroller ul,[data-is="tag-tabs"] .scrolltab-scroller ul{ list-style: none; padding: 0; margin: 0; width: 100%; text-align: center; display: inline-block; width: auto; white-space: nowrap; }','',function(opts){var self=this;self.tabs=[];self.on('mount',function(){self.tabs=self.tags["tag-tab"];if(self.tabs.length){self.activeTab=self.tabs[0].opts.tabname;app.trigger("checkactive",self.activeTab);}else{self.activeTab=self.tabs.opts.tabname;app.trigger("checkactive",self.activeTab);}
self.update();});self.isActiveTab=function(tab){return self.activeTab===tab.opts.tabname;}
self.toggleTab=function(e){self.activeTab=e.item.tab.opts.tabname;app.trigger("checkactive",self.activeTab);return true;}});riot.tag2('tag-type-a-head','<div class="chatbot-holder"><div class="modal-block"></div><div id="bot"></div></div><div class="container" if="{!opts.inpage}"><div class="row"><div class="col-md-8 col-md-offset-2 col-xs-12 col-xs-offset-0 fullscreen relative"><form data-ref="searchform" action="/search/" class="search-form"><div class="input-holder mt-sm-5"><input data-ref="searchinput" class="form-control search" name="search" id="{opts.myid}" type="search" placeholder="{opts.placeholdertext || \'Enter search term...\'}" autocomplete="off"><button class="search-btn" type="submit"><div class="loading-anim"></div><i class="ti ti-search"></i></button><button data-ref="closesearch" id="closeSearch" type="button"><i class="ti ti-close"></i></button><div class="drop-content"></div></div><div if="{opts.displayslide == \'true\' && mobileDisplay && marqueeDisplay}" data-ref="galleryholder" class="gallery-holder"><div class="gallery-frame"><yield></yield><ul data-ref="wheelcarousel" class="wheel-carousel"></ul></div><div if="{loadingMarquee}" class="loading-loader loading"><div class="gallery-frame text-center white"><div class="spinner white"></div><div class="loading-message">Loading</div></div></div></div></form></div><div if="{opts.displayslide == \'true\' && !mobileDisplay && marqueeDisplay}" class="col-md-2 col-md-pull-1 col-xs-12 col-xs-offset-0 col-lg-2 col-lg-pull-0 fullscreen gallery-container"><div data-ref="galleryholder" class="gallery-holder"><div class="gallery-frame"><yield></yield><ul data-ref="wheelcarousel" class="wheel-carousel"></ul></div><div if="{loadingMarquee}" class="loading-loader loading"><div class="gallery-frame text-center white"><div class="spinner white"></div><div class="loading-message">Loading</div></div></div></div></div><ul data-ref="wheelcopy" class="hidden"></ul></div></div><form data-ref="searchform" action="/search/" class="search-form hidden" if="{opts.inpage}"><div class="input-holder mt-sm-5"><input data-ref="searchinput" class="form-control search" name="search" id="{opts.myid}" type="search" placeholder="{opts.placeholdertext || \'Enter search term...\'}" autocomplete="off"><button class="search-btn" type="submit"><div class="loading-anim"></div><i class="ti ti-search"></i></button><button data-ref="closesearch" id="closeSearch" type="button"><i class="ti ti-close"></i></button><div class="drop-content"></div></div></form>','tag-type-a-head,[riot-tag="tag-type-a-head"],[data-is="tag-type-a-head"]{ visibility: visible; } tag-type-a-head .typing .drop-content,[riot-tag="tag-type-a-head"] .typing .drop-content,[data-is="tag-type-a-head"] .typing .drop-content{ display: block !important; } tag-type-a-head .typing .drop-content .ui-autocomplete,[riot-tag="tag-type-a-head"] .typing .drop-content .ui-autocomplete,[data-is="tag-type-a-head"] .typing .drop-content .ui-autocomplete{ top: 0 !important; left: 0 !important; display: block !important; } tag-type-a-head .typing .drop-content .ui-autocomplete .result.show,[riot-tag="tag-type-a-head"] .typing .drop-content .ui-autocomplete .result.show,[data-is="tag-type-a-head"] .typing .drop-content .ui-autocomplete .result.show{ top: 0 !important; left: 0 !important; display: block !important; }','',function(opts){var getUrlParameter=function getUrlParameter(sParam){var sPageUrl=decodeURIComponent(window.location.search.substring(1)),sUrlVariables=sPageUrl.split('&'),sParameterName,i;for(i=0;i<sUrlVariables.length;i++){sParameterName=sUrlVariables[i].split('=');if(sParameterName[0]===sParam){return sParameterName[1]===undefined?true:sParameterName[1];}}};var self=this;self.selectfunction=opts.selectfunction||"selectItem";self.tagId="type-"+self._id;self.myid=opts.myid||"search-query";self.mod1="";self.mod2="";self.placeholdertext=opts.placeholdertext;self.loadingMarquee=true;self.marqueeDisplay=true;self.marqueeRunning=false;self.fetchAll=true;self.marqueeTries=50;self.mobileDisplay=false;if(StyleMixin!==undefined)
self.mixin(StyleMixin);self.on('mount',function(){var searchUrl=opts.searchsrc?opts.searchsrc:"http://gd.geobytes.com/AutoCompleteCity?callback=?&q=";if(!app["marquee-responses"]&&opts.view=="homepage"){var marqueeUrl="/umbraco/api/WebApiLuis/GetAllStoredResponses/";}else if(app["marquee-responses"]&&opts.view=="homepage"){self.buildMarqueeData(app["marquee-responses"]);}
self.screenCheck();initCustomForms();$("body").on("click",".drop-search-btn",function(e){e.preventDefault();$("form.search-form").submit();});$(self.refs.closesearch).on("click",function(){$(self.refs.searchform).removeClass("typing");var txtBox=$(self.refs.searchinput);txtBox.val('');txtBox.focus();});var searchParam=getUrlParameter("search");if(searchParam!==""&&searchParam!=null){$("#"+self.myid).val(searchParam.replace(/\+/g,' '));}
self.GetPlaceholderText();self.checkclearsearch=function(item,clear){if($(item).val()!=""&&!clear){$(self.refs.searchform).addClass("typing");};if(clear){$(item).val("");};};$(document).ready(function(){$(".input-holder input").on("click",function(){self.checkclearsearch("#"+self.myid,false);});$("#"+self.myid).on("blur",function(){$(this).prop("placeholder",self.placeholdertext);});$("#"+self.myid).on("focus",function(){$(this).prop("placeholder","");});});self.getData=function(request,response){$.getJSON(self.opts.searchsrc+request.term,function(data){self.fetchedData=data;if(data!==null&&data!==undefined){response(data.Result);}
$(".loading-anim").hide();$(".search-btn").removeClass("windows-search");});};self.selectItem=function(event,ui){if(ui.item!=undefined){$("#"+self.myid).val(ui.item.value);}
return false;}
if(!opts.resultdisplay&&!opts.resulturl){$(self.root).on('keydown.autocomplete',"#"+self.myid,function(){$(this).autocomplete({source:self.getData,select:self[self.selectfunction],minLength:2}).data("ui-autocomplete")._renderItem=function(ul,items){var that=this;$("<li id='drop-top'></li><li id='drop-content' aria-label='hi'></li>").appendTo(ul);$("<div></div>").appendTo($("#drop-content"));setMaxWidth();$.each(items,function(index,item){return $("<div></div>").data('ui-autocomplete-item',item).append("<a href='"+item+"'><i class='ti-file'></i> "+item+"</a>").appendTo($("#drop-content > div"));});};});}
$("#"+self.myid).on("autocompleteopen",function(event,ui){self.checkclearsearch("#"+self.myid,false);});$("#"+self.myid).on("autocompleteclose",function(event,ui){});function setMaxWidth(){var w=$("#"+self.myid).outerWidth();self.addCSSRule(".ui-autocomplete","max-width:"+w+"px !important;");}
var waitForFinalEvent=(function(){var timers={};return function(callback,ms,uniqueId){if(!uniqueId){uniqueId="Don't call this twice without a uniqueId";}
if(timers[uniqueId]){clearTimeout(timers[uniqueId]);}
timers[uniqueId]=setTimeout(callback,ms);};})();setMaxWidth();$(window).resize(function(){waitForFinalEvent(function(){var w=$("#"+self.myid).outerWidth();self.updateCSSRule(".ui-autocomplete"," max-width:"+w+"px !important;");},500,"type");setTimeout(function(){self.screenCheck();if(opts.view=="homepage"){self.refreshMarquee();}},100);});$('.search-opener').on('click',function(e){e.preventDefault();if($('body').hasClass('search-active')){if($(self.refs.galleryholder).data('MarqueeHorizontal')){$(self.refs.galleryholder).data('MarqueeHorizontal').destroy();$(self.refs.wheelcarousel).html('');}
if($(self.refs.galleryholder).data('Marquee')){$(self.refs.galleryholder).data('Marquee').destroy();$(self.refs.wheelcarousel).html('');}
if($("#for-menu-on-desktop .search-opener").hasClass("for-menu-on-mobile-search")||$("#for-package-landing-page .search-opener").hasClass("for-menu-on-mobile-search")){$("#for-menu-on-desktop > a.search-opener").removeClass("for-menu-on-mobile-search");$("#for-menu-on-desktop > a.search-opener").css("visibility","");$("#for-package-landing-page a.search-opener").removeClass("for-menu-on-mobile-search");$("#for-package-landing-page a.search-opener").css("visibility","");$(".nav-active #header .container-fluid").removeClass("hidden");$(".nav-active #nav").removeClass("hidden");$("#for-menu-on-desktop .search-opener").removeClass("for-menu-on-mobile-search")
$("#for-menu-on-desktop .search-opener").css("visibility","");$("body.tag-page-home.nav-active .banner-block .search-opener, body.tag-page-home.search-active #header, body.tag-page-ng-home.nav-active .banner-block .search-opener, body.tag-page-ng-home.search-active #header").css("z-index","");}
self.marqueeDisplay=false;self.marqueeRunning=false;self.update();}else{if(e.currentTarget.id==='for-menu-on-mobile-search'){$(".nav-active #header .container-fluid").addClass("hidden");$(".nav-active #nav").addClass("hidden");$("#for-menu-on-desktop > a.search-opener").addClass("for-menu-on-mobile-search");$("#for-menu-on-desktop > a.search-opener").css("visibility","visible");$("#for-package-landing-page a.search-opener").addClass("for-menu-on-mobile-search");$("#for-package-landing-page a.search-opener").css("visibility","visible");$("#for-menu-on-desktop .search-opener").addClass("for-menu-on-mobile-search");$("#for-menu-on-desktop .search-opener").css("visibility","visible");$("body.tag-page-home.nav-active .banner-block .search-opener, body.tag-page-home.search-active #header, body.tag-page-ng-home.nav-active .banner-block .search-opener, body.tag-page-ng-home.search-active #header").css("z-index","999");}
self.loadingMarquee=false;self.marqueeDisplay=true;self.marqueeRunning=false;self.update();self.loadMarquee();}});$(self.root).on('click','ul.wheel-carousel > li a',function(e){if($(e.target).data("hasurl")===true){return;}
var searchPhrase=e.target.innerText;$(self.refs.closesearch).click();$(self.refs.searchinput).val(searchPhrase).trigger("keydown");});});self.GetPlaceholderText=function(){}
site.on('loggedout',function(){self.GetPlaceholderText();});site.on("customerloaded",function(){self.GetPlaceholderText();});self.GetName=function(){var firstName=app[app.customernumber].properties.firstName.value;return firstName.charAt(0)+firstName.substr(1).toLocaleLowerCase();}
self.loadMarquee=function(){if($(self.refs.wheelcopy).html().length){self.loadingMarquee=false;$(self.refs.wheelcarousel).append($(self.refs.wheelcopy).html());self.marqueeDisplay=true;self.marqueeRunning=true;self.update();initMarquee();}else if(self.marqueeTries){setTimeout(function(){self.loadMarquee();},300);self.marqueeTries--;}}
self.refreshMarquee=function(){if(self.marqueeRunning){if($(self.refs.galleryholder).data('MarqueeHorizontal')){$(self.refs.galleryholder).data('MarqueeHorizontal').destroy();$(self.refs.wheelcarousel).html('');}
if($(self.refs.galleryholder).data('Marquee')){$(self.refs.galleryholder).data('Marquee').destroy();$(self.refs.wheelcarousel).html('');}
self.marqueeDisplay=false;self.marqueeRunning=false;self.update();setTimeout(function(){self.marqueeDisplay=true;self.update();self.loadMarquee();console.log('marquee refreshed');},200);}}
site.on("marquee-responses-loading-success",function(data,result){if(result){self.buildMarqueeData(data);}});self.buildMarqueeData=function(data){$.each(data,function(index,item){var hasUrl=false;var searchTerm=item.Query;var linkedItemUrl="#";var linkedItemJson=JSON.parse(item.LinkToItem);if(searchTerm=="Holiday home"||searchTerm=="Decoder Insurance"||searchTerm=="BoxOffice")return;if(linkedItemJson!=null){linkedItemUrl=linkedItemJson.url;hasUrl=true;}
$(self.refs.wheelcopy).append("<li> <a href='"+linkedItemUrl+"' data-hasurl='"+hasUrl+"'>"+searchTerm+"</a></li>");});self.fetchAll=false;self.loadingMarquee=false;self.update();}
self.screenCheck=function(){self.mobileDisplay=$(window).width()>991?false:true;self.update();}});riot.tag2('page-home','<yield></yield><main id="main" role="main"><div class="package"><tag-compare-slider apidomain="" currency="{dstvApp.countrycurrency}" sectionclass="bg-white" comparepackages="/packages/ujson?descendants=Package&where=isNigeria%20ne%20true%20and%20canCompare%20eq%20true&select=code,description,Name,newPrice,packageColor,Currency,Id,packageLogo,packageName,price,productImage,additionalProductImage,productDetail,appHeading,appTextColor,productMoreLink,packageFeatures,description,currency,channelCount,PriceLetter,canCompare&resolvemedia=productImage,additionalProductImage,packageLogo&cdv={cdv}" allchannels="/channels/ujson?descendants=Channel&select=channelName,ChannelGenre,ChannelPackages,ChannelLogo,AudioChannel,ChannelNumber&resolveToIds=ChannelGenre,ChannelPackages&resolveMedia=ChannelLogo&cdv={cdv}"><yield to="header"><div class="heading-area"><div class="container"><span class="sub">{langTranslateApp.browsercomparetitle}</span><h2 class="uppercase">{langTranslateApp.packagetitle}</h2></div></div></yield><yield to="footer"><div class="low-area"><div class="container"><div class="wrap"><span class="arrow-btn-label">{langTranslateApp.comparePkg}</span><a href="{window.culture}{langTranslateApp.subMenuGetComparePackagesLink}/"><button class="slick-next slick-arrow bg-gradient-45 arrow-font-color" style="display: block;" aria-disabled="false"><span class="icon-ico-arrow-next"></span></button></a></div></div></div></yield></tag-compare-slider></div><div class="package1"><tag-compare-slider apidomain="" currency="{dstvApp.countrycurrency}" sectionclass="bg-white" comparepackages="/packages/ujson?descendants=Package&where=isNigeria%20ne%20true%20and%20canCompare%20eq%20true&select=code,description,Name,newPrice,packageColor,Currency,Id,packageLogo,packageName,price,productImage,additionalProductImage,productDetail,appHeading,appTextColor,productMoreLink,packageFeatures,description,currency,channelCount,PriceLetter,canCompare&resolvemedia=productImage,additionalProductImage,packageLogo&cdv={cdv}" allchannels="/channels/ujson?descendants=Channel&select=channelName,ChannelGenre,ChannelPackages,ChannelLogo,AudioChannel,ChannelNumber&resolveToIds=ChannelGenre,ChannelPackages&resolveMedia=ChannelLogo&cdv={cdv}"><yield to="header"><div class="heading-area"><div class="container"><span class="sub">{langTranslateApp.browsercomparetitle}</span><h2 class="uppercase">{langTranslateApp.packagetitle}</h2></div></div></yield><yield to="footer"><div class="low-area"><div class="container"><div class="wrap"><span class="arrow-btn-label">{langTranslateApp.comparePkg}</span><a href="{window.culture}{langTranslateApp.subMenuGetComparePackagesLink}/"><button class="slick-next slick-arrow bg-gradient-45 arrow-font-color" style="display: block;" aria-disabled="false"><span class="icon-ico-arrow-next"></span></button></a></div></div></div></yield></tag-compare-slider></div><tag-decoder-slider apidomain="" currency="{dstvApp.countrycurrency}" sectionclass="bg-decoder" comparedecoders="/decoders/ujson?descendants=Package&where=isNigeria%20ne%20true%20and%20canCompare%20eq%20true&select=code,description,Name,newPrice,packageColor,Currency,Id,packageLogo,packageName,price,productImage,additionalProductImage,productDetail,appHeading,appTextColor,productMoreLink,packageFeatures,description,canCompare,priceLetter&resolvemedia=productImage,additionalProductImage,packageLogo&cdv={cdv}" ><yield to="header"><div class="heading-area"><div class="container"><span class="sub">{langTranslateApp.browserdecoderhm}</span><h2 class="uppercase">{langTranslateApp.decoderthitlehm}</h2></div></div></yield><yield to="footer"><div class="low-area"><div class="container"><div class="wrap"><span class="arrow-btn-label">{langTranslateApp.compareDec}</span><a href="{window.culture}/{langTranslateApp.decodersList}/"><button class="slick-next slick-arrow bg-gradient-45 arrow-font-color" style="display: block;" aria-disabled="false"><span class="icon-ico-arrow-next"></span></button></a></div></div></div></yield></tag-decoder-slider><div class="section-hidden"><tag-shows-slider></tag-shows-slider><tag-news-slider sectionclass="bg-white" servicename="dstvnews" serviceurl="/api-news/news/ujson?children=true&select=Name,coverImage,Id,articleUrl,title,subTitle,footerButtonText,footerButtonUrl,featuredBackground&resolveMedia=coverImage,featuredBackground&cdv={cdv"><yield to="header"><div class="heading-area"><div class="container"><h2>{model.properties.SubTitle}</h2><span class="sub">{model.properties.Title}</span></div></div></yield><yield to="footer"><div class="low-area"><div class="container"><div class="wrap"><span class="arrow-btn-label">{langTranslateApp.homeMoreNews.toUpperCase()}</span><a href="{model.properties.FooterButtonUrl}"><button class="slick-next slick-arrow bg-gradient-45 arrow-font-color" style="display: block;" aria-disabled="false"><span class="icon-ico-arrow-next"></span></button></a><a href="{model.properties.FooterButtonUrl}" class="hidden btn btn-primary track_homebutton"><span class="anim"></span>{langTranslateApp.homeMoreNews.toUpperCase()}</a></div></div></div></yield></tag-news-slider><tag-tvguide-slider></tag-tvguide-slider><tag-manage-section></tag-manage-section></main>','page-home,[riot-tag="page-home"],[data-is="page-home"]{ visibility: visible; }','',function(opts){var self=this;self.model={};self.cdv=window.cdv;self.routename='page-home';site.on('loggedout',function(){self.update();});self.on('mount',function(){});self.on('update',function(){});site.on('routeChanged',function(page){if(page===self.routename){self.initializePage();}
else{}});self.initializePage=function(){initSlickCarousel();initInViewport();initAnchors();jcf.replaceAll();jQuery('.video:has(.video-item)').each(function(){var videoHolder=jQuery(this);var videoItem=videoHolder.find('.video-item');var delay=500;var src=videoItem.attr('data-video-id');var startat="0";var stopat="150";var autoPlay="true";var mute="true";var volume="0";var loop="true";var containment="self";var background=true;videoItem.attr('data-property',"{ videoURL: '//youtu.be/"+src+"', autoPlay: true, loop: true, mute: true, startAt: 0, stopAt: 150, opacity: 1, quality: 'default' }");var myPlayer;setTimeout(function(){myPlayer=videoItem.YTPlayer({showControls:false,containment:videoHolder,showControls:false,playOnlyIfVisible:true,});videoItem.stop().animate({opacity:0},1);myPlayer.on('YTPReady',function(){videoItem.stop().animate({opacity:1},delay);});},1000)});$(self.root).on('click','.myclass',function(e){e.preventDefault();window.consolelog($(this));});}
site.on("customerloaded",function(){if(self.routename===app.currentroute){}});});riot.tag2('tag-application','<yield></yield><tag-routes ></tag-routes><tag-clear-errors-data></tag-clear-errors-data><tag-loading></tag-loading><tag-feedback view="modal"></tag-feedback><tag-tracker></tag-tracker>','tag-application,[riot-tag="tag-application"],[data-is="tag-application"]{ visibility: visible; }','',function(opts){var self=this;self.PropertyConfig={};site.on('loggedout',function(){self.update();});self.on('mount',function(){let arrayDualCurrencyContries=[];let arrayDualCurrencies=[];for(var i=0;i<dstvApp.DualCurrenciesList.length;i++){var split=dstvApp.DualCurrenciesList[i].split("-");arrayDualCurrencyContries.push(split[0]);arrayDualCurrencies.push(split[1]);}
$('.switch-input').change(function(){console.log('Toggle clicked');self.onCurrencyToggle();});self.showHidePriceTags=function(){if(app.dualCurrencyApplicable){$('.usdPrice').hide();$('.etbPrice').show();$('.usdCurrency').hide();$('.etbCurrency').show();$('.actualValue').hide();$('.etbValue').show();}
else{$('.etbPrice').hide();$('.usdPrice').show();$('.etbCurrency').hide();$('.usdCurrency').show();$('.etbValue').hide();$('.actualValue').show();}}
if(dstvApp.DualCurrency&&app.dualCurrencyApplicable){console.log('Dual currency is ON');var setToggleSwitch=function(){$('#toggleSwitch').addClass('jcf-label-active');$('.jcf-checkbox').removeClass('jcf-checked').addClass('jcf-unchecked');$('.switch-input').prop('checked',false);let currencyToggleStatus=$('.switch-input').prop('checked');site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);};setTimeout(setToggleSwitch,50);try{var dualPackageValues=$('#dualPackageValues').attr('class').split('~');var currency=dualPackageValues[1].toString();var price=dualPackageValues[2].toString();var price_tag1=$('.etbPrice')[0];var price_span='<span class="currencyStyleHmPgBanner">'+currency+'</span><span class="priceStyle">'+price+'</span>';price_tag1.innerHTML=price_span;self.showHidePriceTags();}
catch(e){}}
else{console.log('Dual currency is OFF');var setToggleSwitch=function(){$('#toggleSwitch').removeClass('jcf-label-active');$('.jcf-checkbox').removeClass('jcf-unchecked').addClass('jcf-checked');$('.switch-input').prop('checked',true);let currencyToggleStatus=$('.switch-input').prop('checked');site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);};setTimeout(setToggleSwitch,50);try{var dualPackageValues=$('#dualPackageValues').attr('class').split('~');var currency=dualPackageValues[1].toString();var price=dualPackageValues[2].toString();var etbPrice1=dualPackageValues;if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)){var price_tag1=$('.etbPrice')[0];var price_span='<span class="currencyStyleHmPgBanner">'+currency+'</span><span class="priceStyle">'+price+'</span>';price_tag1.innerHTML=price_span;}
self.showHidePriceTags();}
catch(e){}}
self.onCurrencyToggle=function(){let currencyToggleStatus=$('.switch-input').prop('checked');if(currencyToggleStatus!==undefined){site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);}
self.setDualCurrencyFlag();self.showHidePriceTags();self.setPricingInModuleSection();riot.mount('tag-compare-slider');};self.setDualCurrencyFlag=function(){console.log('On setDualCurrencyFlag : After Currency Toggle');if(arrayDualCurrencies.includes(dstvApp.countrycurrency.toLowerCase())){app.dualCurrencyApplicable=true;window.SessionSave("app",app);}
else{app.dualCurrencyApplicable=false;window.SessionSave("app",app);}}
self.hideToggle=function(){$('.currencyToggle').hide();}
if(!dstvApp.DualCurrency||(!dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))||(window.location.href.includes('/decoders/'))||dstvApp.countryabbreviation=='mu'){self.hideToggle();}
if(dstvApp.countryabbreviation!=='mu'){self.showDualCurrencyDecoderPricing();self.setPricingInModuleSection();}});site.on('routeChanged',function(page){if(page!="page-home"&&page!="page-ng-home"){$("body").removeClass("home-page");}else{$("body").addClass("home-page");}
$("body[class*='tag-page-']").removeClass(function(index,css){return(css.match(/(^|\s)tag-page-\S+/g)||[]).join(' ');});$("body").addClass("tag-"+page);});self.showDualCurrencyDecoderPricing=function(){if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)&&window.location.href.includes('/decoders/')){let price_tag=document.getElementsByTagName("h2")[0];let price_span='<span class="currencyStyleHmPgBanner">'+'ETB'+'</span><span class="priceStyle">'+price.replace('USD','')+'</span>';price_tag.innerHTML=price_span;price_tag.style.display="block";}}
self.setPricingInModuleSection=function(){if(dstvApp.DualCurrency&&dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)){let dualPackageValues=$('#dualPackageValues').attr('class').split('~');let etbCurrency=dualPackageValues[1].toString();let etbPrice=dualPackageValues[2].toString();let usdCurrency='USD';let usdPrice=$('.usdPrice').text().split('USD')[1];if(app.dualCurrencyApplicable){$('.modulePrice').text(etbCurrency+' '+etbPrice);}
else{$('.modulePrice').text(usdCurrency+' '+usdPrice);}}}});riot.tag2('tag-routes','<router on-routechange="fireRouteChange" on-tagnotfound="fireTagnotfound"><route path="/" component="page-home"></route><route path="home" component="page-home"></route><route path="/main" component="page-home"></route><route path="ng-home" component="page-ng-home"></route><route path="login" component="page-login"></route><route path="decoders" component="page-decoders"></route><route path="feedback" component="page-feedback"></route><route path="moments" component="page-moments"></route><route path="my-profile" component="page-update-details"></route><route path="my-profile"><route path="/update-details" component="page-update-details"></route></route><route path="/manage" component="page-manage"></route><route path="my-account" component="page-my-account"></route><route path="my-account"><route path="/insure-decoder" component="page-insure-decoder"></route><route path="/link-showmax" component="page-link-showmax"></route><route path="/transaction-history" component="page-transaction-history"></route><route path="/my-statements" component="page-my-statements"></route><route path="/my-statements" component="page-my-statements"></route><route path="/my-statements" component="page-my-statements"></route><route path="/view-balance" component="page-view-balance"></route><route path="/set-up-debit-order" component="page-set-up-debit-order"></route><route path="/view-balance" component="page-make-payment"></route><route path="/view-balance/*" component="page-make-payment"></route><route path="/*" component="page-my-account"></route></route><route path="my-package"><route path="/fix-errors" component="page-fix-errors"></route><route path="/change-package" component="page-change-package"></route><route path="/holiday-viewing" component="page-holiday-viewing"></route><route path="/reconnect-packages" component="page-reconnect-packages"></route><route path="/upgrade-package" component="page-upgrade-package"></route></route><route path="customer"><route path="/*" component="tag-customer"></route></route><route path="generic"><route path="/*" component="tag-generic"></route></route></router>','','',function(opts){});riot.tag2('tag-tracker','','tag-tracker,[riot-tag="tag-tracker"],[data-is="tag-tracker"]{ visibility: visible; }','',function(opts){var self=this;self.mixin('tracker');site.on("track-postdata-error",function(data){self.track('postdataerror',data);});site.on("track-getdata-error",function(data){self.track('getdataerror',data);});site.on("track-setdata-error",function(data){self.track('setdataerror',data);});site.on("track-api-retry-fail",function(data){self.track('apiretryfail',data);});site.on("track-connect-login-success",function(data){self.track('connectsuccess',data);});site.on("track-connect-login-error",function(data){self.track('connecterror',data);});});riot.tag2('tag-error','','tag-error,[riot-tag="tag-error"],[data-is="tag-error"]{ visibility: visible; }','',function(opts){var self=this;self.mixin('tracker');});riot.tag2('tag-modal-popup','<div class="modal fade dashboardModal" id="commonModalPopup" role="dialog" data-backdrop="static" data-keyboard="false"><div class="webform container modal-dialog modal-lg feedback-dialog"><div class="modal-content"><div class="modal-body"><div class="container-fluid main-section"><div class="popup {indicatorTypeClass}"><div class="row"><div class="modal-content-inner"><div class="icon-img-common"></div><h2>{opts.mainheading}</h2><hr class="status-pay"><h4>{opts.subheading}</h4><p>{opts.description}</p><div if="{opts.showretrybutton}"><p>{langTranslateApp.dashPlzTryAgainAndContactUs}</p></div> </div><div class="modal-cta" if="{opts.showclosebutton}"><a id="modalClose0101" href="javascript:void(0)" onclick={modalClose0101} class="cta " data-dismiss="modal">{opts.closebuttontext || "Close"}<span class="icon icon-Close_M"></span></a> <a if="{opts.enableChat}"id="modalClose0101" href="javascript:void(0)" onclick={window.openChatWindow} class="cta " data-dismiss="modal">{langTranslateApp.chatToUs}</a></div></div></div></div><div class="clearfix"></div></div></div></div></div>','tag-modal-popup,[riot-tag="tag-modal-popup"],[data-is="tag-modal-popup"]{ visibility: visible; } tag-modal-popup select,[riot-tag="tag-modal-popup"] select,[data-is="tag-modal-popup"] select{ display: none !important; }','',function(opts){var self=this;self.indicatorTypeClass=opts.state=='error'?'unsuccessful':'success';self.indicatorTypeURL=opts.state=='error'?"/media/8074/warning_new_img.png":"/media/8073/tickmark_icon.png"
self.closeButtonIcon=opts.closebuttontext&&opts.closebuttontext.toLowerCase().includes('cell number')?'icon icon-ico-call-2':'icon icon-Arrow_right_thin';self.update();self.on('mount',function(){if(opts.showmodel)
$('#commonModalPopup').modal('show');$('.btnClose').click(function(){})});self.modalClose0101=function(e){if(typeof opts.callback==='function')
opts.callback();}})
riot.tag2('tag-modal-popup1','<div class="modal fade dashboardModal" id="commonModalPopup" role="dialog"><div class="webform container modal-dialog modal-lg feedback-dialog"><div class="modal-content"><div class="modal-body"><div class="container-fluid main-section"><div class="popup {indicatorTypeClass}"><div class="row"><div class="modal-content-inner"><div class="icon-img-common"></div><h2>{opts.mainheading}</h2><hr class="status-pay"><h4>{opts.subheading}</h4><p>{opts.description}</p><div if="{opts.showretrybutton}"><p>{langTranslateApp.dashPlzTryAgainAndContactUs}</p></div> </div><div class="modal-cta" if="{opts.showclosebutton}"><a id="modalClose0101" href="javascript:void(0)" onclick={modalClose0101} class="cta " data-dismiss="modal">{opts.closebuttontext || "Close"}<span class="icon icon-Close_M"></span></a> </div></div></div></div><div class="clearfix"></div></div></div></div></div>','tag-modal-popup1,[riot-tag="tag-modal-popup1"],[data-is="tag-modal-popup1"]{ visibility: visible; } tag-modal-popup1 select,[riot-tag="tag-modal-popup1"] select,[data-is="tag-modal-popup1"] select{ display: none !important; }','',function(opts){var self=this;self.indicatorTypeClass=opts.state=='error'?'unsuccessful':'success';self.indicatorTypeURL=opts.state=='error'?"/media/8074/warning_new_img.png":"/media/8073/tickmark_icon.png"
self.closeButtonIcon=opts.closebuttontext&&opts.closebuttontext.toLowerCase().includes('cell number')?'icon icon-ico-call-2':'icon icon-Arrow_right_thin';self.update();self.on('mount',function(){if(opts.showmodel)
$('#commonModalPopup').modal('show');$('.btnClose').click(function(){})});self.modalClose0101=function(e){if(typeof opts.callback==='function')
opts.callback();}})
riot.tag2('tag-sign-in','<div class="modal fade dashboardModal" id="signInModalPopup" role="dialog" data-backdrop="static" data-keyboard="false"> <button type="button" onclick="{OnClose}" class="close btnClose" data-dismiss="modal" aria-label="Close Modal"><i class=" icon-Close_M"></i></button> <div class="webform container modal-dialog feedback-dialog 1 {temp}"><div id="cpoverlay"> <div class="cv-spinner"> <span class="cpspinner"></span></div> </div> <div class="modal-content"> <div class="modal-body"> <div class="loginPage dvsloginPage siam bodyClass"> <section id="section1" class="SignInSection1"><div id="ciam-sm-login-screen" class="text-left p-5"> <h4>{langTranslateApp.ciamLinkAcTxt}</h4> <form class="ciam-sm-login-form"> <label class="mb-0">{langTranslateApp.ciamSelectCountry}</label> <select class="form-control" id="ciamddlCountry" name="ciamCountryDropdown" onchange="{onCountryDropdownChange}"> <option each="{country, index in allCountryCultureDetails}"if={allCountryCultureDetails} value={country.countryAbbreviation}-{country.countryLanguageAbbreviation}>{country.countryNameLanguage}</select> <input type="text" class="form-control input-lg" id="ciam_smartCardNumber" name="ciam_smartCardNumber" maxlength="11" placeholder={langTranslateApp.loginSmartcardNumber} onkeyup="{validateSmartCard}"/><p style="display:none;color: red;font-weight: bold;">{inValidSearchSM}</p><button class="btn btn-black" if={resetFm} disabled="{!disableFindSmartCard}" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" onclick="{findCustomerBySmartCard}" id="ciamSearchCustBtn"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.ciamFindbuttonTxt}</span><i class="fa fa-angle-right loginIcon"></i></button></form> </div> <div id="ciam-confirmation-screen" class="confirmation-popup text-center p-5"> <h2>{langTranslateApp.ciamOtpHeader} </h2> <p if="{EmailAddress || MobileNumber}">{langTranslateApp.ciamOtpDesc}</p><p if="{!EmailAddress && !MobileNumber}">{langTranslateApp.ciamNoEmailAndMob}</p> <p if="{EmailAddress || MobileNumber}">{langTranslateApp.ciamOtpVerificationText}</p> <div class="form-group text-left" if="{MobileNumber}"> <input type="radio" value="mobile" id="confirmMobile" name="otpcheck"> <label for="confirmMobile">{MobileNumber}</label> </div> <div class="form-group text-left mb-1" if="{EmailAddress}"> <input type="radio" value="email" id="confirmEmail" name="otpcheck"> <label for="confirmEmail">{EmailAddress}</label> </div> <div><button class="btn btn-black" if="{EmailAddress || MobileNumber}" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" id="optGenerate" onclick="{()=>generateOrVerifyOTP(true)}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.paymentsContinue}</span><i class="fa fa-angle-right loginIcon"></i></button> </div><div><button class="btn btn-transparent mt-1" onclick="{findCustomerBack}">{langTranslateApp.dvsback}</button> </div> </div> <div id="ciam-otp-screen" class="otp-main-wrapper text-center"> <i class="fa fa-check" aria-hidden="true"></i> <h2>{langTranslateApp.ciamOTPText}</h2> <p>{langTranslateApp.ciamOTPsendText} <br/> {showMobOrEmail}</p><div class="otp-verify-box"><h4>{langTranslateApp.ciamOTPEnterText}</h4><form class="otp-form"><div class="mb-2 otp-group"><input id="otpBox1" maxlength="1" type="number" onkeydown="{IsValidOTP}"> <input id="otpBox2" maxlength="1" type="number" onkeydown="{IsValidOTP}"> <input id="otpBox3" maxlength="1" type="number" onkeydown="{IsValidOTP}"> <input id="otpBox4" maxlength="1" type="number" onkeydown="{IsValidOTP}"> </div><p id="otperror" class="mb-2 text-danger" style="font-weight:700;"></p><div class="mb-2 verify-otp-btn"><button class="btn btn-black" disabled="{!enableSend}" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" id="verifyOtp" onclick="{onVerifyOTP}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.otpverify}</span><i class="fa fa-angle-right loginIcon"></i></button></div><p id="otpnotReceived"><br><strong>{langTranslateApp.otpnotReceived}</strong></p><p><span>{langTranslateApp.otptimermsg} {resendTimer} {langTranslateApp.otpsec}</p><div><button class="btn btn-black" disabled="{!enableRetry}" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" id="resendOtp" onclick="{()=>generateOrVerifyOTP(true)}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.otpresend}</span><i class="fa fa-angle-right loginIcon"></i></button></div></form>  </div> <p class="noacess-livechat" style="display:none">No longer have access to<br/>texxxxxxxxxx@gmail.com? </br> <a href="#">Live Chat</a></p> </div>  <div class="" id="manageAcDiv" if="{showLoginMethod}"> <h1 class="sectionTitle">{ langTranslateApp.loginHeader1 }<span class="dstvTextSpan">{ " "+langTranslateApp.loginHeader2 } </span>{ langTranslateApp.loginHeader3 }</h1> <h3 id="fastH3">{ langTranslateApp.loginSubHeader }</h3> <div class="text-center padding20">{ langTranslateApp.loginWith }</div> <div id="homeLoginButtons" class="text-center"> <div class="col-sm-6"><button type="button" class="btn btn-white anim-btn" onClick="{ShowMobileLogin}"><span class="anim-span"></span><span class="spanMobile">{ langTranslateApp.loginMobile }</span> <img class="mobSurnArrow hidden" src="/media/3929/white-arrow.png" width="25"></button></div> <div class="col-sm-6"><button type="button" class="btn btn-white anim-btn" onClick="{ShowSurnameLogin}"><span class="anim-span"></span><span class="spanSurname">{langTranslateApp.loginSurname}</span> <img class="mobSurnArrow hidden" src="/media/3930/gray-arrow.png" width="25"></button></div> </div> </div> <div if="{showLogin}" id="loginDiv"> <h1 class="sectionTitle"> <img src=" /media/11405/icon-logo-mydstv.svg" width="300" height="57" alt="DStv Logo"> <!--{ langTranslateApp.loginLogIn1 }--> </h1> <h1 class="section-text"> <strong>{langTranslateApp.logginSignInSmall}</strong> {langTranslateApp.popUpToYourAccount} <!--{ langTranslateApp.loginEnterDetails }--> </h1> <div id="formLoginDiv"> <div class="form-group"> <fieldset class="Select-your-city-field"> <select id="ddlCountry" class="form-control" name="CountryDropdown" onchange="{onCountryDropdownChange}"> <option if="{allCountryCultureDetails}" each="{country, index in allCountryCultureDetails}" id="" value="{country.countryAbbreviation}-{country.countryLanguageAbbreviation}">{country.countryNameLanguage}</option> </select> </fieldset> </div> <div class="form-group"> <span class="login-info" id="snTooltip" ></span> <fieldset class="surnameMobile-field" if="{loginBySurname}"> <div id="smartTooltip1">{ langTranslateApp.loginEnterSurname }</div> <input type="text" autocomplete="off" class="form-control input-lg sign-mobile" id="signIn_surname" name="signIn_surnameOrMobile" onkeyup="{OnKeyUp}" placeholder="{langTranslateApp.popUpSurname}" /> </fieldset> <fieldset if="{loginByMobile}"> <div id="smartTooltip1">{ langTranslateApp.loginEnterMobile }</div> <span style="font-size: 18px;font-weight: 700;">+{dstvApp.countryCode}</span><input placeholder="Mobile" type="text" autocomplete="off" style="width:80%; display:inline-block; padding-left: 2px !important;" class="form-control input-lg sign-mobile" maxlength="14" id="signIn_mobile" name="signIn_surnameOrMobile" onkeyup="{OnKeyUp}" onkeypress="{ValidateNumeric}" /> </fieldset> </div> <div class="form-group"> <span class="login-info" id="smTooltip" onclick="{ShowSmartcardToolTip}"></span> <fieldset class="smartCard-field"> <div id="smartTooltip">{ langTranslateApp.loginNumValidation }</div> <input type="text" autocomplete="on" class="form-control input-lg sign-card" onkeyup="{OnKeyUp}" value="{smartcard}" id="signIn_smartCardNumber" name="signIn_smartCardNumber" maxlength="11" placeholder="{langTranslateApp.popUpSmartcard}" /> </fieldset> </div> <div id="signIn_error" class="sign-in-error hidden"> <i class="glyphicon glyphicon-flag"></i> <span></span> </div> <div class="form-group" style=""> <div class="" style="text-align: left;margin-left: 10px;"> <input type="checkbox" value="lsRememberMe" id="rememberMe"> <label for="rememberMe" style="font: normal normal normal 14px/19px Roboto; letter-spacing: 0px;">{ langTranslateApp.rememberMe }</label> </div> </div> <div class="resetLoginLinks" if="{false}"> <small> <a href="javascript:void(0);" onclick="{ShowForgotPassword}" class="linkBlue"> { langTranslateApp.loginForgotSmartCard }? </a></small> </div> <div class="btnDiv"> <button class="btn btn-white sign-in-varify anim-btn" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" id="btnSignInWithEazy" onclick="{OnLogin}" disabled="{!enableSignIn}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.logginSignIn}</span><i class="fa fa-angle-right loginIcon"></i> </button> <div class="circle ciam" if="{!isCiamApplicable}">OR</div> <div class="text-center mt-box" if="{!isCiamApplicable}"> <div class="mb-2 footer-text" if="{!isCiamApplicable}">{langTranslateApp.ciamUseText} <span class="multi-choice-id">{langTranslateApp.ciamMultichoiceText}</span> <span class="login-info" id="mcTooltip" ></span> <fieldset class="multichoicetooltip-field">  </fieldset>    </div> <button class="btn-white dvs-button dvs-button-white" id="sign-dvs" onclick={OnloginRedirection}><span class="">{langTranslateApp.ciamLoginLogout}</span> </button> </div> <div style="display:none;"> <div> <p>OR</p> </div> <div class="connectLoginLink"><a href="https://connect.dstv.com/registration/signin?response_type=id_token%20token&amp;redirect_uri=https://n" target="_blank" rel="noreferrer" class="connect-logo"><span>Login with your connect ID</span></a></div> <fieldset class="devider hidden"> <legend class="newToDStv">{ langTranslateApp.loginNewDStv }?</legend> <a class="btn btn-blue" target="_blank" rel="noreferrer" href="https://connect.dstv.com/4.1/en-ZA/Register?returnUrl=@domain"><span class="spanRegText">{ langTranslateApp.loginRegisterNow }</span><i class="fa fa-angle-right regIcon hidden"></i></a> </fieldset> </div> </div><div class="form-group" style=""><div class="siam-forget-password">Not a DStv customer yet? <b><a onclick={OnSignUpCustomer}>Sign up</a></b></div> </div> <div class="form-group tc" style=""> <div class="" style="text-align: left;margin-left: 10px;"> <span class="title-head">{ langTranslateApp.termsconditionname }</span> <span class="title-links"><a href="{dstvApp.termsandcondition.tcLink}" style="font-weight: 500;" target="_blank" rel="noreferrer">{langTranslateApp.tclinkHandle}</a></span></div> </div> </div> </div> <div id="maintenanceDiv" if="{!showLogin && showMaintenance}" class="services-offline text-center"> <div class="maintenance-mode-top-section"> <div class="text-center"><img src="/media/12031/mm-icon.svg" class="mb-2" alt="Maintenance Mode Icon"></div> <h3 class="my-0"><b><tag-raw class="tag-row" content="{maintenanceMsg1}"></tag-raw></b></h3> <div class="text-center my-2"><img src="/media/12030/maintenance-mode.svg" alt="Maintenance Mode Image" /></div> <p> <tag-raw class="tag-row" content="{maintenanceMsg3}"></tag-raw> </p> </div> <div class="maintenance-mode-bottom-section"> <p> <strong> <tag-raw class="tag-row" content="{maintenanceMsg5}"></tag-raw> </strong> </p> <div class="mm-btn-wrapper text-center"> <button type="button" class="mm-btn" data-dismiss="modal" aria-label="Close Modal">Close</button> </div> </div> </div> <!--Forgot Smartcard section--> <div id="smFound" if="{showSmartcardFound}"> <div class="popup success"> <div class="row"> <h2>{langTranslateApp.popUpSmartcardFound}!!</h2> <h4>{langTranslateApp.popUpYourSmartcardNumbIs} </h4> <kbd>{smCardFound}</kbd><br> <div class="sm-found-copy-text">{langTranslateApp.popUpCopyPaste}</div> <div class="btnDiv"><button class="btn btn-white sign-in-varify anim-btn" id="btnSMFoundLogin" onclick="{ShowSurnameLogin}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.popUpTryNow}</span><i class="fa fa-play-circle loginIcon"></i> </button></div> </div> </div> </div> <div id="loginRetry" if="{showRetry}"> <h1 class="sectionTitle">Oops!</h1> <br> <h3 id="loginRetryPrompt">{langTranslateApp.loginErrorHeader}</h3> <div id="formLoginDiv"> <div class="btnDiv"><button class="btn btn-white sign-in-varify anim-btn" id="btnSignInRetry" onclick="{ShowSurnameLogin}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.dashboardRetry}</span><i class="fa fa-angle-right loginIcon"></i> </button></div> </div> </div> <div id="findSMRetry" if="{showFindSmartcardRetry}"> <div if="{!showAttemptedMSG}"> <h1 class="sectionTitle">{ langTranslateApp.loginSmartCardNotFound }</h1> <br><!-- <h3>{ langTranslateApp.loginSmarCardNotFoundError }</h3> --> <h4>{ langTranslateApp.loginEnterCorrectNumber }</h4> <h4> <b>You have {remainingAttempt} attempts remaining. </b></h4> <div id="formLoginDiv"> <div class="btnDiv"><button class="btn btn-white sign-in-varify anim-btn" id="btnfindSMRetry" onclick="{OnFindSMRetry}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.dashboardRetry}</span><i class="fa fa-angle-right loginIcon"></i> </button></div> </div> </div> <div if="{showAttemptedMSG}"> <h1 class="sectionTitle" style="font-weight: 500;">TRY AGAIN LATER!</h1> <br> <h4>The Smartcard number could not be retrieved.</h4> <h4>You have exhausted your limit of attempts (3). Please try after 30 minutes or Contact our Call Center.</h4> <div id="formLoginDiv"> <div class="btnDiv"><a class="btn btn-white sign-in-varify anim-btn" id="btnfindSMRetry" href="{window.culture}/{langTranslateApp.subMenuContactUsLink}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.subMenuContactUs}</span><i class="fa fa-angle-right loginIcon"></i> </a></div> </div> </div> </div> <div if="{showForgotPassword}" id="formForgotDiv"> <div class="" if="{!showAttemptedMSG}"> <h1 class="sectionTitle">{ langTranslateApp.loginRetrieveDetails }</h1> <h3 class="forgotSmartTitle">{ langTranslateApp.loginEnterYourMobile }</h3> <div class="form-group forgotInput"> <fieldset> <div id="smartTooltipF">{ langTranslateApp.loginNumValidation }!!</div> <span style="font-size: 18px;font-weight: 700;">+{dstvApp.countryCode}</span><input type="text" style="width:80%; display:inline-block;padding-left: 2px !important;" class="form-control input-lg" required maxlength="14" onkeypress="{ValidateNumeric}" id="MobileNum" placeholder="{langTranslateApp.popUpMobileNumber}" /> </fieldset> </div> <div class="btnDiv"><button class="btn btn-white anim-btn" id="btnFindSmartcard" data-loading-text="<i class=\'fa fa-spinner fa-spin pull-right \'></i> {langTranslateApp.loginPleaseWait}" onclick="{SearchForSmartcard}"><span class="anim-span"></span><span class="spanLoginText">{ langTranslateApp.loginFind } </span><i class="fa fa-angle-right loginIcon"></i></button></div> <fieldset class="devider forgot-devider"> <legend class="newToDStv">{ langTranslateApp.loginBackToLogin }</legend> <a class="btn btn-white anim-btn" onclick="{ShowSurnameLogin}" href="javascript:void(0);"><span class="anim-span"></span><span class="spanRegText">{ langTranslateApp.loginLogIn2 }</span></a> </fieldset> </div> <div if="{showAttemptedMSG}"> <h1 class="sectionTitle" style="font-weight: 500;">TRY AGAIN LATER!</h1> <br> <h3 style="font-size: 16px;margin-bottom: 10px;line-height: 30px;">You have exhausted your limit of attempts (3). Please try after 30 minutes or Contact our Call Center.</h3> <div id="formLoginDiv"> <div class="btnDiv"><a class="btn btn-white sign-in-varify anim-btn" id="btnfindSMRetry" href="{window.culture}/{langTranslateApp.subMenuContactUsLink}"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.subMenuContactUs}</span><i class="fa fa-angle-right loginIcon"></i> </a></div> </div> </div> </div> <div id="gotvcustomer" if="{showGOtvMessage}"> <div class="popup success"> <div class="row p-4"> <h1><img style="max-height: 50px;" src=" /media/11405/icon-logo-mydstv.svg" width="300" height="57" alt="DStv Logo"></h1> <!--<h1 class="gotvLogo"></h1>--> <h2>{langTranslateApp.goTVHi} {GOtvCustomer}</h2> <h4>{langTranslateApp.gotvUserText} </h4> <p style="white-space: pre-line;">{langTranslateApp.gotvRedirectText} {GOtvURL}</p> <div class="btnDiv"><button class="btn btn-white sign-in-varify anim-btn" onclick="{RedirectToGOtv}" id="btnGOtv"><span class="anim-span"></span><span class="spanLoginText">{langTranslateApp.gotvButtonText}</span><i class="fa fa-play-circle loginIcon"></i> </button></div> </div> </div> </div> </div> </section> </div> </div> </div>    </div></div>','tag-sign-in,[riot-tag="tag-sign-in"],[data-is="tag-sign-in"]{ visibility: visible; } ','',function(opts){var self=this;self.resetFm=true
self.isMounted=true;self.showLoginMethod=true;self.showLogin=false;self.loginBySurname=false;self.loginByMobile=false;let smartTooltip='#smartTooltip';let mobileToolTip='#smartTooltip1';let findMobileToolTip='#smartTooltipF';let signIn_mobile='#signIn_mobile';let signIn_surname='#signIn_surname';let smartcardObj='#signIn_smartCardNumber'
let btnSignInWithEazy='#btnSignInWithEazy'
let rememberMe='#rememberMe'
let mobileNum='#MobileNum';let ddlCountry='#ddlCountry';let emptystring='';self.retryButtonShown=false;app.isConnectLogin=false;self.smartcard=null;self.isCiamApplicable=dstvApp.nociamCountries.includes(dstvApp.countryabbreviation)
self.removeTags=function(str){if((str===null)||(str===''))
return false;else
str=str.toString();return str.replace(/(<([^>]+)>)/ig,'');}
if(window.enableOfflineMode=='True'&&window.enterCustomMessage=='True'){if(dstvApp.languageAbbreviation=='en'){self.maintenanceMsg1=window.offlineMessage.message1;self.maintenanceMsg3=window.offlineMessage.message2;self.maintenanceMsg5=window.offlineMessage.message3;self.maintenanceMsg7=window.offlineMessage.message7;}
else{self.maintenanceMsg1=window.offlineMessage.message4;self.maintenanceMsg3=window.offlineMessage.message5;self.maintenanceMsg5=window.offlineMessage.message6;self.maintenanceMsg7=window.offlineMessage.message8;}}
else if(window.enableOfflineMode=='True'&&window.enterCustomMessage!='True'){self.maintenanceMsg1=langTranslateApp.maintenanceMsg1;self.maintenanceMsg3=langTranslateApp.maintenanceMsg3;self.maintenanceMsg5=langTranslateApp.maintenanceMsg5;}
self.on('before-mount',function(){$('#loader').show()
if(!(dstvApp.liveTargetCountries.includes(dstvApp.countryabbreviation)||dstvApp.SelfServiceEnabledCountries.includes(dstvApp.countryabbreviation))){window.location=`https://eazy.dstv.com/en/${dstvApp.countryabbreviation}/account`
return;}
if(app.loggedin){window.location=dstvApp.DashboardURL;return;}
self.journey=new URLSearchParams(window.location.search).get('journey');app.selectedProductCode=new URLSearchParams(window.location.search).get('product');app.applySignIn=JSON.parse(new URLSearchParams(window.location.search).get('dvslogout'));self.isDvSJourney=self.journey&&dstvApp.DvsCountries.includes(dstvApp.countryabbreviation);self.isVIVR=window.location.href.includes('journey=changepackage')
app.screen=new URLSearchParams(window.location.search).get('screen');if(self.isDvSJourney){if(self.journey.toLowerCase()=='dvs'){app.isDVSJourney=true;app.isProMigration=new URLSearchParams(window.location.search).get('tid')&&atob(new URLSearchParams(window.location.search).get('tid')).toLowerCase()=='promigration'&&!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation)
window.SessionSave("app",app);window.location.href=dstvApp.decommissionedCountries.includes(dstvApp.countryabbreviation)?window.location.href:dstvApp.MyAccountURL;}
else if(self.journey.toLowerCase()=='resumedvs'){app.isDVSJourney=true;app.isResumeDVSJourney=true;window.SessionSave("app",app);window.location.href=dstvApp.MyAccountURL;}
else{window.location.href=dstvApp.MyAccountURL;}}
else if(self.access_token){let uri=window.location.href.toString();if(uri.indexOf("#")>0){let clean_uri=uri.substring(0,uri.indexOf("#"));window.history.replaceState({},document.title,clean_uri);}}
else{app.isDVSJourney=false;app.loggedin=false;window.SessionSave("app",app);app.ciamAuthCode=new URLSearchParams(window.location.search).get('code');if(app.ciamAuthCode){app.ciamLogin=app.ciamAuthCode?true:false;window.SessionSave("app",app);window.history.pushState({},document.title,window.culture+"/mydstv-sign-in");}}});self.on('mount',function(){$('#ciam-sm-login-screen').hide()
$('#ciam-confirmation-screen').hide()
$('#ciam-otp-screen').hide()
if(self.isVIVR){app.isVIVR=true;app.vivrQueryStr=window.location.search;self.OnLogin();}
if(self.isDvSJourney){$("#cpoverlay").fadeIn(300);$("#cpoverlay").parents("#signInModalPopup").addClass('lgnscreendisabled');$('#signInModalPopup .btnClose').hide();}
if(!self.opts.loginfromchat){$('#signInModalPopup').modal('show');}
else{$('#chatLogin  #signInModalPopup').modal('show');$('body').removeClass('modal-open')
if(dstvApp.countryabbreviation=='ng')
setTimeout(function(){$('.Select-your-city-field').hide();},500)}
$(document).ready(function(){$('.sign-card').on("input",function(){$(this).val($(this).val().replace(/ /g,""));});});self.InitialSetUp();self.ShowSurnameLogin();self.GenerateJWT();self.loadCountryConfigData();self.GetCacheValuesForMe()
if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)&&dstvApp.countryabbreviation!=='mu'){self.fetchConversionFactor();}
self.update();jcf.replaceAll();if(app.ciamLogin&&!app.ciamTokens){site.factory.generateCiamTokens().then((data)=>{console.log('generateTokens Sucess: ',data)
app.ciamTokens=data
self.checkCIAMJourney(app.ciamTokens.id_token)
window.SessionSave("app",app);});}
if(app.ciamLogin&&app.ciamTokens){self.checkCIAMJourney(app.ciamTokens.id_token)}});self.OnSignUpCustomer=function(){window.location.href="https://qa.dstvafrica.com"+'/en-'+dstvApp.countryabbreviation+"/browse-compare-packages";}
self.ExternalLogin=function(){console.log('Linked Customer Data : Fetching linked customer data...')
let url=`https://qa-api.dstvafrica.com/apilogin/api/v1/Login/ExternalLogin?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}&AccessToken=${self.access_token}`;site.factory.GetJWT().then(function(token){self.token=token;site.factory.Get(url,self.token,self.onExternalLoginSuccess,self.onExternalLoginError,true)})}
self.onExternalLoginSuccess=function(data){console.log('Customer Dtails : fetched Customer details completed')
app.isConnectLogin=true;app.customernumber=data.CustomerNumber||parseInt(app.customernumber||0);data.ConnectCustomerDetails.CustomerNumber=app.customernumber;window.SessionSave("app",app);if(!data.CustomerNumber||true){if(localStorage['selectedPackage']||true){app.isDVSJourney=true;app.connectCustomerDetails=data.ConnectCustomerDetails;app.connectCustomerDetails.AccessToken=self.access_token;app.connectCustomerDetails.PersonalDetail=data.PersonalDetail||(app.customerDetails?app.customerDetails.PersonalDetail:null);if(!app.connectCustomerDetails.PersonalDetail){let countryCode=data.ConnectCustomerDetails.MobileNumber.replace('+','').slice(0,3)
let mobileNumber=data.ConnectCustomerDetails.MobileNumber.replace('+','').slice(3)
if(countryCode.trim().substring(0,2)==27){countryCode=data.ConnectCustomerDetails.MobileNumber.replace('+','').slice(0,2)
mobileNumber=data.ConnectCustomerDetails.MobileNumber.replace('+','').slice(2)}
app.connectCustomerDetails.PersonalDetail={}
app.connectCustomerDetails.PersonalDetail.Email=data.ConnectCustomerDetails.Email
app.connectCustomerDetails.PersonalDetail.Mobile={CountryCode:countryCode,Number:mobileNumber};}
else{app.connectCustomerDetails.PersonalDetail.Email=data.ListOfEmail[0].Email
app.connectCustomerDetails.PersonalDetail.Mobile={CountryCode:data.ListOfPhoneNumber[0].CountryCode,Number:data.ListOfPhoneNumber[0].Number};}
window.SessionSave("app",app);$("#cpoverlay").fadeOut(300);window.location=dstvApp.MyAccountURL;}
else{$("#cpoverlay").fadeOut(300);self.ShowRetry();$("#loginRetryPrompt").html(`<span class="error-note">${langTranslateApp.customerNotFoundMsg} </span>`);self.retryButtonShown=true;}
return;}
self.data=data;self.ViewSubscription();}
self.onExternalLoginError=function(data){console.log('Customer Details : fetched Customer details Failed')
if(data.responseJSON&&data.responseJSON.StatusCode==404&&data.responseJSON.Message.includes("Customer not found")){if(localStorage['selectedPackage']||true){app.isDVSJourney=true;window.SessionSave("app",app);$("#cpoverlay").fadeOut(300);window.location=dstvApp.DashboardURL;}
else{$("#cpoverlay").fadeOut(300);self.ShowRetry();$("#loginRetryPrompt").html(`<span class="error-note">${langTranslateApp.customerNotFoundMsg} </span>`);self.retryButtonShown=true;}
return;}}
self.ViewSubscription=function(){console.log('Login : ViewSubscription started...')
let url=dstvApp.DSOAPIUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)})}
else
site.factory.Get(url,self.token,self.ViewSubscriptionSuccess,self.ViewSubscriptionError);}
self.ViewSubscriptionSuccess=function(data){console.log('Login : ViewSubscription completed before login')
app.SmartCardNumber=data.filter(x=>x.isPrimarySc)[0].smartcardNumber;self.onLoginSuccess(self.data);}
self.ViewSubscriptionError=function(err){console.log('Login : ViewSubscription completed with error');console.log(err);}
self.OnLogin=function(e){console.log('Login : login...')
if(!app.isConnectLogin){if(self.IsValid()){let mobile="";let surname="";if(!app.isVIVR){$(btnSignInWithEazy).button('loading');mobile=self.loginByMobile?$(signIn_mobile).val().trim():emptystring;surname=self.loginBySurname?$(signIn_surname).val().trim():emptystring;if(/\s*$/.test(surname)){let tempSurnameMobile=surname.split(' ');if(self.IsNumeric(tempSurnameMobile[1])){surname=tempSurnameMobile.join("")}
else{surname=surname;}}
if(self.IsNumeric(surname)){mobile=surname.trim();surname='';}}
let smartcard="";if(app.isVIVR){let params=new URLSearchParams(window.location.search);self.surnameOrMobile=params.get('surname');smartcard=params.get('smartcard');self.smartcardNumber=smartcard.trim();surname=self.surnameOrMobile;}else{smartcard=$(smartcardObj).val().toUpperCase().substr(0,10);self.surnameOrMobile=$(signIn_surname).val().trim();self.smartcardNumber=$(smartcardObj).val().toUpperCase().trim();}
let data={country:dstvApp.country,surname:surname,mobileNumber:mobile,smartCardNumber:smartcard}
if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}apilogin/api/v1/Login?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Post(url,data,null,self.onLoginSuccess,self.onLoginError,false,false,false,true);}else{let url=`${dstvApp.DSOAPIUrl}apilogin/api/v1/Login?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&verbocity=true`;if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)})}
else
site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)}
app.sessionID=site.factory.uuidv4();site.factory.trackData('LOGIN-REQ',data,null)}
else{e.preventDefault();e.stopImmediatePropagation()}
self.showLoader=false;}
else{self.surnameOrMobile=app.surName;self.smartcardNumber=app.smartcardNumber.toUpperCase();let data={country:dstvApp.country,surname:app.surName,mobileNumber:"",smartCardNumber:app.smartcardNumber,verbocity:true}
app.sessionID=site.factory.uuidv4();if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}apilogin/api/v1/Login?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Post(url,data,null,self.onLoginSuccess,self.onLoginError,false,false,false,true);}else{let url=`${dstvApp.DSOAPIUrl}apilogin/api/v1/Login?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)})}
else
site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)}
site.factory.trackData('LOGIN-REQ',data,null)}}
self.setDualCurrencyFlag=function(){console.log('On setDualCurrencyFlag : Post login');let arrayDualCurrencyContries=[];let arrayDualCurrencies=[];for(var i=0;i<dstvApp.DualCurrenciesList.length;i++){var split=dstvApp.DualCurrenciesList[i].split("-");arrayDualCurrencyContries.push(split[0]);arrayDualCurrencies.push(split[1]);}
if(arrayDualCurrencies.includes(dstvApp.countrycurrency.toLowerCase())){app.dualCurrencyApplicable=true;window.SessionSave("app",app);}
else{app.dualCurrencyApplicable=false;window.SessionSave("app",app);}}
self.onLoginSuccess=function(data){app.ciamAuthCode=undefined
app.access_token=undefined
console.log('Login : success')
app.loginUrlHasQueryString=false;app.isShowmaxCardLoaded=false;app.countryabr=dstvApp.countryabbreviation
if(window.location.href.split('?').length>1){app.loginUrlHasQueryString=true;app.loginUrlQueryString=window.location.href.split('?')[1]}
self.firstName=data.PersonalDetail.FirstName;self.surname=data.PersonalDetail.Surname;app.customername=data.PersonalDetail.Title?data.PersonalDetail.Title+' '+data.PersonalDetail.FirstName+' '+data.PersonalDetail.Surname:data.PersonalDetail.FirstName+' '+data.PersonalDetail.Surname;app.customername=app.customername.toUpperCase();if(data.BusinessUnit!=null){if(data.BusinessUnit.toLowerCase().includes('gotv')){console.log('Login : GOtv customer')
self.GOtvCustomer=app.customername;self.GOtvURL=dstvApp.GOURL
self.HideAll();self.showGOtvMessage=true;self.update();return;}}
if(app.ciamLogin){app.smartcard=self.smartCard
app.loggedInBySmartcard=true}else{app.loggedInBySmartcard=self.IsLoggedInBySmartcard();app.loggedInBySmartcard=app.isConnectLogin?true:self.IsLoggedInBySmartcard();app.smartcard=app.isConnectLogin?app.SmartCardNumber:self.smartcardNumber.substr(0,10);}
app.loggedin=true;app.customernumber=data.CustomerNumber;app.showmaxUpgradeReq=false;let paymentduedetails={properties:{surname:{value:self.surname},firstName:{value:self.firstName},customerNumber:{value:data.CustomerNumber}},entities:[]};app.paymentduedetails=paymentduedetails;app.customerDetails={ListOfAddress:data.ListOfAddress,ListOfEmail:(data.ListOfEmail||[]),ListOfPhoneNumber:(data.ListOfPhoneNumber||[]),PersonalDetail:data.PersonalDetail,IsSpecialistCustomer:data.IsSpecialistCustomer,Status:data.Status};let emailID=app.customerDetails.ListOfEmail?app.customerDetails.ListOfEmail[0]:undefined;emailID=emailID?emailID.Email:'';let mobileNum=app.customerDetails.ListOfPhoneNumber[0];mobileNum=mobileNum?mobileNum.Number:'';let homeTel=app.customerDetails.ListOfPhoneNumber.filter(x=>x.Type=="Home")[0];homeTel=homeTel?homeTel.Number:'';let workTel=app.customerDetails.ListOfPhoneNumber.filter(x=>x.Type=="Work")[0];workTel=workTel>0?workTel.Number:'';let faxTel=app.customerDetails.ListOfPhoneNumber.filter(x=>x.Type=="Fax")[0];faxTel=faxTel>0?faxTel.Number:'';var customercontactdetails={"Title":app.customerDetails.PersonalDetail.Title,"FirstName":app.customerDetails.PersonalDetail.FirstName,"Surname":app.customerDetails.PersonalDetail.Surname,"EmailAddress":emailID,"MobileTel":mobileNum,"HomeTel":homeTel,"WorkTel":workTel,"FaxTel":faxTel};app.customercontactdetails=customercontactdetails;app.loadedcontactdetails=true;self.GetAmountToPay();self.setDualCurrencyFlag();site.factory.addCustomerToDMP();if(self.IsRemember())
site.factory.RememberMe();else
site.factory.ClearCacheValuesForMe();if(app.isVIVR){window.getErrorCodes();console.log('Change Package VIVR login Success')}
site.factory.trackData('LOGIN-RES',null,data)}
self.onLoginError=function(err){$('#loader').hide()
console.log('Login : error')
$(btnSignInWithEazy).button('reset');self.ShowRetry(err);if(err&&err.responseJSON&&err.responseJSON.StatusCode==500)
$("#loginRetryPrompt").html(`<span class="error-note">${langTranslateApp.genericTechnicalIssueMsg1} <u><a class="payments_errContactUs" href="${window.culture}/${langTranslateApp.subMenuContactUsLink}">${langTranslateApp.subMenuContactUs}</a></u> ${langTranslateApp.genericTechnicalIssueMsg2}</span>`);if(navigator.onLine){console.log('online');}else{document.getElementById("loginRetryPrompt").innerHTML="You appear to be offline";console.log('offline');}
self.retryButtonShown=true;if(err.responseJSON.StatusCode==403&&err.responseJSON.Message.includes('Invalid User for the dstv')){console.log('Login : GOtv customer')
self.GOtvCustomer=self.surnameOrMobile;self.GOtvURL=`${dstvApp.GOURL}${dstvApp.languageAbbreviation}-${dstvApp.countryabbreviation}/`;self.HideAll();self.showGOtvMessage=true;self.update();return;}
site.factory.trackData('LOGIN-RES',null,err)}
self.GetAmountToPay=function(){console.log('Login : fetch amount to pay...')
if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,null,self.onGetAmountToPaySuccess,self.onGetAmountToPayError,false,true,true);}else{let url=`${dstvApp.DSOAPIUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,self.token,self.onGetAmountToPaySuccess,self.onGetAmountToPayError);}}
self.onGetAmountToPaySuccess=function(data){console.log('Login : fetch amount to pay completed')
app.paymentduedetails.properties.dueDate={value:data.DueDate.split('T')[0]};app.isMauritius=dstvApp.countryabbreviation=='mu'?true:false;if(app.isMauritius){app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.LocalPrice.Currency}}
else{app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.Value*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.CurrencyCode}}
if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))
app.paymentduedetails.properties.amountToPayEtb=data.TotalAmountToPay.LocalPrice?{value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}:null
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.CurrencyCode}
if(data.Accounts){app.BOAccount=data.Accounts.filter(x=>x.AccountType=="Box Office")[0];app.IsBOCustomer=app.BOAccount&&Object.keys(app.BOAccount).length>0
app.accounts=data.Accounts.map(x=>({AccountNumber:x.AccountNumber,AccountType:x.AccountType}))
app.accountsInfo=data.Accounts;app.primaryaccountnumber=data.Accounts.filter(x=>x.IsDefault)[0].AccountNumber;}
else{app.accounts=[];app.BOAccount=[];app.IsBOCustomer=false;app.accountsInfo=[];app.primaryaccountnumber=0;}
window.SessionSave("app",app);if(!self.opts.loginfromchat){let dashboardURL=window.culture?dstvApp.DashboardURL:"\en-zm"+dstvApp.DashboardURL;dashboardURL=opts.returnURL||dashboardURL;if(location.search){dashboardURL=dashboardURL+location.search;}
window.location=dashboardURL}
else
self.liveChatLoginConfiguration();}
self.onGetAmountToPayError=function(err){console.log('Login : error while fetching amount to pay')
app.paymentduedetails.properties.dueDate={value:null};app.paymentduedetails.properties.amountToPay={value:null}
app.paymentduedetails.properties.currencyCode={value:null}
app.accounts=[];app.BOAccount=[];app.IsBOCustomer=false;app.primaryaccountnumber=0;window.SessionSave("app",app);if(!self.opts.loginfromchat){let dashboardURL=window.culture?dstvApp.DashboardURL:"\en-zm"+dstvApp.DashboardURL;window.location=opts.returnURL||dashboardURL}
else
self.liveChatLoginConfiguration();}
self.IsRemember=function(){return $(rememberMe).is(':checked')}
self.GetCacheValuesForMe=function(){var cachedData=site.factory.GetCacheValuesForMe();if(cachedData){$(signIn_surname).val(cachedData.sn);$(smartcardObj).val(cachedData.sm);$(rememberMe).prop('checked',true);if(dstvApp.countryabbreviation!='ng')
$(ddlCountry).val(cachedData.cn).change()
self.onCountryDropdownChange();self.enableSignIn=true;self.EnableSignIn();jcf.refreshAll()}}
self.liveChatLoginConfiguration=function(){$('#loginLinkLabel').hide();$('#loginPopup').show();$('#loginPopupText').html(app.customername);if(window.location.pathname==window.culture||window.location.pathname==window.culture+"/")
$('#dashBoardHomeNav').css('display','none')
self.parent.configureChat();self.update();riot.update()
if(app.loggedin){$('#loginLinkLabel-NewHome span.login-icon').hide();}
else{$('#loginLinkLabel-NewHome span.login-icon').show();}}
self.RedirectToGOtv=function(){window.location=self.GOtvURL;}
self.SearchForSmartcard=function(e){console.log('Find Smartcard : Search by cell number...')
let mobile=($(mobileNum).val().trim());if(!mobile){$(findMobileToolTip).show();$(findMobileToolTip).html(langTranslateApp.loginEnterMobile)
e.stopImmediatePropagation()
return false;}
console.log('Find Smartcard : Checking number of attempts')
self.attempt=parseInt(site.factory.GetFindSmartcardAttempt());self.remainingAttempt=3-self.attempt;if(self.attempt>3){console.log('Find Smartcard : Max attempted')
self.onSearchForSmartcardError();return;}
mobile=dstvApp.countryCode+mobile;$('#btnFindSmartcard').button('loading');let url=dstvApp.APIUrl+`Customer/SearchByCellPhoneNumber?dataSource=${dstvApp.country}&cellPhoneNumber=${mobile}&vendorCode=${dstvApp.vendorcode}&language=&ipAddress=&businessUnit=${dstvApp.businessunit}`
site.factory.Post(url,null,null,self.onSearchForSmartcardSuccess,self.onSearchForSmartcardError)}
self.onSearchForSmartcardSuccess=function(data){console.log('Find Smartcard : Search by cell number completed')
console.log('Find Smartcard : Get products...')
if(data.length){let customer=data[data.length-1].CustomerNumber;var apiUrl='';apiUrl=dstvApp.APIUrl;let url=apiUrl+`Product/GetProducts?dataSource=${dstvApp.country}&customerNumber=${customer}&vendorCode=${dstvApp.vendorcode}&language=&ipAddress=&businessUnit=${dstvApp.businessunit}`
site.factory.Get(url,null,self.onGetProductsSuccess,self.onGetProductsError)}
else{self.onSearchForSmartcardError()}}
self.onSearchForSmartcardError=function(data){console.log('Find Smartcard : Not found smartcard')
site.factory.CaptureFindSmartcardAttempt(self.attempt);self.HideAll();self.showFindSmartcardRetry=true;if(self.attempt>=3)
self.showAttemptedMSG=true;self.update();}
self.onGetProductsSuccess=function(data){console.log('Find Smartcard : Get products success')
self.smCardFound=data.filter(x=>x.IsSmartCard)[0].SerialNumber;self.HideAll();self.showSmartcardFound=true;self.update();}
self.onGetProductsError=function(data){console.log('Find Smartcard : Get products error')
self.HideAll();self.showFindSmartcardRetry=true;self.update();}
self.GenerateJWT=function(){site.factory.GetJWT().then(function(token){self.token=token;})}
self.OnKeyUp=function(e){e.which==13&&self.enableSignIn?self.OnLogin():self.EnableSignIn();}
self.IsValid=function(){if(app.isVIVR){return true;}
if(self.loginBySurname&&$(signIn_surname).val().trim()==emptystring){$(mobileToolTip).show();$(mobileToolTip).html(langTranslateApp.loginEnterSurname)
return false;}
else if(self.loginByMobile&&$(signIn_mobile).val().trim()==emptystring){$(mobileToolTip).show();$(mobileToolTip).html(langTranslateApp.loginEnterMobile)
return false;}
else if($(smartcardObj).val().trim()==emptystring){$(smartTooltip).show();$(smartTooltip).html(langTranslateApp.loginEnterSmartcardNumber);return false;}
else if(!self.IsNumeric($(smartcardObj).val())){return true;}
else if($(signIn_surname).val().trim()=="0"){$(mobileToolTip).show();$(mobileToolTip).html(langTranslateApp.updateInvalidMobile)
return false;}
return true;}
self.onInputMobileEvent=function(e){console.log(e)
var isMobile=window.matchMedia("only screen and (max-width: 760px)");if(isMobile.matches){let event={key:e.key,currentTarget:e.target}
let isNumeric=self.IsNumeric(e.key);let isEnterPress=e.which==13;if(!isNumeric&&!isEnterPress){$(e.currentTarget).focus()
if(e.currentTarget.id=='signIn_mobile'){$(mobileToolTip).show();$(mobileToolTip).html(langTranslateApp.loginNumValidation);}
else if(e.currentTarget.id=='MobileNum'){$(findMobileToolTip).show();$(findMobileToolTip).html(langTranslateApp.loginNumValidation);}
else{$(smartTooltip).show();$(smartTooltip).html(langTranslateApp.loginNumValidation);}}
else if(e.currentTarget.id!='MobileNum')
self.EnableSignIn();}}
self.ValidateNumeric=function(e){let isNumeric=self.IsNumeric(e.key);let isEnterPress=e.which==13;if(!isNumeric&&!isEnterPress){e.preventDefault();$(e.currentTarget).focus()
if(e.currentTarget.id=='signIn_mobile'){$(mobileToolTip).show();$(mobileToolTip).html(langTranslateApp.loginNumValidation);}
else if(e.currentTarget.id=='MobileNum'){$(findMobileToolTip).show();$(findMobileToolTip).html(langTranslateApp.loginNumValidation);}
else{$(smartTooltip).show();$(smartTooltip).html(langTranslateApp.loginNumValidation);}}
else if(e.currentTarget.id!='MobileNum')
$(smartTooltip).hide();self.EnableSignIn();}
self.IsLoggedInBySmartcard=function(){let issmartcard=false;let sm=$(smartcardObj).val();if(sm.trim().length>3&&sm.trim().length<=9){issmartcard=false;}
if(sm.trim().length>9&&sm.trim().length<12){issmartcard=true;}
return issmartcard;}
self.ShowMobileLogin=function(){self.HideAll();self.showLogin=true;self.loginByMobile=true;self.SetTextFocus(signIn_mobile);if(dstvApp.showOfflineMsg){self.showLogin=false;self.showMaintenance=true;}
self.update();}
self.ShowSurnameLogin=function(){self.HideAll();self.showLogin=true;self.loginBySurname=true;self.SetTextFocus(signIn_surname);self.update();$(signIn_surname).val(self.surnameOrMobile);$(smartcardObj).val(self.smartcardNumber);self.InitializeTooltip();if(self.retryButtonShown){console.log('Retry clicked');self.initialLoadDropdown();jcf.replaceAll();}
if(dstvApp.showOfflineMsg){self.showLogin=false;self.showMaintenance=true;}
self.update();}
self.InitializeTooltip=function(){$('#snTooltip').tooltip({html:true,title:`<div style="font-size: 14px;font-weight: 400;text-align: justify;">${langTranslateApp.loginSurnameTooltip}</div>`,trigger:"hover",container:".surnameMobile-field",animation:true,delay:{show:0,hide:100}});$('#smTooltip').tooltip({html:true,title:`${langTranslateApp.loginSmartcardTooltip} <hr><ol class="text-title"><li>${langTranslateApp.loginSmartcardTooltipInstruction1} </li><li>${langTranslateApp.loginSmartcardTooltipInstruction2} </li><li> ${langTranslateApp.loginSmartcardTooltipInstruction3} </li></ol>`,trigger:"hover",container:".smartCard-field",animation:true,delay:{show:0,hide:100}});$('#mcTooltip').tooltip({html:true,title:`<div style="font-size: 14px;font-weight: 500;text-align: justify;">${langTranslateApp.loginciamTooltip}</div>`,trigger:"hover",container:".multichoicetooltip-field",animation:true,delay:{show:0,hide:100}});$('#mcTooltip').attr('data-original-title',langTranslateApp.loginciamTooltip);$('#snTooltip').attr('data-original-title',langTranslateApp.loginSurnameTooltip);$('#smTooltip').attr('data-original-title',`${langTranslateApp.loginSmartcardTooltip} <hr><ol class="text-title"><li>${langTranslateApp.loginSmartcardTooltipInstruction1} </li><li>${langTranslateApp.loginSmartcardTooltipInstruction2} </li><li> ${langTranslateApp.loginSmartcardTooltipInstruction3} </li></ol>`);}
self.ShowLoginMethod=function(){self.HideAll();self.showLoginMethod=true;self.showLogin=false;self.loginByMobile=false;self.loginBySurname=false;self.showForgotPassword=false;self.showRetry=false;self.update();}
self.HideAll=function(){self.showLoginMethod=false;self.showLogin=false;self.loginByMobile=false;self.loginBySurname=false;self.showForgotPassword=false;self.showRetry=false;self.showGOtvMessage=false;self.showSmartcardFound=false;self.showFindSmartcardRetry=false
self.update();}
self.ShowRetry=function(err){if(err&&err.status==403){langTranslateApp.loginErrorHeader=langTranslateApp.MtcCustText}
self.showLoginMethod=false;self.showLogin=false;self.loginByMobile=false;self.loginBySurname=false;self.showForgotPassword=false;self.showRetry=true;self.update();}
self.OnFindSMRetry=function(){self.HideAll();self.showForgotPassword=true;self.update();}
self.OnRetry=function(){self.ShowLoginMethod();}
self.ShowForgotPassword=function(){self.HideAll();self.showForgotPassword=true;self.SetTextFocus(mobileNum);console.log('Find Smartcard : Checking number of attempts')
self.attempt=parseInt(site.factory.GetFindSmartcardAttempt());if(self.attempt>=3)
self.showAttemptedMSG=true;self.update();}
self.InitialSetUp=function(){$('#formLoginDiv, #loginDiv, #smartTooltip, #smartTooltip1, #section1, #formForgotDiv, #smartTooltipF').click(function(){$(smartTooltip).hide();$(mobileToolTip).hide();$(findMobileToolTip).hide();})
$('#signInModalPopup').on('hidden.bs.modal',function(){self.OnClose();})
if(window.location.href.includes(dstvApp.DstvThanksURL)){self.ShowMobileLogin();}
self.update();}
self.IsNumeric=function(str){return $.isNumeric(str)};self.EnableSignIn=function(){self.enableSignIn=$(smartcardObj).val()&&$(smartcardObj).val().length>=10}
self.SetTextFocus=function(id){setTimeout(function(){$(id).focus()},500)}
self.OnClose=function(){console.log('closed log-in');window.location=dstvApp.targetDomain+window.culture;return;if(window.location.href.includes(dstvApp.DashboardURL))
window.location=window.location.origin+window.culture
else if(self.attempt>=3)
$('#signInModalPopup').modal('hide');if(dstvApp.initialCountryAbbreviation&&dstvApp.initialLanguageAbbreviation){self.selectedCountryAbbreviation=dstvApp.initialCountryAbbreviation;self.selectedLanguageAbbreviation=dstvApp.initialLanguageAbbreviation;self.updateCountryParams();}}
self.loadCountryConfigData=function(){if(!self.countryConfigData){self.countryConfigData=dstvApp.cConfig;self.countryConfigData=dstvApp.cConfig.filter(item=>!dstvApp.decommissionedCountries.includes(item.countryabbreviation));self.countriesList=dstvApp.liveTargetCountries.concat(dstvApp.SelfServiceEnabledCountries);self.dropdownCountryList=[];self.dropdownCountryList=removeusingSet(self.countriesList);self.countryConfigData=self.countryConfigData.filter(item=>self.dropdownCountryList.includes(item.countryabbreviation));self.allCountryCultureDetails=self.countryConfigData.map(function(item){if(!(item.languageAbbreviation=="en"&&(item.countryabbreviation=="ao"||item.countryabbreviation=="mz"))){return{countryName:item.country,countryAbbreviation:item.countryabbreviation,countryLanguageAbbreviation:item.languageAbbreviation,countryNameLanguage:item.country.toUpperCase()};}}).sort(function(a,b){return a.countryName.toLowerCase()<b.countryName.toLowerCase()?-1:1});self.allCountryCultureDetails=self.allCountryCultureDetails.filter(item=>(item!==undefined&&item!==null));function removeusingSet(arr){let outputArray=Array.from(new Set(arr));return outputArray;}
self.update();self.initialLoadDropdown();}
else{alert('something went wrong while country initialization !! please contact your service provider.')}}
self.initialLoadDropdown=function(){if(!self.retryButtonShown){dstvApp.initialCountryAbbreviation=dstvApp.countryabbreviation;dstvApp.initialLanguageAbbreviation=dstvApp.languageAbbreviation;}
self.initialCountryAbbreviation=dstvApp.countryabbreviation;self.initialLanguageAbbreviation=dstvApp.languageAbbreviation;if(self.initialCountryAbbreviation=='ao'||self.initialCountryAbbreviation=='mz'){self.selectedCountryAbbreviation=self.initialCountryAbbreviation;self.selectedLanguageAbbreviation=self.initialLanguageAbbreviation='pt';self.updateCountryParams();}
$('#ddlCountry').val(self.initialCountryAbbreviation+'-'+self.initialLanguageAbbreviation);$('#ciamddlCountry').val(self.initialCountryAbbreviation+'-'+self.initialLanguageAbbreviation);self.update();if(!location.href.includes('dashboard'))
setTimeout(function(){jcf.destroyAll();jcf.replaceAll();},1000);}
self.onCountryDropdownChange=function(e){let selectedItem=e.target.value;if(selectedItem){self.selectedCountryAbbreviation=selectedItem.split('-')[0];self.selectedLanguageAbbreviation=selectedItem.split('-')[1];self.updateCountryParams();self.InitializeTooltip();}}
self.updateCountryParams=function(){if(self.countryConfigData){let filteredCountryConfigData=self.countryConfigData.filter(c=>c.countryabbreviation.includes(self.selectedCountryAbbreviation)&&(c.languageAbbreviation.toLowerCase().includes(self.selectedLanguageAbbreviation)))[0];if(filteredCountryConfigData){dstvApp.country=filteredCountryConfigData.country;dstvApp.countryCode=filteredCountryConfigData.countryCode;dstvApp.countryabbreviation=filteredCountryConfigData.countryabbreviation;dstvApp.countrycurrency=filteredCountryConfigData.countrycurrency;dstvApp.countryisocode=filteredCountryConfigData.countryisocode;dstvApp.language=filteredCountryConfigData.language;dstvApp.languageAbbreviation=filteredCountryConfigData.languageAbbreviation;dstvApp.liveChatSupport=filteredCountryConfigData.liveChatSupport;dstvApp.DashboardURL='/'+dstvApp.languageAbbreviation+'-'+dstvApp.countryabbreviation+'/mydstv-account';window.culture='/'+filteredCountryConfigData.languageAbbreviation+'-'+filteredCountryConfigData.countryabbreviation;window.countryAbbr=filteredCountryConfigData.languageAbbreviation+'-'+filteredCountryConfigData.countryabbreviation;window.cultureCountryAbbr=filteredCountryConfigData.countryabbreviation;sessionStorage['prevCulture']=window.culture;sessionStorage['countryCode']=filteredCountryConfigData.countryabbreviation;self.isCiamApplicable=dstvApp.nociamCountries.includes(dstvApp.countryabbreviation)
self.update();}}
$.ajax({url:'/scripts/languageConfig.js',async:false,dataType:'json',success:function(res){if(res){if(dstvApp.language=="English"){langTranslateApp=res[0].en;}else{langTranslateApp=res[0].pt;}}
else{alert('something went wrong while country initialization !! please contact your service provider.')}},error:function(e){console.log('Unable to read language config js')}});self.resetFm=false;self.update();self.resetFm=true;self.update();}
self.ShowSurnameToolTip=function(){}
self.ShowSmartcardToolTip=function(){}
self.fetchConversionFactor=function(){if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;let converCurrencyUrl=dstvApp.DSOAPIUrl+`/apicurrency/api/v1/Currency?Country=${dstvApp.country}&ToCurrency=ETB`;site.factory.Get(converCurrencyUrl,'',self.onFetchConversionFactorSuccess,self.onFetchConversionFactorError)});}else{let converCurrencyUrl=dstvApp.DSOAPIUrl+`/apicurrency/api/v1/Currency?Country=${dstvApp.country}&ToCurrency=ETB`;site.factory.Get(converCurrencyUrl,'',self.onFetchConversionFactorSuccess,self.onFetchConversionFactorError)}}
self.onFetchConversionFactorSuccess=function(data){console.log('Accounts : On Currency conversion success');dstvApp.DualCurrencyConversionRate=data.conversionFactor;}
self.onFetchConversionFactorError=function(err){console.log('Accounts : On Currency conversion error');$('#errorMessage').show();}
self.validateSmartCard=function(e){e.which==13&&self.disableFindSmartCard?self.findCustomerBySmartCard():self.enableFindSmartCard();}
self.enableFindSmartCard=function(){self.disableFindSmartCard=$('#ciam_smartCardNumber').val()&&$('#ciam_smartCardNumber').val().length>=10;self.update()}
self.findCustomerBySmartCard=function(e){$('#ciam_smartCardNumber').siblings('p').hide()
$('#ciamSearchCustBtn').button('loading');event.preventDefault()
let smartCard=self.smartCard=$('#ciam_smartCardNumber').val()
let data={country:dstvApp.country,number:smartCard,type:"SmartcardNumber",businessUnit:dstvApp.businessunit,channel:dstvApp.channel}
site.factory.GetJWT().then(function(token){self.token=token;let url=`${dstvApp.DSOAPIUrl}apilogin/api/v1/Login/SearchCustomer`
site.factory.Post(url,data,self.token,self.findCustomerBySmartCardSuccess,self.findCustomerBySmartCardError)})}
self.findCustomerBack=function(e){$('#ciam-sm-login-screen').show()
$('#ciam-confirmation-screen').hide()
$('#ciam-otp-screen').hide()
$('#loginRetry').hide()
self.temp='tempClass'
self.update();}
self.onContactUs=function(e){let contactUsURL=`${dstvApp.dstvUrl}${window.culture}/help/contact-us`
window.open(contactUsURL)}
self.findCustomerBySmartCardSuccess=function(data){self.temp='confirmOTPClass'
$('#ciamSearchCustBtn').button('reset');console.log('findCustomerBySmartCardSuccess: ',data)
self.EmailAddress=data.EmailAddress.trim()
self.MobileNumber=data.MobileNumber.trim()
self.EncryptedData=data.EncryptedData
self.CustomerNumber=data.CustomerNumber
$('#loginRetry').hide()
$('#ciam-sm-login-screen').hide()
$('#ciam-confirmation-screen').show()
$('#ciam-otp-screen').hide()
self.ShowRetry()
self.update();self.MobileNumber?$('#confirmMobile').prop('checked',true):$('#confirmEmail').prop('checked',true)}
self.findCustomerBySmartCardError=function(data){$('#ciamSearchCustBtn').button('reset');console.log('findCustomerBySmartCardError: ',data)
self.inValidSearchSM=data.status==404?langTranslateApp.Invalidsm:langTranslateApp.ciamInvalidUser
self.update()
$('#ciam_smartCardNumber').siblings('p').show()}
self.IsValidOTP=function(e){let isNumeric=self.IsNumeric(e.key);let isEnterPress=e.which==13;let isbackpress=e.which==8;if(!isNumeric&&!isEnterPress||e.currentTarget.value){e.preventDefault();$(e.currentTarget).focus();if(!isbackpress&&!isEnterPress)return;}
e.currentTarget.removeAttribute('class')
if(isbackpress&&e.currentTarget.value){e.currentTarget.value="";}
else if(isbackpress&&!e.currentTarget.value){let nextElementSibling=e.currentTarget.previousElementSibling
setTimeout(()=>{nextElementSibling.focus()},50);}
else{if(isEnterPress){$('#verifyOtp').is(':disabled')?"":self.onVerifyOTP();return;}
let nextElementSibling=e.currentTarget.nextElementSibling
setTimeout(()=>{nextElementSibling.focus()},50);}
setTimeout(()=>{self.enableSend=$('#otpBox1').val()&&$('#otpBox2').val()&&$('#otpBox3').val()&&$('#otpBox4').val()?true:false;self.update();},500);self.update();}
self.ISPerformTimer=false
self.PerformTimer=function(){self.ISPerformTimer=true
$('#resendOtp').button('reset');setTimeout(function(){$('#resendOtp').prop("disabled",true)},50);self.resendTimer=0;self.enableRetry=false;$(".verify-otp-btn").siblings('p').find('span').show();if(self.resendTimer==0){self.resendTimer=30;self.update();self.interval=setInterval(function(){if(self.resendTimer==0){self.enableRetry=true;self.ISPerformTimer=false
self.update()
$(".verify-otp-btn").siblings('p').find('span').hide();clearInterval(self.interval);}
else{self.resendTimer-=1;self.enableRetry=false;$('#resendOtp').prop("disabled",true)}
self.update()},1000)}}
self.generateOrVerifyOTP=function(isGenerateOTP,otp){event.preventDefault();self.showMobOrEmail=$('input:radio:checked').val()=='mobile'?self.MobileNumber:self.EmailAddress
self.updating=true;self.enableSend=false;self.update();let url=`${dstvApp.DSOAPIUrl}/apigenericotp/OTP/GenerateOTP`;let data={"OtpType":$('input:radio:checked').val(),"ClientName":"CIAMlogin","ClientNameResponse":"","BusinessUnit":dstvApp.businessunit,"Channel":dstvApp.channel,"Country":dstvApp.country,"SmartCardNumber":self.smartCard,"CustomerNumber":self.CustomerNumber,"PhoneNumber":null,"EncryptedData":self.EncryptedData};if(isGenerateOTP){$('#otpnotReceived').hide();$('#optGenerate').button('loading');$('#resendOtp').button('loading');site.factory.Post(url,data,null,self.generateOTPSuccess,self.generateOTPError)}
else{setTimeout(function(){$('#resendOtp').prop("disabled",true)},50)
$('#verifyOtp').button('loading');url=`${dstvApp.DSOAPIUrl}/apigenericotp/OTP/VerifyOTP`;data.OTP=otp;site.factory.Post(url,data,null,self.verifyOTPSuccess,self.verifyOTPError);}}
self.generateOTPSuccess=function(data){$('#otpnotReceived').show();$("#otperror").html('');console.log('Generate OTP Success: ',data);$(".otp-group>input").val('');$('#ciam-sm-login-screen').hide()
$('#ciam-confirmation-screen').hide()
$('#ciam-otp-screen').show()
$('#loginRetry').hide()
self.enableRetry=false;self.enableSend=false;document.body.scrollTop=0;document.documentElement.scrollTop=0;self.update();self.PerformTimer();setTimeout(function(){$('#verifyOtp').prop("disabled",true)},50)}
self.generateOTPError=function(error){$('#optGenerate').button('reset');$("#otperror").html('');console.log('Generate OTP Fail');document.body.scrollTop=0;document.documentElement.scrollTop=0;self.updating=false;app.generateOTP=false;$('#updateDetailsModel').addClass('failure');self.showUpdateDetailsFailure=true;$(".update-details-inner").hide();$('.contact-details-section').removeClass('active');$('.update-details-section').removeClass('active');$('.main-top-Details-info').removeClass('active');self.update();setTimeout(function(){$('#verifyOtp').prop("disabled",true)},50)}
self.verifyOTPSuccess=function(data){console.log('verifyOTPSuccess: ',data)
self.linkCustomerToCiam()}
self.verifyOTPError=function(error){$('#verifyOtp').button('reset');console.log("Verify CIAM OTP : Error");document.body.scrollTop=0;document.documentElement.scrollTop=0;let errormsg=error.responseJSON.Message;self.ISPerformTimer?"":setTimeout(function(){$('#resendOtp').prop("disabled",false)},50)
if(error.status==403){if(error.responseJSON.Message.includes("Invalid OTP. You have reached the max attempt count.")){errormsg=langTranslateApp.ciamotpMaxLimit
setTimeout(function(){$('#verifyOtp').prop("disabled",true)},50)
$('#otpnotReceived').hide();}else{errormsg=langTranslateApp.otpNotValid;}}else if(error.status==404){errormsg=langTranslateApp.otpExpired;}
$("#otperror").html(errormsg);}
self.onVerifyOTP=function(){event.preventDefault();let validOTP=$('#otpBox1').val()&&$('#otpBox2').val()&&$('#otpBox3').val()&&$('#otpBox4').val()?true:false;if(validOTP){console.log("OTP validation : Success");app.generateOTP=false;let opt=$('#otpBox1').val()+$('#otpBox2').val()+$('#otpBox3').val()+$('#otpBox4').val();self.generateOrVerifyOTP(app.generateOTP,Number(opt));}else{console.log("OTP validation : Error");$('.otp-group').children().each(function(i,e){e.value?e.removeAttribute('class'):e.setAttribute("class","invalidotp");});}}
self.linkCustomerToCiam=function(){let data={"BusinessUnit":"DStvResSelfService","Country":dstvApp.country,"customerNumber":self.CustomerNumber,"clientId":dstvApp.ciamClientId,"channel":dstvApp.channel,"EncryptedData":self.EncryptedData,"refreshToken":app.ciamTokens.refresh_token,"accessToken":app.ciamTokens.access_token,"idToken":app.ciamTokens.id_token}
if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}/apiciamlogin/api/ApiIdentityManagement/LinkCIAMCustomer`;site.factory.Post(url,data,null,self.linkCustomerSuccess,self.linkCustomerError,false,false,false,true,true);}
else{let url=`${dstvApp.DSOAPIUrl}/apiciamlogin/api/ApiIdentityManagement/LinkCIAMCustomer`;site.factory.Post(url,data,null,self.linkCustomerSuccess,self.linkCustomerError);}}
self.linkCustomerSuccess=function(data){console.log("linkCustomerSuccess: ",data)
app.ciamTokens.access_token=data.AccessToken
app.ciamTokens.id_token=data.IdToken
app.ciamTokens.refresh_token=data.RefreshToken
window.SessionSave("app",app);self.checkCIAMJourney(data.IdToken)}
self.linkCustomerError=function(err){console.log("linkCustomerError: ",err)}
self.OnloginRedirection=function(){$('#loader').show()
self.generateCodeVerifier().then((data)=>{let codeChallenge=self.generateCodeChallenge(data)
console.log('CodeChallenge: ',codeChallenge)
app.codeChallenge=codeChallenge;self.temp='tempClass'
window.SessionSave("app",app);let callBackURL=`${window.location.origin}/en-ng/mydstv-sign-in`
console.log(`${dstvApp.ciamSignUpUrl}/authorize?&client_id=${dstvApp.ciamClientId}&redirect_uri=${callBackURL}&code_challenge=${codeChallenge}&code_challenge_method=S256&response_type=code&scope=openid&state=-ZJiO9NsbSvphPHVfZ88F4TtfjLy4TOqQx8IEDsAaN8&claims={"userinfo":{"associated_ids":null,"email":null,"country_code":null},"id_token":{"associated_ids":null,"email":null,"country_code":null}}&prompt=login`)
self.ShowRetry()
self.update()
$('#ciam-sm-login-screen').show()
$('#ciam-confirmation-screen').hide()
$('#ciam-otp-screen').hide()
$('#loginRetry').hide()
window.location=`${dstvApp.ciamSignUpUrl}/authorize?&client_id=${dstvApp.ciamClientId}&redirect_uri=${callBackURL}&code_challenge=${codeChallenge}&code_challenge_method=S256&response_type=code&scope=openid&state=oGUbWJYKqzYkUBrKBP_SBIarZIPnroTVTEuYvhCBKX8&claims={"userinfo":{"associated_ids":null,"email":null,"country_code":null},"id_token":{"associated_ids":null,"email":null,"country_code":null}}&prompt=login`}).catch((e)=>{console.log('Error : CIAM Redirection URL creation failed')})}
self.generateCodeVerifier=function(){let len=52;const characters='ABCDEFGHIJKLMNOPQRSTUVWXYZ';let result='';const charactersLength=characters.length;for(let i=0;i<len;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}
console.log('codeVerifier: ',result)
app.codeVerifier=result
return Promise.resolve(app.codeVerifier);}
self.generateCodeChallenge=function(data){let hash=CryptoJS.SHA256(data);return hash.toString(CryptoJS.enc.Base64).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'')}
self.generateTokens=function(){let callBackURL=`${window.location.origin}/${window.countryAbbr}/mydstv-sign-in`
let data={"grant_type":"authorization_code","code":app.ciamAuthCode,"redirect_uri":callBackURL,"client_id":dstvApp.ciamClientId,"code_verifier":app.codeVerifier}
site.factory.ciamPost(`${dstvApp.ciamSignUpUrl}/token`,data,self.generateTokensSucess,self.generateTokensError)}
self.generateTokensSucess=function(data){console.log('generateTokens Sucess: ',data)
app.ciamTokens=data
window.SessionSave("app",app);}
self.generateTokensError=function(data){console.log('generateTokens Error: ',data)}
self.checkCIAMJourney=function(data){$($('#signInModalPopup').find('button')[0]).hide()
console.log('Check CIAM journey')
app.ciamCustInfo=JSON.parse(atob(data.split('.')[1]))
app.ciamCustDetails=app.ciamCustInfo.associated_ids.filter(p=>p.BU.toLowerCase()=='dstvresselfservice')
if(app.ciamCustDetails.length>0){self.ciamCountrySelection()
self.OnCIAMlogin(data);}else{self.ShowRetry()
$('#loginRetry').hide()
$('#ciam-sm-login-screen').show()
self.temp='tempClass'
self.update();$('#loader').hide();}
window.SessionSave("app",app);}
self.OnCIAMlogin=function(data1){self.customerID=app.ciamCustDetails[0].CustId
console.log('CIAM login started: ',data1)
$('#loader').show()
let data={country:dstvApp.country,channel:dstvApp.channel,BusinessUnit:dstvApp.businessunit,idToken:data1,customerNumber:self.customerID}
if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}apilogin/api/v1/Login/GetCustomerDetailsByIdToken`;site.factory.Post(url,data,null,self.onLoginSuccess,self.onLoginError,false,false,false,true);}else{let url=`${dstvApp.DSOAPIUrl}apilogin/api/v1/Login/GetCustomerDetailsByIdToken`
site.factory.GetJWT().then(function(token){self.token=token;site.factory.Post(url,data,self.token,self.onLoginSuccess,self.onLoginError)})}}
self.OnCIAMloginSuccess=function(data){}
self.OnCIAMloginLoginError=function(err){console.log('CIAM login failed: ',err)}
self.ciamCountrySelection=function(){self.portoCountry=['ao','mz']
self.selectedCountryAbbreviation=app.ciamCustDetails[0].RegionCode.toLowerCase()
self.selectedLanguageAbbreviation=self.portoCountry.includes(self.selectedCountryAbbreviation)?'pt':'en'
self.updateCountryParams();self.update()}});