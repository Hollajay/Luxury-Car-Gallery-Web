riot.tag2('tag-showmax-atb','<section class="update-details-wrapper content-wrapper choice-popup clearfix" id="showmaxModel" role="dialog" if="{showmaxConfirm}"> <div class="showmax-section"> <!-- <button type="button" class="payment-close" href="javascript:void(0)">X</button> --> <div class="showmax-top-section text-center"> <img src="/media/12215/showmax_logo-b.svg" alt="Showmax Logo" class="showmax-icon"> <p class="montly-cost"> Monthly Cost </p> <span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {dstvApp.countrycurrency.toUpperCase()!="ETB"? app.showmaxAddOnDetails.price.value:app.showmaxAddOnDetails.localPrice.amount} p/m</span> <div class="info"> Showmax comes to you at an additional charge. <br>Click to Continue. </div> </div> <div class="update-details-inner"> <div class="details_btn"><button type="button" class="cancel_details_btn active" onclick={onShowmaxCancel}>Cancel</button><button type="button" class="save_details_btn" onclick={onShowmaxSignUp}>Continue</button></div> </div> </div></section><section if="{showShowmaxAtb}" class="showmax-section-main dashboardModal dashboardPOP clearfix" id="showmaxModel" role="dialog"> <div class="showmax-section"> <button if="{app.showmaxCardCaption == \'Add\' }" type="button" class="payment-close" href="javascript:void(0)" onclick={onShowmaxATBActivationFeedback}>X</button> <button if="{app.showmaxCardCaption != \'Add\'}" type="button" class="payment-close" href="javascript:void(0)" onclick={onShowmaxATBFeedback}>X</button> <div class=""> <div id="showmaxoverlay"> <div class="cv-spinner"> <span class="showmaxspinner"></span> </div> </div> <!--<div class="container-fluid main-section activate-section" if="{freeShowmaxSection}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <div class="showmaxInfoArea"> <span class="top-text"><span class="showmax-color">Add</span> Showmax</span> <span class="sub-text"> You are currently on <span class="currentPackagename">{smartcardForShowmax.primaryService.description}.</span><br/>and get <span class="showmax-color">Showmax On Us!</span><br> Activate your account NOW.</span> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href="javascript:void(0)" onclick={onActivateShowmax}>Activate Now <span class="arrowNow"></span></a></div> </div> </div>--> <section class="showmax-flow content-wrappers" if="{freeShowmaxSection}"> <div class="" id="" style=""> <div class="showmax-top-main-section" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ShowmaxSignupImage});"> <div class="clearfix"></div> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class="info"> <h2><span class="showmax-color heading-info">Congratulations !</span></h2> <p>As a <b>DStv Premium <span if="{app.isCurrDVSSmartcard}">streaming</span></b> subscriber <span class="congo-info">you qualify for <span class="showmax-color">Showmax</span> <b>at no cost</b></span></p> </div> </div> </div> <div class="glass-effect"> <div class="clearfix"> <div class="watch-showmax-btn"> <span class="showmax-heading">To get started create a </span> <b><span class="showmax-color"> Showmax account </span></b> <button id="showmax-watch" type="button" class="btn" onclick={onShowmaxSignUp}>Create Account <span class="arrowNow"></span></button></div> <div class="manage-showmax-btn"> <b><span class="showmax-color"> Already have Showmax? </span></b> <span class="showmax-heading white"> Sign in to continue </span> <button id="showmax-manage" type="button" class="btn" onclick={onShowmaxSignIn}>Sign In <span class="arrowNow"></span></button> <div class="or-text">OR</div> </div> </div> </div> <div class="video-section"> <div class="clearfix"> <span class="showmax-color bottom"> What is Showmax? </span> <iframe width="382" height="238" src="https://www.youtube.com/embed/Yxnw2hZ2LYU"></iframe> <!--<div class=""> <div class="controls" if="{showPlayButton}"> <ul> <li><img class="logo-video" src="/media/11607/sm-play.png" width="80" height="65" alt="" style="cursor: pointer;" onclick={playVideo}> </li> </ul> </div> <video id="videoPlayer" width="100%" height="auto" poster="/media/11464/capture-screen.png" controls> <source src="https://www.youtube.com/watch?v=Yxnw2hZ2LYU" type="video/mp4" > </video> </div>--> <p class="video-info">Watch this short video to find out more or get more<br> info <a href="https://www.showmax.com/eng/dstv" target="_blank">here</a></p> </div> </div> </div> </section> <section class="links-cards showmax-link" if="{showShowmaxProgress}"> <div class="linking-show-max"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> </div> <div class="col-md-12 animate-images"> <div class="figure-caption-first col-md-3 image" id="image-1"> <div class="backgroun-img" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.FirstImage}); center"> </div> </div> <div class="figure-caption-second col-md-3 image" id="image-2"> <div class="backgroun-img" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.SecondImage}); center"> </div> </div> <div class="figure-caption-third col-md-3 image" id="image-3"> <div class="backgroun-img" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ThirdImage}); center"> </div> </div> <div class="figure-caption-four col-md-3 image" id="image-4"> <div class="backgroun-img" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.FourthImage}); center"> </div> </div> </div> <div class="showmax-progress animate-progressbar"> <progress class="progress-bar" id="image" value="25" max="100"> 100% </progress> <label class="text" for="image">Linking your Showmax accountâ€¦</label> </div> </section> <!--<div class="container-fluid main-section activate-success" if="{showmaxActivated}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Almost done</h2> <div class="showmaxInfoArea"> <span if="{showPendingMessage}" class="sub-additional-text">{statusMessage}</span><br><span class="sub-mid-text">To finish Showmax setup, please create or sign in to a Showmax account.</span> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href="javascript:void(0)" onclick={onCreateShowmaxAccount}>Continue to Showmax <span class="arrowNow"></span></a> </div> </div> </div>--> <section class="showmax-flow activate content-wrappers" if="{showmaxActivated}"> <div class="" id="" style="/* display:none; */"> <div class="showmax-top-main-section" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ShowmaxLinkedImage});"> <div class="clearfix"></div> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class="info"> <h2><span class="showmax-color activate">AWESOME <img class="positive-hand" src="/media/11631/positive-vote.svg"></span></h2> <p if="{!showPendingMessage}"><b>Showmax</b> is successfully linked to your <b>DStv <span if="{app.isCurrDVSSmartcard}">streaming</span> account</b></p> <p if="{showPendingMessage}"><span class="sub-additional-text">{statusMessage}</span></p> </div> </div> </div> <div class="glass-effect"> <div class="clearfix"> <div class="watch-showmax-btn activate"> <span class="showmax-heading">To start watching, <b>download</b> the <b>Showmax app</b> and <b>Sign in</b> with </span> <b><span class="showmax-color activate-email"> {app.showmaxEmail} </span></b> <button id="showmax-watch" type="button" class="btn" onclick="{goToShowmax}">Watch Now <span class="arrowNow"></span></button></div> </div> </div> <div class="or-text activate">OR</div> <div class="link-info-showmax"><span class="download-apps">Enjoy <span class="text">Showmax</span> on the go by <span class="text">downloading the app.</span> </span> <span class="down-btn"> <span class=""> <a href="https://apps.apple.com/us/app/showmax/id1014875256" target="_blank"><button id="showmax-ios" type="button" class="btn"><i class="icon icon-icon-apple"></i> <span class="arrowNow"></span></button></a> <span class="device">Apple App Store</span> </span> <span class=""> <a href="https://play.google.com/store/apps/details?id=com.showmax.app&hl=en_IN&gl=US" target="_blank"><button id="showmax-android" type="button" class="btn"><i class="icon icon-icon-play-store"></i> <span class="arrowNow"></span></button></a> <span class="device">Google Play Store</span> </span> </span> </div> </div> </section> <div class="container-fluid main-section payment-success" if="{showmaxActivationPaymentSuccess}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Payment Successful</h2> <img src="/media/10053/success-tick.svg" class="icon-success"> <div class="showmaxInfoArea"> <span class="sub-top-text">Enjoy your Showmax</span> <span class="sub-mid-text"> Stay entertained by streaming your favourite shows and movies.</span> </div> <div class="paymentSccessInfoDetails"> <div class="paylabelValue"><span class="leftTextLabel transactionIdLabel">Transaction ID: </span><span class="rightTextValue transactionIdValue">31828199</span></div> <div class="paylabelValue"><span class="leftTextLabel DateLabel"> Date: </span><span class="rightTextValue DateValue">01-Nov-2019</span></div> <div class="paylabelValue"><span class="leftTextLabel StatusLabel"> Status: </span><span class="rightTextValue StatusValue">Successful</span></div> <div class="paylabelValue"><span class="leftTextLabel AmountLabel"> Amount: </span><span class="rightTextValue AmountValue">1709.0</span></div> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href="">Close <span class="arrowNow"></span></a></div> </div> </div> <!--<div class="container-fluid main-section cancellationSucessful" if="{showmaxCancelled}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Cancellation Successful</h2> <img src="/media/10053/success-tick.svg" class="icon-success"> <div class="showmaxInfoArea"> <span class="sub-top-text">You no longer have Showmax</span> <span class="sub-mid-text"> We are sad to see you go, please let us know why you chose to leave and we hope to see you back soon.</span> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href="javascript:void(0)" onclick={onShowmaxATBFeedback}>Give Us Feedback<span class="arrowNow"></span></a></div> </div> </div>--> <section class="showmax-flow cancle feedback content-wrappers" if="{showmaxCancelled}"> <span class="arrow-prev"></span> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class=""> <div class="smiles"> <img src="/media/11624/thanks-uat.svg" alt="smile Logo" class="smile-icon"> <div class="informations"> <h4>Cancellation Successful</h4> <span class="sub-title">We are <b>sad to see you go,</b> please let us know why you <b>chose to leave</b> </span><span class="sub-title">and we hope to <b>see you back soon.</b></span> <div class="show-max-btn"> <button id="showmax-cancle-btn" type="button" class="btn" onclick={onShowmaxATBFeedback}> Give feedback <span class="arrowNow"></span></button></div> </div> </div> <div class="or-text activate">OR</div> <div class="link-info-showmax"> <span class="down-btn"><button id="showmax-cancle-process" type="button" class="btn" onclick={goToAccount}>Skip this step <span class="arrowNow"></span></button> </span> </div> </div> </section> <div class="container-fluid main-section feedbackReceived" if="{showmaxFeedbackReceived}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Feedback Received</h2> <img src="/media/11625/success-tick-uat.svg" class="icon-success"> <div class="showmaxInfoArea"> <span class="sub-top-text">Thank you for the feedback</span> <span class="sub-mid-text">WeÃ¢â‚¬â„¢ll be getting one of our agents to review your feedback and give feedback.</span> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href="">Close<span class="arrowNow"></span></a></div> </div> </div> <!--<div class="upgradeShowmaxSection" if="{showmaxUpgradeSection}"> <div class="container-fluid main-section upgradeShowmax"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <div class="popup showmaxPopup"> <div class="showmaxInfoArea"> <span class="top-text" style="margin:0;"><span class="showmax-color">Upgrade</span> to <span class="showmax-color">DStv Premium</span> to <br/> get Showmax at <span class="showmax-color">NO COST</span> </span> </div> <div class="showmax-activate-btn"><a class="btn-show-active upgrade-now " href="javascript:void(0)" onclick={onUpgradeShowmaxATB}>Upgrade Now <span class="arrowNow"></span></a></div> </div> </div> <div class="container-fluid main-section addShowmax"> <div class="popup showmaxPopup"> <div class="showmaxInfoArea"> <span hidden="{manageDiscText}" class="sub-text">Get Showmax at <span class="showmax-color">50% discount.</span> <br/> You only pay <span class="showmax-color">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value}</span></span><span hidden="{managePriceText}" class="sub-text">Get Showmax at <span class="showmax-color">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value}</span></span></div> <div class="showmax-activate-btn"><a class="btn-show-active" href="javascript:void(0)" onclick={onActivateShowmax}>Add to bill <span class="arrowNow"></span></a></div> </div> </div> <div class="container-fluid main-section tryShowmax" style="display:none"> <div class="popup showmaxPopup"> <div class="showmaxInfoArea"> <span class="sub-text"> Try Showmax<span class="showmax-color"> for free</span></span> </div> <div class="showmax-activate-btn"><a class="btn-show-active" href={showmaxTrialSignUpURL} target="blank">Try Today <span class="arrowNow"></span></a></div> </div> </div></div>--> <section class="showmax-flow content-wrappers" if="{showmaxUpgradeSection}"> <div class="" id="" style=""> <div class="showmax-top-main-section" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ShowmaxSignupImage});"> <div class="clearfix"></div> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class="info" if="{app.showmaxDiscountValue == \'50\' || app.showmaxDiscountValue == \'100\'}"> <h2><span class="showmax-color heading-info">Congratulations !</span></h2> <p>As a <b>{formattedPackageName}</b> subscriber <span class="congo-info">you qualify for <b><span class="showmax-color">Showmax</span></b> <span if="{app.showmaxDiscountValue == \'50\'}" class=""><b>at 50% discount</b></span> <span if="{app.showmaxDiscountValue == \'50\'}" class=""><span style="text-decoration: line-through;"> (<span style="text-transform: uppercase;">{dstvApp.countrycurrency}</span> {dstvApp.countrycurrency.toUpperCase()!="ETB"? app.showmaxNormalPrice.price.value:app.showmaxNormalPrice.localPrice.amount} p/m)</span> <span class="showmax-color"><span>{dstvApp.countrycurrency}</span> {dstvApp.countrycurrency.toUpperCase()!="ETB"? app.showmaxAddOnDetails.price.value:app.showmaxAddOnDetails.localPrice.amount} p/m</span></span> <span if="{app.showmaxDiscountValue == \'100\'}" class="showmax-color">at no cost</span></span></p> </div> <div class="info" if="{app.showmaxDiscountValue == \'0\'}"> <p>As a <b>{formattedPackageName}</b> subscriber <span class="congo-info">you qualify for <b><span class="showmax-color">Showmax</span></b> <span if="{!app.dualCurrencyApplicable}" class="">at {dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</span><span if="{app.dualCurrencyApplicable}" class="showmax-color">at {dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.localPrice.amount}</span></span></p> </div> </div> </div> <div class="glass-effect"> <div class="clearfix clears"> <div class="watch-showmax-btn"> <span class="showmax-heading line" if="{app.showmaxDiscountValue == \'50\'}">Get Showmax at <br> <span class="showmax-color"> <span>{dstvApp.countrycurrency}</span> {dstvApp.countrycurrency.toUpperCase()!="ETB"? app.showmaxAddOnDetails.price.value:app.showmaxAddOnDetails.localPrice.amount} p/m</span> </span><span class="showmax-heading" if="{app.showmaxDiscountValue == \'0\'}">Get Showmax at <span if="{!app.dualCurrencyApplicable}" class="showmax-color bottom-info">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</span><span if="{app.dualCurrencyApplicable}" class="showmax-color bottom-info">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.localPrice.amount} </span></span> <span class="info-bottom-line" if="{app.showmaxDiscountValue == \'50\'}"> <!-- discount --> </span> <button id="showmax-watch" type="button" class="btn" onclick={onShowmaxConfirm}>Activate Now <span class="arrowNow"></span></button> </div> <div class="manage-showmax-btn"> <span class="bottom-bold-info"> <span class="first line bold"> Upgrade</span> <span class="nonbold">to </span> <span class="line bold">Premium</span> <span class="nonbold">and</span> </span> <span class="second nonbold"> get </span> <span class="line bold">Showmax</span> <span class="nonbold">at </span> <span class="showmax-color"> 100% discount </span> <button id="showmax-manage" type="button" class="btn" onclick={onUpgradeShowmaxATB}>Upgrade Now <span class="arrowNow"></span></button> <div class="or-text">OR</div> </div> </div> </div> <div class="video-section"> <div class="clearfix"> <span class="showmax-color bottom"> What is Showmax? </span> <iframe width="382" height="238" src="https://www.youtube.com/embed/Yxnw2hZ2LYU"></iframe> <!-- <div class=""> <div class="controls" if="{showPlayButton}"> <ul> <li><img class="logo-video" src="/media/11607/sm-play.png" width="80" height="65" alt="" style="cursor: pointer;" onclick={playVideo}> </li> </ul> </div> <video id="videoPlayer" preload="preload" autoplay="autoplay" width="100%" height="auto" poster="/media/11464/capture-screen.png" controls> <source type="video/youtube" src="https://www.youtube.com/watch?v=Yxnw2hZ2LYU"> </video> </div>--> <p class="video-info">Watch this short video to find out more or get more<br> info <a href="https://www.showmax.com/eng/dstv" target="_blank">here</a></p> </div> </div> </div> </section> <!--<div class="container-fluid main-section cancelShowmaxConfirm" if="{showmaxConfirmCancel}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Cancel Showmax</h2> <img src="/media/10052/cancle-img.svg" class="cancel-img"> <div class="cancelSectiontext"><span class="sub-text first-text-cancle"> You are about to cancel Showmax.</span><span class="sub-text"> You will be missing out on amazing <b>local and <br>international series</b> and <b>movies on demand.</b></span> </div> <div class="showmaxInfoArea"> <a href="javascript:void(0)" onclick={onBack}><span class="backicon"><span class="arrowNow"></span><span class="backword">Back</span></span></a> <a href="javascript:void(0)" onclick={onConfirmedCancelShowmax}><span class="Confirm-Btn"><span class="confirmword"> Confirm</span><span class="arrowNow"></span></span></a> </div> </div> </div>--> <section class="showmax-flow cancle content-wrappers" if="{showmaxConfirmCancel}"> <div class="clearfix"></div> <span class="arrow-prev"></span> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class="cancle"> <div class="smiles"> <img src="/media/11626/smile-please-uat.svg" alt="smile Logo" class="smile-icon"> <div class="informations"> <span class="sub-title">You are about to <b>cancel</b> your Showmax subscription.</span><span class="sub-title">You will be <b>missing out</b> on amazing local and <b>international series</b> and <b>movies on demand.</b></span> <div class="show-max-btn"> <button id="showmax-cancle-btn" type="button" class="btn" onclick={goToAccount}><span class="icon-icon-previous"></span> Keep Showmax</button></div> </div> </div> </div> <div class="cancle-bottom"> <div class="or-text activate">OR</div> <div class="link-info-showmax"><span class="download-apps">Not enjoying <span class="text">Showmax?</span> Click here to cancel this service. </span> <span class="down-btn"> <span class=""> <button id="showmax-cancle-process" type="button" class="btn" onclick={onConfirmedCancelShowmax}>Cancel Showmax <span class="arrowNow"></span></button> </span> </span> </div> </div> </section> <div class="container-fluid main-section ErrorMassage" if="{showmaxGenericError}"> <div class="popup showmaxPopup"> <img src="/media/10049/layer1-2x.png" class="showmax-icon"> <h2 class="activesuccessheading">Oh no! Something <br> went wrong</h2> <img src="/media/11627/cancle-img-uat.svg" class="icon-downgrade"> <p if="{pendingMessage}" class="errorShowmaxMessage">{message}</p> <div class="showmaxInfoArea"> <a href="javascript:void(0)" onclick={onCancel}><span class="backicon" data-dismiss="modal"><span class="backword" data-dismiss="modal">Cancel</span><span class="crossarrow"></span></span></a><a href="javascript:void(0)" onclick={onTryAgain}> <span class="cancle-icon"><span class="confirmword">Try Again</span><img src="/media/11628/try-icon-uat.svg"></span></a> </div> </div> </div> <!--<div class="ShowmaxPackagePopup" if="{showmaxManage}"> <h4 class="modal-title">{langTranslateApp.currentPackage}</h4> <div class="main-top-package-info"> <div class="package-info-left col-lg-5 col-xs-5 col-sm-5 col-md-5"><span class="icon-pack icon-{smartcardForShowmax.primaryService.productCode}"></span></div> <div class="package-info-right {smartcardForShowmax.primaryService.serviceName.split(\'-\')[1].trim()} {smartcardForShowmax.primaryService.productCode} col-lg-7 col-xs-7 col-sm-7 col-md-7"> <div class="backgroundimg"></div> <div class="smartcard"> {langTranslateApp.loginSmartcardNumber} <div class="number">{smartcardForShowmax.SerialNumber}</div> </div> </div> </div> <div class="second-top-package-info col-lg-12 col-xs-12 col-sm-12 col-md-12 {smartcardForShowmax.primaryService.serviceName.split(\'-\')[1].trim()} {smartcardForShowmax.primaryService.productCode}"> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-first"> <div class="smartcard1">{langTranslateApp.dashDecoder}</div> <div class="smartcard1 decoder-name">Explora</div> <img src="/media/7655/explora-1.png"> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-second"> <div class="package-text-price ">{langTranslateApp.pkgPriceMonthly}</div> <div if="{!app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {smartcardForShowmaxPrice}</div> <div if="{app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {smartcardForShowmaxDualCurrencyPrice}</div> <div class="package-text-amount price-bten">{langTranslateApp.pkgAmountAvailable}</div> <div if="{!app.dualCurrencyApplicable}" class="package-amount">{dstvApp.countrycurrency.toUpperCase()} {availableAccountBalance}</div> <div if="{app.dualCurrencyApplicable}" class="package-amount">{dstvApp.countrycurrency.toUpperCase()} {availableAccountBalanceDualCurrency}</div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-third"> <div class="smartcardStatus">{langTranslateApp.accStatus}</div> <div class="Status-info {app.CardStatus}"><img class="icon-background-img" src="/media/8268/icon-tick.svg"><span class="icon-icon-warning"></span><span if="{dstvApp.language == \'English\'}">{smartcardForShowmax.primaryService.status}</span><span if="{dstvApp.language == \'Portuguese\' && app.dashSelectedPackageCardStatus == \'Active\'}">Activo</span><span if="{dstvApp.language == \'Portuguese\' && app.dashSelectedPackageCardStatus == \'Disconnected\'}">Desconectado</span><span if="{dstvApp.language == \'Portuguese\' && app.dashSelectedPackageCardStatus == \'Suspended\'}">Suspensa</span> </div> <div class="addon-showmax-status"><span class="addonText">{langTranslateApp.Addons}</span><span class="showmax-text">{langTranslateApp.dashShowmaxCapital}</span></div> </div> </div> <div class="package-change-bottom-section"> <h2> Manage </h2> <label class="main-packagelist-section showmaxPackageSection col-lg-12 col-xs-12 col-sm-12 col-md-12"> <div class="left-packagelist-section col-lg-5 col-xs-5 col-sm-5 col-md-5"> <span class="icon-pack icon-showmax"></span> </div> <div class="right-packagelist-section showmaxRightSection col-lg-7 col-xs-7 col-sm-7 col-md-7"> <div class="smat-text">{langTranslateApp.pkgPriceMonthly}</div> <div class="smat-number">{dstvApp.countrycurrency.toUpperCase()} <span class="pricePerMonth"> {app.showmaxAddOnDetails.price.value} p/m</span></div> </div> <div class="showmax-price-section"> <div class="payment-showmax-right"> <a href="javascript:void(0)" onclick={onCancelShowmax}><span class="cancel-showmax"><span class="cancel-icon"><img src="/media/10050/showmax-cancle.svg"></span>{langTranslateApp.showmaxCancelButton}</span></a> </div> </div> </label> </div> </div>--> <section class="showmax-flow activate manage content-wrappers" if="{showmaxManage}"> <div class="" id="" style="/* display:none; */"> <div class="showmax-top-main-section-manage"> <div class="clearfix"></div> <p><span class="arrow-prev"></span></p> <h5 class="heading">Manage your <b>Showmax</b> subscription</h5> <div class="showmax-top-sectionmanage" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ManageShowmaxImage});"> </div> </div> <div class="show-max-list"> <p class="show-title">Select the option below to cancel your Showmax subscription</p> <div class="show-max-descriptions"> <div class="show-max-item"> <label class="cp-lable main-showmax-section col-lg-12 col-xs-12 col-sm-12 col-md-12" for="SHOWMAXE36"> <div class="clearfix"></div> <div class="left-packagelist-section col-lg-5 col-xs-5 col-sm-5 col-md-5"> <span class="icon-pack icon-SHOWMAXE36"></span> </div> <div class="right-packagelist-section SHOWMAXE36 col-lg-7 col-xs-7 col-sm-7 col-md-7 "> <div class="smat-text">Price</div> <div class="smat-number"><span if="{!app.dualCurrencyApplicable}">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value}</span><span if="{app.dualCurrencyApplicable}">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.localPrice.amount}</span><span class="pricePerMonth"> p/m</span> </div> </div> </label> <div class="clearfix"></div> <div class="change-package-description pay-package-dtls" id="SHOWMAXE36" value="SHOWMAXE36~0"> <div class="bottom"> <div><span> <a class="btn anim-btn btn-default change-btn" id="showmaxbutton" style="" href="javascript:void(0)" onclick={onCancelShowmax}><span class="anim-span"></span>Cancel Showmax</a></span></div> </div> </div> </div> </div> </div> <div if="{!dstvPremium}" class="or-text activate">Or</div> <div if="{!dstvPremium}" class="downgrade link-info-showmax"> <div class="down-info"> <span class="download-apps"> <span class="text">Upgrade </span> to <span class="text">DStv Premium </span> & </span> <span class="download-apps">get <span class="text">Showmax</span> at <span class="text-color">100% discount</span></span> </div> <div class="down-info"> <span class="down-btn"> <button id="downgrade-btn" type="button" class="btn" onclick={onChangePackage}>Upgrade Now <span class="arrowNow"></span></button> </span> </div> </div> </div> </section> <div class="container-fluid main-section cost-summary" if="{costSummaryShowmax}"> <div class="popup showmaxPopup"> <div class="package-selection showmax-package-cost" style=""> <div class="back-package"> <div class="backcard lslide" style="width: 100%; display: inline-block;"> <div class="backcard-packageItem {smartcardForShowmaxName} {smartcardForShowmaxCode}"> <i class="icon-pack icon-{smartcardForShowmaxCode}"></i> <div class="backgroundimg"> </div> </div> </div> </div> <img src="/media/11629/plus-sign-button-uat.svg" class="back-icon-img"> <div class="selected-package"> <div class="backcard lslide" style=""> <div class="backcard-packageItem " style=""> <div class="backcardprice"> <span class="showmax-package-image"><img src="/media/11630/uat-layer1-2.svg" style="width: 90%;"> </span></div> <div class="bottomBar"> <span></span> </div> </div> </div> </div> </div> <h4 class="modal-title">{langTranslateApp.pkgCostSummary}</h4> <div class="clearfix"></div> <div class="showmax-cost-details row"> <div class="details-info col-lg-12 col-xs-12 col-sm-12 col-md-12 top"> <div class="details-info-text col-lg-6 col-xs-6 col-sm-6 col-md-6 "> SHOWMAX {langTranslateApp.pkgMonthlyCostTitle}</div> <div class="details-info-price col-lg-6 col-xs-6 col-sm-6 col-md-6">{dstvApp.countrycurrency.toUpperCase()} {showmaxPrice}</div> </div> <div class="details-info col-lg-12 col-xs-12 col-sm-12 col-md-12"> <div class="details-info-text col-lg-6 col-xs-6 col-sm-6 col-md-6"> {langTranslateApp.pkgChangeEstimatedCost} </div> <div if="{!app.dualCurrencyApplicable}" class="details-info-price col-lg-6 col-xs-6 col-sm-6 col-md-6">{dstvApp.countrycurrency.toUpperCase()} {dueAmount}</div> <div if="{app.dualCurrencyApplicable}" class="details-info-price col-lg-6 col-xs-6 col-sm-6 col-md-6">{DualCurrency.toUpperCase()} {DualCurrencydueAmount}</div> </div> </div> <div class="showmaxInfoArea"> <div class="cost-btn"> <button type="button" class="pay-btn-cost" id="btnShowmaxPay" onclick="{onProcessPayment}">{langTranslateApp.subMenuPayNow}</button> </div> </div> </div> </div> <div class="clearfix"></div> </div> </div></section>','tag-showmax-atb,[riot-tag="tag-showmax-atb"],[data-is="tag-showmax-atb"]{ visibility: visible; display: block; }','',function(opts){var self=this;self.token='';self.loading=true;self.freeShowmaxSection=false;self.showmaxUpgradeSection=false;self.showmaxActivated=false;self.showmaxActivationPaymentSuccess=false;self.showmaxCancelled=false;self.showmaxFeedbackReceived=false;self.showmaxConfirmCancel=false;self.showmaxGenericError=false;self.showmaxManage=false;self.showmaxDowngradeWarning=false;let dotcom=site.env=='PROD'?'.com':'.io';self.showmaxGetItNowURL=`https://secure.showmax${dotcom}/v133.0/website/signup`;self.showmaxTrialSignUpURL=`https://secure.showmax${dotcom}/v133.0/website/signup`;self.showmaxWebsiteLink=`https://secure.showmax${dotcom}`;self.showmaxSignUpUrl=`https://secure.showmax${dotcom}/v134.0/dstv${dstvApp.countryabbreviation}/signup?client_id=${dstvApp.clientIdShowmax}&redirect_uri=${window.location.origin}${window.culture}/mydstv-account`;self.showmaxSignInUrl=`https://secure.showmax${dotcom}/v134.0/dstv${dstvApp.countryabbreviation}/signin?client_id=${dstvApp.clientIdShowmax}&redirect_uri=${window.location.origin}${window.culture}/mydstv-account`;self.isShowmaxAvailable=false;self.costSummaryShowmax=false;self.payReconnect=false;self.showPendingMessage=false;self.pendingMessage=false;self.showPlayButton=true;self.arrayDualCurrencyContries=[];self.arrayDualCurrencies=[];self.dualNamepackage=dstvApp.country.toLowerCase()=='tanzania'||dstvApp.country.toLowerCase()=='ethiopia'
if(app.smartcards&&app.smartcards.length>0){self.smartcardForShowmax=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard);self.dstvPremium=self.smartcardForShowmax.some(x=>x.primaryService.productName.includes("premium"));self.smartcardForShowmax=self.smartcardForShowmax[0];if(self.smartcardForShowmax){self.smartcardForShowmaxName=self.smartcardForShowmax.primaryService.serviceName.split('-')[1].trim();self.smartcardForShowmaxCode=self.smartcardForShowmax.primaryService.productCode;self.smartcardForShowmaxPrice=self.smartcardForShowmax.primaryService.price;self.smartcardForShowmaxDualCurrencyPrice=self.smartcardForShowmax.primaryService.localPrice;}
var wordsToRemove=['bouquet','e36','is20','Standalone','Subscription','subscription'];var expStr=wordsToRemove.join("|");if(self.smartcardForShowmax){self.formattedPackageName=self.smartcardForShowmax.primaryService.description.replace(new RegExp('\\b('+expStr+')\\b','gi'),' ').replace(/\s{2,}/g,' ');if(self.formattedPackageName.trim()=="DStv Access Streaming"&&dstvApp.countryabbreviation=='ng'){self.formattedPackageName="DStv Yanga Streaming"}else if(self.formattedPackageName.trim()=="DStv Family Streaming"&&dstvApp.countryabbreviation=='ng'){self.formattedPackageName="DStv Confam Streaming"}}
if(self.smartcardForShowmax&&self.dualNamepackage){self.formattedPackageName=dstvApp.packages.find(p=>p.properties.Code==self.smartcardForShowmax.primaryService.productCode).properties.Name}}
for(var i=0;i<dstvApp.DualCurrenciesList.length;i++){var split=dstvApp.DualCurrenciesList[i].split("-");self.arrayDualCurrencyContries.push(split[0]);self.arrayDualCurrencies.push(split[1]);}
if(dstvApp.DualCurrency&&dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)){if(app.dualCurrencyApplicable!==undefined&&app.dualCurrencyApplicable&&!self.notDualCurrency){dstvApp.countrycurrency=self.arrayDualCurrencies[0];}}
self.on('mount',function(){if(self.opts.showComponent){console.log('Showmax ATB : In Mount...');self.showShowmax=true;$('tag-more-service').hide();site.factory.GetJWT().then(function(token){self.token=token;self.initiateShowmaxATB();self.update();});$("#showmaxModel").on("hidden.bs.modal",function(){if(self.PackageReloadRequired)
location.reload();})
if(app.showmaxDiscountValue&&app.showmaxDiscountValue==50){self.manageDiscText=false;self.managePriceText=true;}
else{self.manageDiscText=true;self.managePriceText=false;}
self.update();}
self.getAvailableShowmaxContent();});self.getAvailableShowmaxContent=function(){fetch(dstvApp.targetDomain+"/api-services-showmax/showmax-content/ujson?select=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&resolveMedia=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetAvailableContentSuccess(commits));}
self.onGetAvailableContentSuccess=function(data){console.log('Showmax : Success in fetching Showmax Umbraco content');self.showmaxUmbracoContent=data.properties;self.update();}
self.initiateShowmaxATB=function(){if(app.accountsInfo&&app.accountsInfo[0]&&app.accountsInfo[0].AccountBalance){self.availableAccountBalance=app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0].AccountBalance.Value;if(dstvApp.DualCurrency=='on'&&dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))
self.availableAccountBalanceDualCurrency=app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0].AccountBalance.LocalPrice.Amount.toString();}
else{self.availableAccountBalance='NA';}
if(opts.showActivate||opts.createShowmaxAccount||opts.changePackageCancelShowmax||opts.changePackageAddShowmax||opts.paySuccessReconnectShowmax||opts.paySuccessAddShowmax||opts.handlePayReconnect||opts.showmaxSignUp||opts.activateShowmaxAddOn){self.showShowmaxAtb=true;if(self.dstvPremium){self.freeShowmaxSection=true;self.showmaxUpgradeSection=false;}
else{self.freeShowmaxSection=false;self.showmaxUpgradeSection=true;}}
if(opts.showManage){self.showShowmaxAtb=true;self.showmaxManage=true;}
if(opts.showPackagePaymentSuccess){self.update();$('#showmaxModel').modal('show');self.showmaxActivationPaymentSuccess=true;}
if(opts.handlePayReconnect||opts.paySuccessReconnectShowmax){self.update();self.onShowmaxReconnect();}
if(opts.paySuccessCreateAccount){self.showShowmaxAtb=true;self.showShowmaxProgress=true;self.update();self.onCreateShowmaxAccount();self.animateShowmaxActivate();}
if(opts.changePackageCancelShowmax){self.freeShowmaxSection=false;self.showmaxConfirmCancel=true;}
if(opts.showmaxSignUp){self.update();$("#showmaxoverlay").fadeIn(300);self.onActivateShowmax();}
if(opts.paySuccessAddShowmax&&app.packageUpgradeDowngradeReq){self.freeShowmaxSection=true;self.showmaxUpgradeSection=false;}
self.update();}
self.animateShowmaxActivate=function(){let imageCount=$('.animate-images div.image').length;$('.animate-images div.image').css('visibility','hidden');let img=0,prog=100/imageCount,$imgs=$('.image'),$bar=$('.animate-images');self.animationInterval=setInterval(function(){if(img<imageCount){$('.animate-images .image')[img].style.visibility='visible';}
if(img==imageCount){img=0;$('.animate-images div.image').css('visibility','hidden');}
else{img=img+1;}
if(prog<=100){$('.progress-bar')[0].value=prog;prog=prog+100/imageCount;}
else{prog=100/imageCount;}},1500);}
self.visible=function(){return this.css('visibility','visible');}
self.backshowmax=function(){window.HandleActiveTab('showAccount')}
self.onActivateShowmax=function(){console.log('Showmax : Initiating activation');let smartcard=self.smartcardForShowmax.SerialNumber;if(opts.activateShowmaxAddOn)
smartcard=opts.smartcardFromAddonReq;self.reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"smartCardNumber":smartcard,"customerNumber":app.customernumber,"currentPackageName":self.smartcardForShowmax.primaryService.serviceName}
if(app.packageUpgradeDowngradeReq){self.reqBody.currentPackageName=app.packageUpgradeDowngradeReq.toPackageName;app.packageUpgradeDowngradeReq=undefined;}
if(dstvApp.EnableSecurityAuth){self.url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v2/Showmax/Capture?email=${app.showmaxEmail}&signature=${app.showmaxEmailSig}`;site.factory.Post(self.url,self.reqBody,null,self.onCaptureSuccess,self.onCaptureError,false,false,true,true);}else{self.url=dstvApp.DSOAPIUrl+`/apishowmax/api/v2/Showmax/Capture?email=${app.showmaxEmail}&signature=${app.showmaxEmailSig}`;site.factory.Post(self.url,self.reqBody,self.token,self.onCaptureSuccess,self.onCaptureError);}
site.factory.trackData('SHOWMAX-CAPTURE-REQ',self.reqBody,null);}
self.onCaptureSuccess=function(data){$("#showmaxoverlay").fadeOut(300);self.showmaxGenericError=false;self.showmaxActivationPaymentSuccess=false;self.showmaxUpgradeSection=false;self.freeShowmaxSection=false;site.factory.trackData('SHOWMAX-CAPTURE-RES',null,data);if(data&&data.StatusCode==208){self.showmaxActivated=true;self.showPendingMessage=true;self.statusMessage=data.Message;self.update();return;}
self.showShowmaxAtb=true;self.showShowmaxProgress=true;self.onCreateShowmaxAccount();self.animateShowmaxActivate();self.update();app.forceReload=true;self.GetAmountToPayAndSubscription();self.preventBrowserBack();}
self.onCaptureError=function(err){$("#showmaxoverlay").fadeOut(300);self.showmaxActivationPaymentSuccess=false;self.showmaxUpgradeSection=false;self.showmaxGenericError=false;clearInterval(self.animationInterval);self.showShowmaxProgress=false;self.captureError=true;app.forceReload=true;if(err.responseJSON&&err.responseJSON.StatusCode==402){var showmaxQoute=JSON.parse(err.responseJSON.Message);var res=err.responseJSON.Message.split('\\');res=JSON.parse(res);self.dueAmount=res.Payment.Amount;self.currency=res.Payment.Currency;self.DualCurrency=res.LocalCurrency?res.LocalCurrency.Currency:null;self.DualCurrencydueAmount=res.LocalCurrency?res.LocalCurrency.Amount:null;self.message=res.ResponseMessage;self.showmaxPrice=app.showmaxAddOnDetails?(app.showmaxAddOnDetails.price?app.showmaxAddOnDetails.price.value:null):null;if(app.dualCurrencyApplicable)
self.showmaxPrice=app.showmaxAddOnDetails&&app.dualCurrencyApplicable?(app.showmaxAddOnDetails.localPrice?app.showmaxAddOnDetails.localPrice.amount:null):null;self.freeShowmaxSection=false;self.update();if(opts.activateShowmaxAddOn)
smartcard=opts.smartcardFromAddonReq;else
smartcard=app.smartcard;window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{showmaxPayment:true,amount:self.dueAmount,currency:self.currency,dualCurrencyAmount:self.DualCurrencydueAmount,dualcurrency:self.DualCurrency,message:self.message,showmaxPrice:self.showmaxPrice,smartcardNumber:smartcard,showmaxQoute:showmaxQoute});}
else if(err.responseJSON&&err.responseJSON.StatusCode==400){console.log(err.responseJSON.Message);self.freeShowmaxSection=false;self.showmaxGenericError=true;}
else if(err.responseJSON&&err.responseJSON.StatusCode==422){console.log(err.responseJSON.Message);self.message=err.responseJSON.Message;if(err.responseJSON.Message.toLowerCase().includes('invalid commercial')){self.message='You already have showmax activated in the linked smartcard. Please login with the smartcard with active showmax to manage showmax.';}
self.pendingMessage=true;self.freeShowmaxSection=false;self.showmaxGenericError=true;}
else if(err.responseJSON&&err.responseJSON.StatusCode==428){console.log(err.responseJSON.Message);self.freeShowmaxSection=false;self.onShowmaxReconnect();}
else{self.freeShowmaxSection=false;self.showmaxGenericError=true;}
self.onCreateShowmaxAccount();self.update();self.preventBrowserBack();}
self.onCancelShowmax=function(){self.showmaxManage=false;self.showmaxConfirmCancel=true;}
self.onConfirmedCancelShowmax=function(){console.log('Showmax ATB : Initiating Showmax Cancellation');$("#showmaxoverlay").fadeIn(300);self.reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"smartCardNumber":self.smartcardForShowmax.SerialNumber,"customerNumber":app.customernumber,"packageName":app.showmaxAddOnDetails.name}
if(dstvApp.EnableSecurityAuth){self.url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v1/Showmax/Cancel`;site.factory.Post(self.url,self.reqBody,null,self.onCancelSuccess,self.onCancelError,false,false,true,true);}else{self.url=dstvApp.DSOAPIUrl+`/apishowmax/api/v1/Showmax/Cancel`;site.factory.Post(self.url,self.reqBody,self.token,self.onCancelSuccess,self.onCancelError);}
site.factory.trackData('SHOWMAX-CANCEL-REQ',self.reqBody,null);}
self.onCancelSuccess=function(data){console.log('Showmax ATB : On Cancel Success');self.showmaxGenericError=false;$("#showmaxoverlay").fadeOut(300);if(data&&data.statusCode==200){self.showmaxConfirmCancel=false;self.showmaxCancelled=true;}
else{}
self.update();app.forceReload=true;self.GetAmountToPayAndSubscription();site.factory.trackData('SHOWMAX-CANCEL-RES',null,data);}
self.onCancelError=function(err){console.log('Showmax ATB : On Cancel Error');$("#showmaxoverlay").fadeOut(300);self.showmaxConfirmCancel=false;self.showmaxGenericError=true;self.cancelError=true;self.update();}
self.onShowmaxReconnect=function(){console.log('Showmax : Initiating Showmax Reconnect');self.payReconnect=true;$("#showmaxoverlay").fadeIn(300);self.reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"smartCardNumber":self.smartcardForShowmax.SerialNumber,"customerNumber":app.customernumber,"packageName":self.smartcardForShowmax.primaryService.serviceName}
if(dstvApp.EnableSecurityAuth){self.url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v1/Showmax/Reconnect`;site.factory.Post(self.url,self.reqBody,null,self.onReconnectSuccess,self.onReconnectError,false,false,true,true);}else{site.factory.GetJWT().then(function(token){self.url=dstvApp.DSOAPIUrl+`/apishowmax/api/v1/Showmax/Reconnect`;site.factory.Post(self.url,self.reqBody,self.token,self.onReconnectSuccess,self.onReconnectError);});}
site.factory.trackData('SHOWMAX-RECONNECT-REQ',self.reqBody,null);}
self.onReconnectSuccess=function(data){console.log('Showmax ATB : On Reconnect Success');$("#showmaxoverlay").fadeOut(300);self.showmaxGenericError=false;self.showmaxUpgradeSection=false;self.freeShowmaxSection=false;self.showmaxActivated=true;self.update();app.forceReload=true;self.GetAmountToPayAndSubscription();site.factory.trackData('SHOWMAX-RECONNECT-RES',null,data);}
self.onReconnectError=function(err){console.log('Showmax ATB : On Reconnect Error');$("#showmaxoverlay").fadeOut(300);self.reconnectError=true;self.showmaxGenericError=false;self.showmaxUpgradeSection=false;self.freeShowmaxSection=false;if(err.responseJSON.StatusCode==422){console.log(err.responseJSON.Message);self.showmaxGenericError=true;}
else if(err.responseJSON.StatusCode==402){var res=err.responseJSON.Message.split('\\');res=JSON.parse(res);self.dueAmount=res.Payment.Amount;self.currency=res.Payment.Currency;self.DualCurrency=res.LocalCurrency?res.LocalCurrency.Currency:null;self.DualCurrencydueAmount=res.LocalCurrency?res.LocalCurrency.Amount:null;self.message=res.ResponseMessage;self.showmaxPrice=app.showmaxAddOnDetails?(app.showmaxAddOnDetails.price?app.showmaxAddOnDetails.price.value:null):null;if(app.dualCurrencyApplicable)
self.showmaxPrice=app.showmaxAddOnDetails&&app.dualCurrencyApplicable?(app.showmaxAddOnDetails.localPrice?app.showmaxAddOnDetails.localPrice.amount:null):null;self.update();let smartcard=app.smartcard;window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{reconnect:true,amount:self.dueAmount,currency:self.currency,dualCurrencyAmount:self.DualCurrencydueAmount,dualcurrency:self.DualCurrency,message:self.message,showmaxPrice:self.showmaxPrice,smartcardNumber:smartcard});}
else{self.showmaxGenericError=true;}
self.update();}
self.onUpgradeShowmaxATB=function(){let packageName=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0].primaryService?app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0].primaryService.serviceName:null;app.showmaxUpgradeReq=true;window.SessionSave("app",app);window.HandleActiveTab("showChangePackage");riot.mount('tag-change-package-service',{showmodal:true,showmaxATBUpgrade:true,smartcard:app.smartcard,packageName:packageName});}
self.onChangePackage=function(){let packageName=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0].primaryService?app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0].primaryService.serviceName:null;window.HandleActiveTab("showChangePackage");riot.mount('tag-change-package-service',{changePackage:true,showmodal:true,smartcard:app.smartcard,packageName:packageName});}
self.onDashManageShowmax=function(){console.log('Showmax : Initiating Manage section');$('#showmaxModel').modal('show');self.showmaxManage=true;}
self.onShowmaxATBFeedback=function(){if(app.isVIVR){window.close();return;}
site.factory.CaptureFeedback('HELPDEACTIVATESHOWMAX_'+app.customernumber);self.showmaxCancelled=false;self.PackageReloadRequired=false;$('#showmaxModel').modal('hide');self.update();app.forceReload=true;window.HandleActiveTab("showAccount");}
self.onShowmaxCancel=function(){site.factory.CaptureFeedback('DSTVSHOWMAXSURVEY'+ +app.customernumber);window.HandleActiveTab("showAccount");}
self.onShowmaxATBActivationFeedback=function(){if(app.isVIVR){window.close();return;}
if(app.isNotPrimePackage){site.factory.CaptureFeedback('DSTVSHOWMAXACTIVE_'+app.customernumber);}else{site.factory.CaptureFeedback('DSTVSHOWMAXACTIVEPRM_'+app.customernumber);}
self.showmaxActivated=true;self.PackageReloadRequired=false;$('#showmaxModel').modal('hide');self.update();app.forceReload=true;window.HandleActiveTab("showAccount");}
self.onCreateShowmaxAccount=function(){console.log('Showmax : Initiating Showmax Create Account');self.reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"smartCardNumber":self.smartcardForShowmax.SerialNumber,"customerNumber":app.customernumber}
if(app.showmaxEmail&&app.showmaxEmailSig){if(dstvApp.EnableSecurityAuth){self.url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v2/Showmax/GetOrCreateSubscription?email=${app.showmaxEmail}&signature=${app.showmaxEmailSig}`;site.factory.Post(self.url,self.reqBody,null,self.onCreateAccountSuccess,self.onCreateAccountError,false,false,true,true);}else{self.url=dstvApp.DSOAPIUrl+`/apishowmax/api/v2/Showmax/GetOrCreateSubscription?email=${app.showmaxEmail}&signature=${app.showmaxEmailSig}`;site.factory.Post(self.url,self.reqBody,self.token,self.onCreateAccountSuccess,self.onCreateAccountError);}}
site.factory.trackData('SHOWMAX-GETORCREATESUBSCRIPTION-REQ',self.reqBody,null);}
self.onCreateAccountSuccess=function(data){console.log('Showmax : On Showmax Create Account Success');$("#showmaxoverlay").fadeOut(300);self.showmaxGenericError=false;clearInterval(self.animationInterval);self.showShowmaxProgress=false;self.showmaxActivated=true;self.update();if(data){console.log('Success Createaccount version 2: '+data);}
site.factory.trackData('SHOWMAX-GETORCREATESUBSCRIPTION-RES',null,data);}
self.onCreateAccountError=function(err){console.log('Showmax : On Showmax Create Account Error');$("#showmaxoverlay").fadeOut(300);self.showmaxActivated=false;self.freeShowmaxSection=false;self.showmaxUpgradeSection=false;clearInterval(self.animationInterval);self.showShowmaxProgress=false;self.createAccError=true;self.showmaxGenericError=true;app.forceReload=true;self.update();}
self.onProcessPayment=function(){window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{showmaxPayment:true,amount:self.dueAmount});}
self.onBack=function(){if(opts.changePackageCancelShowmax){self.showmaxConfirmCancel=false;$('#changepackageModal').modal('show');}
else{self.showmaxConfirmCancel=false;self.showmaxManage=true;}
self.update();}
self.onCancel=function(){if(app.isVIVR){window.close();return;}
app.forceReload=true;window.HandleActiveTab("showAccount");}
self.onTryAgain=function(){if(self.createAccError){console.log('Showmax : Initiating account creation on Try Again');self.showmaxGenericError=false;self.showShowmaxProgress=true;self.update();self.animateShowmaxActivate();site.factory.Post(self.url,self.reqBody,self.token,self.onCreateAccountSuccess,self.onCreateAccountError);}
else if(self.captureError||self.cancelError||self.reconnectError){console.log('Showmax : Initiating Showmax activation/cancel/reconnect on Try Again');$("#showmaxoverlay").fadeIn(300);let successCallback=self.captureError?self.onCaptureSuccess:self.cancelError?self.onCancelSuccess:self.onCreateAccountSuccess;let errorCallback=self.captureError?self.onCaptureError:self.cancelError?self.onCancelError:self.onCreateAccountError;site.factory.Post(self.url,self.reqBody,self.token,successCallback,errorCallback);}}
self.GetAmountToPayAndSubscription=function(){self.PackageReloadRequired=true;console.log('Fetch Amount to Pay : fetch amount to pay...')
if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,null,self.onGetAmountToPaySuccess,self.onGetAmountToPayError,false,true,true)}else{let url=`${dstvApp.DSOAPIUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,self.token,self.onGetAmountToPaySuccess,self.onGetAmountToPayError)}}
self.onGetAmountToPaySuccess=function(data){console.log('Fetch Amount to Pay : fetch amount to pay completed')
app.paymentduedetails.properties.dueDate={value:data.DueDate.split('T')[0]};app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.Value*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.CurrencyCode}
app.BOAccount=data.Accounts.filter(x=>x.AccountType=="Box Office")[0];app.IsBOCustomer=app.BOAccount&&Object.keys(app.BOAccount).length>0
app.accounts=data.Accounts.map(x=>({AccountNumber:x.AccountNumber,AccountType:x.AccountType}))
app.accountsInfo=data.Accounts;app.primaryaccountnumber=data.Accounts.filter(x=>x.IsDefault)[0].AccountNumber;window.SessionSave("app",app);self.update();}
self.onGetAmountToPayError=function(err){console.log('Fetch Amount to Pay : error while fetching amount to pay')}
self.getViewSubscriptionData=function(){$("#showmaxoverlay").fadeIn(300);if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,null,self.viewSubscriptionSuccess,self.viewSubscriptionError,false,false,true,true);}else{let url=dstvApp.DSOAPIUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,self.token,self.viewSubscriptionSuccess,self.viewSubscriptionError);}}
self.viewSubscriptionSuccess=function(data){$("#showmaxoverlay").fadeOut(300);app.viewSubscriptionResponse=data;self.packageLoaded=true;self.packages=data.map((package)=>{if(package.isPrimarySc){app.viewingDaysLeft=package.viewingDaysLeft}
if(package.services!==null){if(package.services.length>1)
package.services=package.services.sort(function(x,y){return x.psnr-y.psnr})
primaryService=package.services.filter((service)=>{serviceName=service.serviceName.split('-');if(service.serviceName.includes('-')){serviceName=service.serviceName.split('-');}
else if(service.serviceName.toUpperCase().includes('SHOWMAX')){serviceName[0]=service.serviceName.toUpperCase().trim().substring(0,7).trim();serviceName[1]=service.serviceName.toUpperCase().trim().substring(15,7).trim();}
service.productCode=serviceName[0].trim();let pckNameArray=packageName=serviceName[1].toLowerCase().replace('dstv','').trim().split(' ')
service.productName=pckNameArray[0];if(serviceName[1].includes('+')){service.productName=pckNameArray[0].trim().substr(0,pckNameArray[0].trim().indexOf(' '))+'-'+pckNameArray[1].trim().substr(0,pckNameArray[1].trim().indexOf(' '));}
service.productName+=packageName[1]=='plus'?'plus':'';service.productName=service.productName.replace("'","");service.hideAddonLinkClass=service.status=="Active"?'':' visibility-hidden';currentPackageFullName=service.serviceName;return service.type=='Principal'});if(primaryService.length>1)
primaryService=primaryService.filter((service)=>{return service.status=='Active'})
primaryService=primaryService[0];if(primaryService!=undefined||primaryService!=null){app.CardStatus=primaryService.status;app.MonthlyPrice=primaryService.price;app.ProductCode=primaryService.productCode;app.currentPackageFullName=primaryService.serviceName;if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))
app.MonthlyPriceDualCurrency=primaryService.localPrice?primaryService.localPrice.amount:null;}
addonServiceList=package.services.filter((service)=>{return(service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on'))&&service.status=='Active'});addonService=package.services.filter((service)=>{return service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on')})[0];addonService=addonService&&addonService.status=='Active'?(addonService.serviceName||addonService.description):'N/A';app.AddOnService=addonService;app.SmartCardNumber=package.smartcardNumber;window.SessionSave("app",app);}
return{SerialNumber:package.smartcardNumber,SmartcardName:package.smartcardName,primaryService:primaryService,addonService:addonService,Status:package.Status,psnr:package.psnr,serviceId:package.serviceId,isPrimarySmartcard:package.isPrimarySc,isXtraView:package.isXtraView};})
app.smartcards=self.packages;window.SessionSave("app",app);self.updatePackageData();}
self.updatePackageData=function(){if(app.smartcards&&app.smartcards.length>0){self.smartcardForShowmax=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard);self.dstvPremium=self.smartcardForShowmax.some(x=>x.primaryService.productName.includes("premium"));self.smartcardForShowmax=self.smartcardForShowmax[0];if(self.smartcardForShowmax){self.smartcardForShowmaxName=self.smartcardForShowmax.primaryService.serviceName.split('-')[1].trim();self.smartcardForShowmaxCode=self.smartcardForShowmax.primaryService.productCode;self.smartcardForShowmaxPrice=self.smartcardForShowmax.primaryService.price;self.smartcardForShowmaxDualCurrencyPrice=self.smartcardForShowmax.primaryService.localPrice;}
self.update();}}
self.viewSubscriptionError=function(err){$("#showmaxoverlay").fadeOut(300);}
self.onShowmaxSignIn=function(){let signInUrl=site.env=='PROD'?self.showmaxSignInUrl:`https://${dstvApp.ShowmaxTestUsername}:${dstvApp.ShowmaxTestPassword}@secure.showmax.io/v134.0/dstv${dstvApp.countryabbreviation}/signin?redirect_uri=${window.location.origin}${window.culture}/mydstv-account&client_id=${dstvApp.clientIdShowmax}`;let utm=`&utm_source=${window.location.hostname}&utm_medium=referral&utm_campaign=selfservicedashboard`;window.location.href=signInUrl+utm;}
self.onShowmaxConfirm=function(){self.showmaxConfirm=true;self.showShowmaxAtb=false;self.update()}
self.onShowmaxSignUp=function(){let signUpUrl=site.env=='PROD'?self.showmaxSignUpUrl:`https://${dstvApp.ShowmaxTestUsername}:${dstvApp.ShowmaxTestPassword}@secure.showmax.io/v134.0/dstv${dstvApp.countryabbreviation}/signup?redirect_uri=${window.location.origin}${window.culture}/mydstv-account&client_id=${dstvApp.clientIdShowmax}`;let utm=`&utm_source=${window.location.hostname}&utm_medium=referral&utm_campaign=selfservicedashboard`;window.location.href=signUpUrl+utm;}
self.preventBrowserBack=function(){window.history.pushState(null,"",window.location.href);window.onpopstate=function(){window.history.pushState(null,"",window.location.href);};}
self.goToShowmax=function(){let showmaxUrl=site.env=='PROD'?self.showmaxWebsiteLink:`https://${dstvApp.ShowmaxTestUsername}:${dstvApp.ShowmaxTestPassword}@secure.showmax.io`;window.open(showmaxUrl,'_blank');self.onShowmaxATBActivationFeedback();app.forceReload=true;window.HandleActiveTab('showAccount');}
self.goToAccount=function(){if(app.isVIVR){window.close();return;}
app.forceReload=true;window.HandleActiveTab('showAccount');}
self.playVideo=function(){self.showPlayButton=false;self.update();self.vPlayerAction('PLAY');}
self.vPlayerAction=function(action){let vPlayer=$('#videoPlayer')[0];let promise;try{switch(action){case 'PAUSE':promise=vPlayer.pause();break;case 'PLAY':promise=vPlayer.play();break;case 'LOAD':promise=vPlayer.load();break;}
if(promise!==undefined){promise.then(_=>{}).catch(error=>{});}}
catch(e){console.log('Unable to pause video player');}}});