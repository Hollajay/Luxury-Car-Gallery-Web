riot.tag2('tag-self-service-dashboard','<div class="modal fade dashboardModal view-sub-add-onns sreamingPopupDash" data-keyboard="false" data-backdrop="static" id="showMaxPopup" role="dialog" if="{!app.isDVSJourney && dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)}"> <div class="webform container modal-dialog modal-lg feedback-dialog"> <div class="modal-content"> <div class="modal-body"><tag-showmax-ott-card if="{!app.isDVSJourney && dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)}"></tag-showmax-ott-card></div></div></div></div><div if="{!app.isDVSJourney}" class="container"><div class="navDiv main-menu"><div class="row"><div class="col-md-6 pull-right newMenu"><nav class="navbar navbar-inverse"><div class="class=" navbar-collapse="" js-navbar-collapse="" collapse="" in=" " aria-expanded="true"><ul class="nav navbar-nav pull-right " style="display: flex;"><li class="dropdown mega-dropdown"> <a href="javascript:void(0);" class="main-menu-account " onclick="{OnMenuClick}" action="showAccount">{langTranslateApp.loginAccount}</a> </li><li if="{!app.isCurrDVSSmartcard}" class="dropdown mega-dropdown"> <a href="javascript:void(0);" class="main-menu-fix" onclick="{OnMenuClick}" action="showFixError">{langTranslateApp.fix}</a> </li><li class="dropdown mega-dropdown"> <a href="javascript:void(0);" class="main-menu-pay " onclick="{OnMenuClick}" action="showPayment">{langTranslateApp.menuPay}</a> </li><li class="dropdown mega-dropdown"> <a href="javascript:void(0);" class="main-menu-change " onclick="{OnMenuClick}" action="showChangePackage">{langTranslateApp.dashChangeWord}</a> </li><li class="dropdown mega-dropdown"> <a href="javascript:void(0);" class="main-menu-more " onclick="{OnMenuClick}" action="showMore">{langTranslateApp.dashMoreWord}</a> </li></ul></div></nav></div><div class="footer-menu-navigation-icons"><a href="javascript:void(0);" class=" " onclick="{OnMenuClick}" action="showAccount"><div class="iconDiv"><i class="icon icon-icon-dashboard"></i></div><div>{langTranslateApp.loginAccount}</div></a><a href="javascript:void(0);" class=" " onclick="{OnMenuClick}" action="showFixError"><div class="iconDiv"><i class="icon icon-icon-fix-errors"></i></div><div>{langTranslateApp.fix}</div></a><a href="javascript:void(0);" class="menu-active " onclick="{OnMenuClick}" action="showPayment"><div class="iconDiv"><i class="icon icon-icon-payment"></i></div><div>{langTranslateApp.menuPay}</div></a><a href="javascript:void(0);" class=" " onclick="{OnMenuClick}" action="showChangePackage"><div class="iconDiv"><i class="icon icon-icon-change-package"></i></div><div>{langTranslateApp.dashChangeWord}</div></a><a href="javascript:void(0);" class=" " onclick="{OnMenuClick}" action="showMore"><div class="iconDiv"><i class="icon icon-icon-more"></i></div><div>{langTranslateApp.dashMoreWord}</div></a></div></div></div><tag-account-service if="{showAccount}"></tag-account-service><tag-fix-errors-service if="{showFixError}"></tag-fix-errors-service><tag-clear-error-codes if="{showFixError}"></tag-clear-error-codes><tag-dashboard-payments if="{showPayment}"></tag-dashboard-payments><tag-change-package-service if="{showChangePackage}"></tag-change-package-service><tag-more-service if="{showMore}"></tag-more-service><tag-transaction-history if="{showMore}"></tag-transaction-history><tag-dash-boxoffice if="{showMore}"></tag-dash-boxoffice><tag-update-user-details if="{showMore}"></tag-update-user-details><tag-self-service-ciam if="{showMore}"></tag-self-service-ciam><tag-showmax-atb if="{showMore}"></tag-showmax-atb><tag-buy-airtime if="{showMore}"></tag-buy-airtime><tag-dash-premium-status if="{showChangePackage}"></tag-dash-premium-status><div id="more-tab-showmax-section" class="upgradeShowmax content-wrapper"><button type="button" class="payment-close icon-Close_M" onclick="{backshow}"></button><div class="showmax-wrapper"><tag-showmax-card></tag-showmax-card></div></div></div><tag-dash-dvs></tag-dash-dvs>','','',function(opts){var self=this;self.notDualCurrency=false;self.hideChangePackage=!dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(dstvApp.countryabbreviation=='mu')
{self.notDualCurrency=true;}
if(!app.loggedin&&!app.isDVSJourney){riot.mount('tag-sign-in');return;}
self.on('mount',function(){if(app.isDVSJourney||app.watchNowRedirect){return;}
if(opts.showAccount)
self.HandleActiveTab('showAccount');if(opts.showmaxPayment){self.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{showmaxPayment:true,amount:opts.amount});}
if(opts.paySuccessCreateAccount){self.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{paySuccessCreateAccount:true,showComponent:true});}
self.InitialSetup();});self.InitialSetup=function(){self.showShowmaxSection=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);if(app.loginUrlHasQueryString&&app.loginUrlQueryString.includes("showmax")&&!app.isShowmaxCardLoaded&&self.showShowmaxSection){riot.mount('tag-showmax-card',{showComponent:true});}else if(app.isVIVR&&!app.ssActiveTab){self.HandleActiveTab('showChangePackage');}else{app.ssActiveTab?self.HandleActiveTab(app.ssActiveTab):self.HandleActiveTab('showAccount');if(app.showShowmaxPopup){riot.mount('tag-showmax-ott-card',{showComponent:true});app.showShowmaxPopup=false}
$('#more-tab-showmax-section').hide();}
$('#newLogoutLink').click(function(){site.trigger('logout');if(app.isVIVR){window.location.href=dstvApp.SignInURL;}
else window.location.href=dstvApp.SignInURL+location.search;})
app.connectingip=$('#connectingip').val();window.SessionSave("app",app);self.update();}
self.OnMenuClick=window.OnMenuClick=function(actionLink){let action='';if(actionLink.currentTarget)
action=actionLink.currentTarget.getAttribute('action');else
action=actionLink.getAttribute('action')
if(action=='showChangePackage'){self.hideChangePackage=dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(self.hideChangePackage){site.factory.ShowModelPopup('success','','Option for change of package is currently not available online. Please call us on the 4668585 or send an email to DStvcustomerservice@vitiro.org','',false,true);return;}}
if(app.customerDetails.IsSpecialistCustomer){let isPaymentAllowed=app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.length
if(isPaymentAllowed){if((app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.find(q=>q.type=="Principal").status!='Active')&&(action=='showPayment'||action=='showChangePackage')){site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}
if(action=='showFixError'&&app.isCurrDVSSmartcard){window.open(dstvApp.DstvNowURL,'_blank');return;}
if(app.ssActiveTab!=action)
self.HandleActiveTab(action)}
self.backshow=function(){window.HandleActiveTab('showMore')
$('tag-more-service').show();}
self.HandleActiveTab=window.HandleActiveTab=function(action){if(app.viewSubscriptionResponse)
if(app.customerDetails.IsSpecialistCustomer&&!app.boPayment){let isPaymentAllowed=app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.length
if(isPaymentAllowed){if((app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.find(q=>q.type=="Principal").status!='Active')&&(action=='showPayment'||action=='showChangePackage')){site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}
$('#more-tab-showmax-section').hide();$('a[action]').removeClass('active-tab')
$('a[action="'+action+'"]').addClass('active-tab')
if(app.isVIVR&&(action.toLowerCase()=='showpayment'||action.toLowerCase()=='showmore')){$('.main-menu').find('ul>li>a').parent().hide();$($('.footer-menu-navigation-icons')[0]).find('a:not(.active-tab)').hide();$($('.footer-menu-navigation-icons')[1]).find('a:not(.active-tab)').hide();}
self.showAccount=false;self.showFixError=false;self.showPayment=false;self.showChangePackage=false;self.showMore=false;self[action]=true;app.ssActiveTab=action;window.SessionSave("app",app);self.update();$('html, body').animate({scrollTop:20},1000);if(app.ssActiveTab=='showAccount'){jQuery("body").addClass('myTestClass')}
else{jQuery("body").removeClass('myTestClass')}
if(app.ssActiveTab=='showFixError'){jQuery("body").addClass('FixError')}
else{jQuery("body").removeClass('FixError')}
if(app.ssActiveTab=='showChangePackage'){jQuery("body").addClass('ChangePackageFullPage')}
else{jQuery("body").removeClass('ChangePackageFullPage')}
if(app.ssActiveTab=='showMore'){jQuery("body").addClass('ShowmaxFullPage')}
else{jQuery("body").removeClass('ShowmaxFullPage')}}
window.RedirectTargetOrgin=function(e,url){if(url){performRedirection(url)
return;}
else{e.preventDefault();e.stopImmediatePropagation()
if(e.currentTarget.attributes["AlertMessageAction"]){var action=e.currentTarget.attributes["AlertMessageAction"].value
if(!action.includes('External')){performAction(action);return;}}
if(e.currentTarget.href.includes(window.location.origin)){let urlPath=e.currentTarget.getAttribute('href');performRedirection(urlPath);return;}
else{window.open(e.currentTarget.href,"_blank");}}
function performRedirection(url){if(url.startsWith(window.culture))
window.open(dstvApp.targetDomain+url,"_blank");else
if(!url.includes(dstvApp.targetDomain))
window.open(url,"_blank");else
window.open(dstvApp.targetDomain+window.culture+url,"_blank");}
function performAction(str){str=str.toUpperCase();console.log(str)
switch(str){case 'SELF SERVICE - PAY NOW':window.HandleActiveTab("showPayment");break;case 'SELF SERVICE - SHOWMAX':window.HandleActiveTab("showMore");$('#more-tab-showmax-section').show();riot.mount('tag-showmax-card',{showComponent:true});break;case 'SELF SERVICE - FIX ERROR':window.HandleActiveTab("showFixError");break;case 'SELF SERVICE - RENT MOVIES':window.HandleActiveTab("showMore");riot.mount('tag-dash-boxoffice',{showComponent:true});break;case 'SELF SERVICE - UPDATE DETAILS':window.HandleActiveTab("showMore");riot.mount('tag-update-user-details',{showComponent:true});break;case 'SELF SERVICE - CHANGE PACKAGE':window.HandleActiveTab("showChangePackage");break;case 'SELF SERVICE - ADD MOVIES':if(app.primaryPackageDisconnected){window.HandleActiveTab("showPayment");}
else if(!app.primaryPackageDisconnected&&!app.isMovieAddonAdded&&!app.isMovieAddonActive){window.HandleActiveTab("showChangePackage");riot.mount('tag-change-package-service',{linkMovieAddon:true});}else if(!app.primaryPackageDisconnected&&app.isMovieAddonAdded&&!app.isMovieAddonActive){window.HandleActiveTab("showPayment");}
break;default:break}}}})
riot.tag2('tag-account-service','<section class="user-profile-section clearfix"> <div class="col-md-5"> <div class="col-md-12 user-profile-dtls"> <div class="user-profile-dtls-inner"> <div style="padding: 0px 10px 5px 10px; position: relative;"> <a class="edit-user" href="javascript:void(0)" onclick="{onEditClick}"> <span class="details_edit"> <img src="/media/8619/materialicon-1.svg" class="details_edit_iocn"> </span> </a> <div class="profile-picture-box"> <div class="profile-pic"><img src="/media/11090/user-default.jpg" alt="Profile Picture" /></div> </div> <div class="profile-details clearfix"> <h3>{langTranslateApp.loginWelcome}</h3> <h2>{app.customername}</h2> </div> </div> <div if="{isPremiumStatusApplicable && !app.noServicesLoaded}" class="progressBar"><progress id="premStatusBar" value="{app.score}" max="100"></progress></div> <div if="{isPremiumStatusApplicable && !app.noServicesLoaded}" class="premium-bx-top"> <div class="row"> <div class="" if="{!app.subsStatusLoaded}"> <div class="loading-loader loading" style="z-index: 999;"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.premiumStatusLoading}...</div> </div> </div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 text-left"> <div if="{!primaryPackageDisconnected}" class="title">{langTranslateApp.premiumStatusSubTitle1}<br>{langTranslateApp.premiumStatusSubTitle2}</div> </div> <div if="{primaryPackageDisconnected}" class="col-lg-8 col-xs-8 col-sm-8 text-left"> <div class="title title-two">{langTranslateApp.premiumStatusTitle1}</div> </div> <div if="{!primaryPackageDisconnected}" class="col-lg-4 col-xs-4 col-sm-4 text-left"> <div class="icon-status"> <div class="icon-bx-top"> <div class="icon-ppremium {app.subsStatus.activePremiumClass}"></div> <div class="icon-streaming {app.subsStatus.dstvNowPlayClass}"></div> <div if="{isShowMaxApplicable}" class="icon-showmax {app.subsStatus.showmaxPlayClass}"></div> <div if="{!app.isLiberia}" class="icon-bxoffice {app.subsStatus.boxOfficeRentalClass}"></div> <div class="icon-explore {app.subsStatus.exploraClass}"></div> <div class="icon-pvr {app.subsStatus.pvrClass}"></div> </div> <div class="clearfix"></div> </div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 text-left premium-bx-top-last"> <a id="findOutMore" action="findoutmore" if="{!primaryPackageDisconnected && !app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onFindOutMore}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusFindOutMore}</span></span></div> </a> <a id="upgrade" action="upgrade" if="{app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onUpgradeNow}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusUpgradeNow}</span></span></div> </a> <a id="reconnect" action="reconnect" if="{primaryPackageDisconnected && !app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onReconnectNow}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusReconnectNow}</span></span></div> </a> </div> </div> </div> </div> </div> </div> <div class="col-md-7"> <div class="row"> <div if="{app.noServicesLoaded}" class="col-sm-6 unactive-package"> <div class="top-package-card package-box"> <div class="" if="{!app.packageLoaded}"> <div class="loading-loader loading" style="z-index: 999;"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.dashPkgLoading}...</div> </div> </div> </div> <div class="package-box-top clearfix"> <div class="package-box-top-left pull-left"><i class="icon-pack icon-dstv-logo"></i></div> <div class="package-box-top-right pull-right"><span id="status" if="{dstvApp.language == \'English\'}">{app.currentSmartcardPackage.primaryService.status}</span> <span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Pending\'}">Pendente</span><span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Active\'}">Activo</span> <span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Disconnected\'}">Desconectado</span><img class="icon-background-img" src="/media/8268/icon-tick.svg" class="icon-background-img" if="{app.currentSmartcardPackage.primaryService.status == \'Active\'}"></div> </div> <div class="package-box-bottom"> <div class="row"> <div class="col col-xs-9"> <div class="package-price-label">{langTranslateApp.dashYouCurrentlyHave}</div> <div class="package-price-value">{langTranslateApp.dashNoActivePackage}</div> </div> <div class="col col-xs-3 text-center warning-icon"> <div class="iconDiv"><i class="icon icon-icon-fix-errors"></i></div> </div> <div class="clearfix"></div> </div> </div> </div> </div> <div if="{!(app.noServicesLoaded)}" class="col-sm-6"> <div class="top-package-card package-box"> <div class="" if="{!app.packageLoaded}"> <div class="loading-loader loading" style="z-index: 999;"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.dashPkgLoading}...</div> </div> </div> </div> <div class="package-box-top {app.currentSmartcardPackage.primaryService.productName} clearfix"> <div class="package-box-top-left pull-left"> <i class="icon-pack icon-{app.currentSmartcardPackage.primaryService.productCode}"></i> </div> <div if="{app.isCurrDVSSmartcard}" class="blur-img"><img src="/media/11918/streaming-icon.svg" alt="" class="blur live-stream-img"><span class="icon icon-streaming-no-circle"></span></div> <div class="package-box-bottom-right-bottom-movie-add-on {app.isCurrDVSSmartcard}"><a href="javascript:void(0)" onclick="{OnPackageCardViewSubscriptions}"> <span class="viewall movie-add-on"><span class="view-sub">{langTranslateApp.view}</span> {langTranslateApp.subscriptions}</span> <span class="iconDiv"><i class="icon icon-icon-circlearrow-right"></i></span> </a></div> </div> <div class="package-box-bottom"> <div class="package-box-bottom-left"> <div class="package-price-label">{langTranslateApp.accountcardpackageprice}</div> <div if="{!app.dualCurrencyApplicable && !app.isMauritius}" class="package-price-value text-uppercase">{dstvApp.countrycurrency+" "+app.currentSmartcardPackage.primaryService.price || 0.00}</div><div if="{!app.dualCurrencyApplicable && app.isMauritius}" class="package-price-value text-uppercase">{dstvApp.countrycurrency+" "+app.currentSmartcardPackage.primaryService.localPrice.amount || 0.00}</div><div if="{app.dualCurrencyApplicable}" class="package-price-value text-uppercase">{dstvApp.countrycurrency+" "+app.currentSmartcardPackage.primaryService.localPrice.amount || 0.00}</div> </div> <div class="package-box-bottom-right"> <div class="package-box-top-right-top"> <span id="status" if="{dstvApp.language == \'English\'}">{app.currentSmartcardPackage.primaryService.status}</span> <span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Pending\'}">Pendente</span><span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Active\'}">Activo</span><span class="icon-icon-warning" if="{app.currentSmartcardPackage.primaryService.status == \'Disconnected\'}"></span> <span id="status" if="{dstvApp.language == \'Portuguese\' && app.currentSmartcardPackage.primaryService.status == \'Disconnected\'}">Desconectado</span><img class="icon-background-img" src="/media/8268/icon-tick.svg" class="icon-background-img" if="{app.currentSmartcardPackage.primaryService.status == \'Active\'}"></div> <div class="package-box-bottom-right-bottom"><a href="javascript:void(0)" onclick="{PackageCardChangePackage}"> <span class="viewall"><strong>{langTranslateApp.dashChangeWord}</strong> {langTranslateApp.dashfixerrorPackage}</span> <span class="iconDiv"><i class="icon icon-icon-change-package icon-change-package"></i></span> </a></div> </div> </div> </div> </div> <div class="col-sm-6"> <div class="top-package-card decoder-box dropdown"> <div class="" if="{!app.packageLoaded}"> <div class="loading-loader loading" style="z-index: 999;"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.dashSmartcardLoading}...</div> </div> </div> </div> <div if="{!app.isCurrDVSSmartcard}" class="decoder-box-top"> <img src="/media/8291/explora.png" alt="Decoder Explora Image" class="decoder-img" /> <div class="decoder-title">Explora</div> </div> <div if="{app.isCurrDVSSmartcard}" class="decoder-box-top"> <span class="icon-streaming-circle"></span> <img src="/media/11918/streaming-icon.svg" alt="Decoder Explora Image" class="live-stream-img"> <div class="decoder-title">Digital Smartcard</div> </div> <div class="decoder-box-bottom smart-card-number"> <div class="decoder-number-label">{langTranslateApp.dashChangePackageSmartcardNumber}</div> <div if="{app.smartcards.length == 1}" class="decoder-number-value">{app.currentSmartcardPackage.SerialNumber}</div> <div if="{app.smartcards.length > 1}" class="decoder-number-value"> <div class="form-group"> <fieldset> <select type="text" class="form-control" id="ddlSmartcards" name="" onchange="{onSmartcardDropdownChange}"> <option if="{app.smartcards}" each="{smartcard, index in app.smartcards}" id="{smartcard.SerialNumber}" class="custom-class-{smartcard.isDvsSc}" value="{smartcard.SerialNumber}" selected="{smartcard.SerialNumber==app.smartcard}"> <div>{smartcard.SerialNumber} <span if="{smartcard.isDvsSc}" class="icon-stream-cards"> </span> <span if="{!smartcard.isDvsSc}" class="icon-dth-cards"> </span> </div> </option> </select> </fieldset> </div> </div> <a if="{!app.isCurrDVSSmartcard}" class="btn btn-upgrade dropdown-top" href="{dstvApp.dstvUrl}/{window.culture}/" target="_blank">{langTranslateApp.dashBuyDecoders}<span class="iconDiv"><i class="icon icon-icon-supermarket"></i></span></a> <a if="{app.smartcards && !app.isCurrDVSSmartcard && isDvsApplicable}" class="btn btn-upgrade dropdown" onclick="{OnGetStreamingLive}"> <span class="streaming-account">{langTranslateApp.GetNewtxt}</span> <span class="streaming-account-bottom">{langTranslateApp.Streamtxt}</span> <span class="iconDiv"> <div class="icon icon-icon-live-stream"></div> </span> </a> </div> </div> </div> </div> </div></section><section if="{app.noServicesLoaded}" class="package-unactive-section clearfix"> <div class="col-sm-1 text-center"> <div class="iconDiv"><i class="icon icon-icon-fix-errors"></i></div> </div> <div class="col-sm-7 package-unactive-text">{langTranslateApp.dashNoServiceMessage1}. {langTranslateApp.transHistoryPlease} {langTranslateApp.dashNoServiceMessage2} {langTranslateApp.dashNoServiceMessage3}.</div> <div class="col-sm-4 text-center"><a href="{dstvApp.ContactUsURL}" onclick="{window.RedirectTargetOrgin}" class="btn anim-btn btn-white btn-bordered custom-button-headers">{langTranslateApp.subMenuContactUs}</a></div> <div class="clearfix"></div></section><!--<section if="{app.alertsAndMessages && app.showAlertsAndMessages}" id="cms-message" class="{messageType} generic-alert-section clearfix"> <span if="{app.alertImage}" id="close-message" class="close-message1"></span> <div if="{app.alertImage}" class="image-header minimize" style="background:url({alertImage});background-position: center {imgAlign}"><a if="{trailerLink}" href="{trailerLink}" target="_blank"></a></div> <div class="col-sm-1 text-center"> <div class="iconDiv"><i class="icon icon-icon-info"></i></div> </div> <div class="col-sm-7 generic-alert-text"> <tag-raw content="{alertsAndMessages}"></tag-raw> </div> <div class="col-sm-4 text-center"><a href="{buttonLink}" onclick="{window.RedirectTargetOrgin}" AlertMessageAction="{app.selfServiceAction}" class="btn anim-btn btn-white btn-bordered custom-button-headers">{buttonText}</a></div> <div class="clearfix"></div></section>--><section class="paynow-fixerror-section clearfix"> <div class="col-sm-10 clearfix"> <section class="pay-now-section clearfix"> <div class="row"> <div class="col-xs-7 col-sm-9"> <div class="row"> <div class="col-sm-7 package-balance-dtls"> <div class="currencyToggle pull-left"><label class="switch"><input onclick={onCurrencyToggle} class="switch-input" type="checkbox" checked /> <span class="switch-label" data-on="USD" data-off="ETB"></span> <span class="switch-handle"></span> </label></div> <span class="currency-sign text-uppercase">{dstvApp.countrycurrency}</span> <span if="{!app.dualCurrencyApplicable}" class="available-balance"> {app.paymentduedetails.properties.amountToPay.value || 0.00}</span> <span if="{app.dualCurrencyApplicable}" class="available-balance"> {app.paymentduedetails.properties.amountToPayEtb.value || 0.00}</span> <br> <span if="{dstvApp.country == \'angola\'}">{langTranslateApp.angolaJVText}</span> </div> <div class="col-sm-5 package-recharge-dtls"> <div>{langTranslateApp.balNextPayDate} <span class="text-uppercase">{site.factory.GetEazyDateFormat(app.paymentduedetails.properties.dueDate.value)}</span></div> <div class="text-light-blue">{langTranslateApp.dashViewingDays} <span class="text-uppercase">{app.viewingDaysLeft} {langTranslateApp.transHistoryDays}</span></div> </div> </div> </div> <div class="col-xs-5 col-sm-3"><button disabled="{!app.amounttopayloaded}" type="button" class="btn btn-paynow text-uppercase" onclick="{OnPayNow}">{paynowCaption}</button></div> </div> </section> </div> <div class="col-sm-2"> <div class=""> <a if="{!app.isCurrDVSSmartcard}" href="javascript:void(0);" onclick="{OnFixError}"> <div class="fix-error-box"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-manage-profile"></i> </div> </div> <div class="btnDiv" action="UPDATEDETAILS"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.fix}</span><span>{langTranslateApp.error}</span> </span></div> </div> </a> <div class="stream-watch-now"> <a if="{app.isCurrDVSSmartcard}" href="javascript:void(0);" onclick="{OnWatchNowStreaming}"> <div class="fix-error-box"> <div class="content"> <div class="iconDiv"> <i class="icon icon-streaming-circle"></i> </div> </div> <div class="btnDiv" action="UPDATEDETAILS"> <span class="btn btn-primary stream-btn"> <span class="heading">Watch</span><span>Now</span> </span></div> </div> </a> </div> </div> <div class="clearfix"></div></section><!--<section class="package-section-main clearfix collapsible2"><span id="close-message2" class="close-message2"></span><div class="d-flex relative align-items-center justify-content-between"><div class="mb-4"><h4>{langTranslateApp.accountmessage1}</h4> </div> <span class="arrows-package"></span> </div><div class="package-slider-new package-slider"><div class="packageItem {package.properties.Name} {package.title}" each="{package, index in umbracopackages}"><div class="backgroun-img"></div> <i class="icon-pack icon-{package.properties.Code}"></i><div class="price single-currency"><span if="{!app.dualCurrencyApplicable }" class="text-uppercase">{dstvApp.countrycurrency+" "+package.properties.Price}</span><span if="{app.dualCurrencyApplicable && dstvApp.countryabbreviation == \'et\'}" class="text-uppercase">{"USD "+package.properties.Price}</span><span if="{app.dualCurrencyApplicable && dstvApp.countryabbreviation == \'mu\'}" class="text-uppercase">{dstvApp.countrycurrency+" "+package.properties.Price}</span></div><div class="price dual-currency" if="{package.properties.localPrice}"><span class="text-uppercase">{package.properties.localPrice.currency+" "+package.properties.localPrice.price}</span></div><div class="bottomBar pricebar"><div class="Get-now"><a if="{hideChangePackage}" href="javascript:void(0)" class="btn-package package_{package.title}" onclick="{PackageGetNow}" package="{package.title}">{langTranslateApp.accountcardgetnow}</a><a if="{!hideChangePackage}" href="javascript:void(0)" class="btn-package package_{package.title}" onclick="{PackageGetNow}" package="{package.title}">{langTranslateApp.accountcardgetnow}</a></div><div class="Konw-more"><a href="javascript:void(0)" class="btn-package" onclick="{PackageKnowMore}" package="{package.properties.Name} {package.title}">{langTranslateApp.knowMore}</a></div></div></div></div></div></section>--><section if="{app.alertsAndMessages && app.showAlertsAndMessages && app.isNotPrimePackage}" id="cms-message" class="{messageType} generic-alert-section clearfix"> <span if="{app.alertImage}" id="close-message" class="close-message1"></span> <div if="{app.alertImage}" class="image-header minimize" style="background:url({alertImage});background-position: center {imgAlign}"><a if="{trailerLink}" href="{trailerLink}" target="_blank"></a></div> <div class="cms-msg-bottom"><div class="col-sm-1 text-center"> <div class="iconDiv"><i class="icon icon-icon-info"></i></div> </div> <div class="col-sm-7 generic-alert-text"> <tag-raw content="{site.factory.replaceSinglequote(site.factory.decodeHtmlEntities(alertsAndMessages))}"></tag-raw> </div> <div class="col-sm-4 text-center"><a href="{buttonLink}" onclick="{window.RedirectTargetOrgin}" AlertMessageAction="{app.selfServiceAction}" class="btn anim-btn btn-white btn-bordered custom-button-headers">{buttonText}</a></div> <div class="clearfix"></div></div></section><tag-dash-package-section></tag-dash-package-section><section id="packageMainSection" class="package-section-main showmax-premium clearfix dvsapplied" attr-data={ app.isCurrDVSSmartcard }> <div class="col-md-3 promo-slider"> <div class="col-md-12 showmax-wrapper"> <tag-showmax-card></tag-showmax-card> </div> <div class="col-md-12 add-movies-wrapper" style="width: 100%; display: none;" if="{dstvApp.ShowMovieAddon && isMovieAddonApplicable && !noServicesLoadedOnCard && !app.hideMovieAddonCard}"> <div class="add-movies" style="background-image: url(/media/11717/add-movies-bg-image.jpg);"> <i class="add-add-movies"></i> <div><img src="{dstvApp.targetDomain+movieAddonUmbracoContent.CoverImage}" width="100%" height="auto"></div> <p>Add a month of <strong>Premium Movies.</strong></p> <div if="{!primaryPackageDisconnected}" class="txt-wrapper noservice success-box"> <span class="icon icon-pending-icon errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><strong>Add movies to your existing package</strong><br>What exactly do you get find out more <a href="javascript:void(0)" onclick="{GoToAddonDetailsPage}">here.</a></p> </div> <div if="{primaryPackageDisconnected}" class="txt-wrapper noservice warning-box test"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>YOUR PACKAGE IS DISCONNECTED</b> <br>Please make a payment to reconnect your account.</p> </div> <div class="terms noservice"><a href="https://www.multichoice.com/multichoice-africa-subscriber-ts-cs/dstv-subscribers/" title="Terms and Conditions" target="_blank" tabindex="0">Terms &amp; Conditions Apply </a> </div> <div class="glass"> <a id="btnAddMovies" href="javascript:void(0);" class="clearfix" tabindex="0" onclick="{linkMovieAddon}" if="{!primaryPackageDisconnected && !isMovieAddonAdded && !isMovieAddonActive}">Add Movies<span class="arrow-next-circle"></span></a><a id="btnPayReconnectMovies" href="javascript:void(0);" class="clearfix" tabindex="0" onclick="{payReconnect}" if="{primaryPackageDisconnected}">Pay / Reconnect<span class="arrow-next-circle"></span></a><a id="ReconnectMovies" href="javascript:void(0);" class="clearfix" tabindex="0" onclick="{payReconnect}" if="{!primaryPackageDisconnected && isMovieAddonAdded && !isMovieAddonActive}">{reconnectBtnText}<span class="arrow-next-circle"></span></a></div> </div> </div> </div> <div  class="package-promo col-md-9 cards-block"> <div class="row"> <div class="col-sm-3 col-md-4 heading-details"> <h2>{app.packageHeading}</h2> <p>{app.packageSubHeading}</p> </div> <div class="col-sm-8 col-md-7 included-in text-right"> <p>{langTranslateApp.IncludesText}:</p> <ul> <li if="{showShowmax}"><img src="/media/11453/showmax-icon.png" class="showmax-icon"></li> <li if="{hideDStvOnline}"><img src="/media/11448/dstv-icon.png" class="dstv-icon"></li> <li><img src="/media/11454/supersport-icon.png" class="supersport-icon"></li> <li if="{!app.isCurrDVSSmartcard && !app.isLiberia}"><img src="/media/11447/boxoffice-icon.png" class="boxoffice-icon"></li> </ul> </div> </div> <div class="row"> <div class="col-sm-3 col-md-3 channel-details"> <div class="channels-number"><img src="/media/11455/tv-icon.png"><span class="plus-sign mob-vw">+</span> {dsoChannelCount} <span class="plus-sign desktop-vw">+</span><span class="labels">{langTranslateApp.pkgTVChannels}</span></div> <div class="audio-number"><img src="/media/11451/radio-icon-wihte.png" width="45" height="45" class="mobile-vw"><img src="/media/11450/radio-icon.png" class="desktop-vw">{dsoAudioChannelsCount}<span class="labels">{langTranslateApp.pkgAudChan}</span></div> </div> <div class="col-sm-8 col-md-9 cards-wrapper"> <ul> <li each="{pkgImage, index in app.pkgImages}"><img src="{pkgImage.imageURL}"></li> </ul> </div> </div> <div class="row button-link-section"><a target="_blank" href="{app.pkgLinkedPage}">{app.linkText}</a></div></section><tag-account-self-service></tag-account-self-service><tag-what-to-watch-section></tag-what-to-watch-section><tag-whats-hot></tag-whats-hot><tag-you-may-like-section></tag-you-may-like-section><tag-dash-view-all-subscription></tag-dash-view-all-subscription><tag-dash-get-streaming-live></tag-dash-get-streaming-live><tag-dash-cancel-streaming></tag-dash-cancel-streaming><section if="{!app.isCurrDVSSmartcard}" class="decoder-section-main clearfix collapsible7"> <span id="close-message7" class="close-message7"></span> <div class="d-flex relative align-items-center justify-content-between"> <div class="mb-4 packageheading"> <h4>{app.decoderSectionHeading}</h4> </div> <span class="arrows-package"></span> </div> <div class="decoder-slider-new decoder-slider"> <div class="decoderItem {decoder.title} {decoder.properties.Name}" each="{decoder, index in umbracodecoders}"> <div class="background-img"></div> <i class="icon-pack icon-DSTV"></i> <div class="get"> <div class="decodername" if="{decoder.properties.PackageName}">{decoder.properties.PackageName}</div> <div class="decodername" if="{!decoder.properties.PackageName}">{decoder.properties.Name}</div> <div class="Get-now"><a href="javascript:void(0)" class="btn-package package_{decoder.title}" onclick="{DecoderGetNow}" package="{decoder.title} {decoder.properties.Name}">{langTranslateApp.accountcardgetnow}</a></div> </div> <div class="decoderbottomBar"></div> </div> </div> <div style="display:none;" class="showmaxInPage" ub-in-page="6112425fdee145074039dead"></div> <div style="display:none;" class="showmaxInPage" ub-in-page="61162fb5d6c70218c90e7fab"></div></section>','','',function(opts){var self=this;self.showMovieAddonClass='none'
self.paynowCaption=langTranslateApp.accPay;self.noOnlinePayment=dstvApp.NoOnlinePaymentCountryList.includes(dstvApp.countryabbreviation);self.arrayDualCurrencyContries=[];self.arrayDualCurrencies=[];self.showShowmaxSection=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);self.isShowMaxApplicable=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);let dotcom=site.env=='PROD'?'.com':'.io';self.showmaxGetItNowURL=`https://secure.showmax${dotcom}/v133.0/website/signup`;self.showmaxTrialSignUpURL=`https://secure.showmax${dotcom}/v133.0/website/signup`
self.notDualCurrency=false;self.isMovieAddonApplicable=dstvApp.movieAddonCountryList.includes(dstvApp.countryabbreviation);self.currencyConversionFactor=0;self.isStreamingLive=false;let ddlSmartcards='#ddlSmartcards';self.isDvsApplicable=dstvApp.DvsCountries.includes(dstvApp.countryabbreviation)&&dstvApp.EnableDvsOnDashboard;app.isMauritius=dstvApp.countryabbreviation=='mu'?true:false;if(dstvApp.countryabbreviation=='mu')
self.notDualCurrency=true;app.channelCount?self.dsoChannelCount=app.channelCount:self.dsoChannelCount=channelCount;app.audioCount?self.dsoAudioChannelsCount=app.audioCount:self.dsoAudioChannelsCount=audioCount;self.hideDStvOnline=!dstvApp.NoDStvOnlineCountryList.includes(dstvApp.countryabbreviation);self.showShowmax=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);self.isPremiumStatusApplicable=dstvApp.ShowPremiumStatus&&dstvApp.premiumStatusCountryList.includes(dstvApp.countryabbreviation);app.score=app.subsStatus?app.subsStatus.score:0;app.showAlertsAndMessages=true;self.primaryPackageDisconnected=false;self.isWebUni=dstvApp.packages&&dstvApp.packages.length>0&&dstvApp.configPackagesCountryList.includes(dstvApp.countryabbreviation);self.noDthNoWebUni=dstvApp.packages&&dstvApp.packages.length>0&&dstvApp.noDthNoWebuniCountries.includes(dstvApp.countryabbreviation);self.isDualBand=dstvApp.dualBandCountries.includes(dstvApp.countryabbreviation);self.on('mount',function(){if(self.noOnlinePayment){if(dstvApp.configPackagesCountryList.includes(dstvApp.countryabbreviation)){self.waystopayURL=dstvApp.languageAbbreviation=='pt'?dstvApp.dstvUrl+window.culture+'/pagar/como-pagar/':dstvApp.dstvUrl+window.culture+'/pay/how-to-pay/';}else{self.waystopayURL=window.culture+(dstvApp.languageAbbreviation=='pt'?'/formas-de-pagamento':'/ways-to-pay');}
self.paynowCaption=langTranslateApp.dashboardHowToPay;self.autoWidth=' auto-width';}
setTimeout(()=>{$(".close-message1").click(function(){$(".image-header").toggleClass("minimize");$(".generic-alert-section").toggleClass("minimize-img");});if(app.isCurrDVSSmartcard){self.showShowmax=dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)&&app.currentSmartcard[0].addonService.includes("SHOWMAX")
self.update()}},4000);setTimeout(()=>{$(".close-message2").click(function(){$(".collapsible2").toggleClass("collapsed");});},4000);$(".close-message3").click(function(){$(".collapsible3").toggleClass("collapsed");});$(".close-message5").click(function(){$(".collapsible5").toggleClass("collapsed");});$(".close-message6").click(function(){$(".collapsible6").toggleClass("collapsed");});$(".close-message7").click(function(){$(".collapsible7").toggleClass("collapsed");});if(app.isCurrDVSSmartcard&&!dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)){$('#packageMainSection').addClass('dvsapplied');$('.top-package-card').addClass('dvsapplied');self.isPremiumStatusApplicable=false;}
if(app.loggedin){if(dstvApp.EnableSecurityAuth){self.ViewSubscription()
self.FetchAmountToPay()}else{site.factory.GetJWT().then(function(token){self.token=token;self.ViewSubscription()
self.FetchAmountToPay()})}}
window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productImpressionPaynow',ecommerce:{impressions:[{id:app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService!==undefined?app.currentSmartcardPackage.primaryService.productCode:"",name:app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService!==undefined?app.currentSmartcardPackage.primaryService.productName.toString().toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim():"",category:'DP Subscription',list:'Self Service'}]}});if(!dstvApp.DualCurrency||(!dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))||(window.location.href.includes('/decoders/'))||dstvApp.countryabbreviation=='mu'){self.hideToggle();}
for(var i=0;i<dstvApp.DualCurrenciesList.length;i++){var split=dstvApp.DualCurrenciesList[i].split("-");self.arrayDualCurrencyContries.push(split[0]);self.arrayDualCurrencies.push(split[1]);}
if(dstvApp.DualCurrency&&dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)){if(app.dualCurrencyApplicable!==undefined&&app.dualCurrencyApplicable&&!self.notDualCurrency){dstvApp.countrycurrency=self.arrayDualCurrencies[0];}
self.setDualCurrencyFlag();self.setCurrencyToggle();self.InitializeDecoderSlider();jcf.replaceAll();}
jcf.refreshAll();jcf.replaceAll();self.initializeSlickSLider=function(){$(".promo-slider").not('.slick-initialized').slick({dots:true,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',infinite:true,autoplay:true,autoplaySpeed:7000,slidesToShow:1,slidesToScroll:1,focusOnSelect:true,responsive:[{breakpoint:1480,settings:{slidesToShow:1,}},{breakpoint:1280,settings:{slidesToShow:1,}},{breakpoint:1024,settings:{slidesToShow:1,}},{breakpoint:600,settings:{slidesToShow:1,}},{breakpoint:480,settings:{slidesToShow:1.1,}},{breakpoint:320,settings:{slidesToShow:1.1,}}]});}
self.removeSlider=function(){if($(".promo-slider").hasClass('slick-initialized'))
$(".promo-slider").slick('unslick');}
if(!app.hideMovieAddonCard&&app.hideMovieAddonCard!==undefined)
self.initializeSlickSLider();else{self.removeSlider();}
if(!app.forceReload&&app.forceReload!==undefined)
self.onMovieCardLoad();if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)&&dstvApp.countryabbreviation!=='mu'){self.fetchConversionFactor();}
window.getErrorCodes();site.factory.GetJWT().then(function(token){self.token=token;let url=dstvApp.DSOAPIUrl+`apiupdatecontactdetails/api/v1/UpdateContactDetails/GetCustomerProfile?Country=${dstvApp.country}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&CustomerNumber=${app.customernumber}&SmartcardNumber=${app.smartcard}`;site.factory.Get(url,self.token,self.onGetCustomerProfileSuccess,self.onGetCustomerProfileError);});});self.onGetCustomerProfileSuccess=function(data){app.customerDetails.ListOfAddress=data.listOfAddress;if(data.listOfPhoneNumber){data.listOfPhoneNumber.forEach(function(e){if(e.phoneType.toLowerCase()=='mobile'){app.customercontactdetails.MobileTel=e.number;}else if(e.phoneType.toLowerCase()=='home'){app.customercontactdetails.HomeTel=e.number;}else if(e.phoneType.toLowerCase()=='work'){app.customercontactdetails.WorkTel=e.number;}});}}
self.onGetCustomerProfileError=function(err){console.log('Error : Get customer profile API failed');}
self.OnPackageCardViewSubscriptions=function(){let params={showmodel:true,showclosebutton:true};riot.mount('tag-dash-view-all-subscription',params);}
self.fetchConversionFactor=function(){if(dstvApp.EnableSecurityAuth){let converCurrencyUrl=dstvApp.SecurityAuthBaseUrl+`/apicurrency/api/v1/Currency?Country=${dstvApp.country}&ToCurrency=ETB`;site.factory.Get(converCurrencyUrl,'',self.onFetchConversionFactorSuccess,self.onFetchConversionFactorError,false,false,true);}else{if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;let converCurrencyUrl=dstvApp.DSOAPIUrl+`/apicurrency/api/v1/Currency?Country=${dstvApp.country}&ToCurrency=ETB`;site.factory.Get(converCurrencyUrl,'',self.onFetchConversionFactorSuccess,self.onFetchConversionFactorError)});}else{let converCurrencyUrl=dstvApp.DSOAPIUrl+`/apicurrency/api/v1/Currency?Country=${dstvApp.country}&ToCurrency=ETB`;site.factory.Get(converCurrencyUrl,'',self.onFetchConversionFactorSuccess,self.onFetchConversionFactorError)}}}
self.onFetchConversionFactorSuccess=function(data){console.log('Accounts : On Currency conversion success');dstvApp.DualCurrencyConversionRate=data.conversionFactor;}
self.onFetchConversionFactorError=function(err){console.log('Accounts : On Currency conversion error');$('#errorMessage').show();}
self.hideToggle=function(){$('.currencyToggle').hide();}
self.onCurrencyToggle=function(e){let currencyToggleStatus=e.currentTarget.checked;if(currencyToggleStatus!==undefined){site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);}
self.setDualCurrencyFlag();self.showHidePackagePrices();self.update();};self.setDualCurrencyFlag=function(){console.log('On setDualCurrencyFlag : After Currency Toggle');if(self.arrayDualCurrencies.includes(dstvApp.countrycurrency.toLowerCase())){app.dualCurrencyApplicable=true;window.SessionSave("app",app);}
else{app.dualCurrencyApplicable=false;window.SessionSave("app",app);}
riot.update();}
self.setCurrencyToggle=function(){if(dstvApp.DualCurrency&&app.dualCurrencyApplicable){console.log('Dual currency is ON');var setToggleSwitch=function(){$('#toggleSwitch').addClass('jcf-label-active');$('.jcf-checkbox').removeClass('jcf-checked').addClass('jcf-unchecked');$('.switch-input').prop('checked',false);let currencyToggleStatus=$('.switch-input').prop('checked');site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);};setTimeout(setToggleSwitch,50);}
else{console.log('Dual currency is OFF');var setToggleSwitch=function(){$('#toggleSwitch').removeClass('jcf-label-active');$('.jcf-checkbox').removeClass('jcf-unchecked').addClass('jcf-checked');$('.switch-input').prop('checked',true);let currencyToggleStatus=$('.switch-input').prop('checked');site.factory.SetCurrency(currencyToggleStatus,dstvApp.countryabbreviation);};setTimeout(setToggleSwitch,50);}}
self.OnPayNow=function(e){if(self.noOnlinePayment)
window.RedirectTargetOrgin(e,self.waystopayURL);else if(app.customerDetails.IsSpecialistCustomer){let isPaymentAllowed=app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.length
if(isPaymentAllowed){if(app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.find(q=>q.type=="Principal").status!='Active'){site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{if(app.amounttopayloaded)
{window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productClickPaynow',ecommerce:{click:{actionField:{list:'Self Service'},products:[{id:app.selectedCurrentPackageDetails?app.selectedCurrentPackageDetails.PackageCode:'',name:app.selectedCurrentPackageDetails?app.selectedCurrentPackageDetails.PackageName.toString().toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim():'',price:app.currentSelectedPackage!==undefined?app.selectedCurrentPackageDetails.PackagePrice.toString():app.paymentduedetails.properties.amountToPay.value.toString(),brand:'DStv',category:'DP Subscriptions',list:'Self Service',variant:'',position:''}]}}});self.parent.HandleActiveTab("showPayment")}}}
self.PackageCardChangePackage=function(){self.hideChangePackage=dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(self.hideChangePackage){site.factory.ShowModelPopup('success','','Option for change of package is currently not available online. Please call us on the 4668585 or send an email to DStvcustomerservice@vitiro.org','',false,true);}
else if(app.customerDetails.IsSpecialistCustomer){let isPaymentAllowed=app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.length
if(isPaymentAllowed){if(app.viewSubscriptionResponse.find(p=>p.smartcardNumber==app.smartcard).services.find(q=>q.type=="Principal").status!='Active'){site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{site.factory.ShowModelPopup('success','',langTranslateApp.specialistCustomerMsg,'',false,true);return;}}else{if(app.packageLoaded)
{self.parent.HandleActiveTab("showChangePackage");}}}
self.OnFixError=function(){self.parent.HandleActiveTab("showFixError")}
self.OnWatchNowStreaming=function(){window.open(dstvApp.DstvNowURL,'_blank');}
self.ViewSubscription=function(){if(!app.packageLoaded||app.forceReload){console.log('Account : ViewSubscription started...')
app.packageLoaded=false;app.umbracoPackagesLoaded=false;app.umbracoDecodersLoaded=false;app.subsStatusLoaded=false;self.update();if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,null,self.ViewSubscriptionSuccess,self.ViewSubscriptionError,false,true,true);}else{let url=dstvApp.DSOAPIUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,self.token,self.ViewSubscriptionSuccess,self.ViewSubscriptionError);}}
else{console.log('Account : ViewSubscription already loaded')
riot.mount('tag-showmax-card',{showComponent:true});app.subsStatusLoaded=true;self.getAvailableUmbracoPackages();self.getAvailableUmbracoDecoders();}}
self.ViewSubscriptionSuccess=function(data){console.log('Account : ViewSubscription completed')
app.viewSubscriptionResponse=data;app.packageLoaded=true;app.forceReload=false;app.smartcard=app.smartcard?app.smartcard:app.viewSubscriptionResponse[0].smartcardNumber;self.packages=data.map((package)=>{self.isDvsSc=package.smartcardName=="DVSIUC";if(package.smartcardNumber==app.smartcard){app.viewingDaysLeft=package.viewingDaysLeft
app.isCurrDVSSmartcard=self.isDvsSc;app.isLiberia=dstvApp.countryabbreviation=='lr'?true:false;}
if(package.services!==null){if(package.services.length>1)
package.services=package.services.sort(function(x,y){return x.psnr-y.psnr})
primaryService=package.services.filter((service)=>{serviceName=service.serviceName.split('-');if(service.serviceName.includes('-')){serviceName=service.serviceName.split('-');}
else if(service.serviceName.toUpperCase().includes('SHOWMAX')){serviceName[0]=service.serviceName.toUpperCase().trim().substring(0,7).trim();serviceName[1]=service.serviceName.toUpperCase().trim().substring(15,7).trim();}
else if(service.serviceName.toUpperCase().includes('OTT')){serviceName[0]=service.serviceName.toUpperCase();serviceName[1]=serviceName[0]+' - '+serviceName[0]}
service.productCode=serviceName[0].trim();let pckNameArray=packageName=serviceName[1].toLowerCase().replace('dstv','').trim().split(' ')
service.productName=pckNameArray[0];service.productCode=="FAMME36"?service.productName=pckNameArray[0]+" "+pckNameArray[1]:""
service.productName+=packageName[1]=='plus'?'plus':'';service.productName=service.productName.replace("'","");service.hideAddonLinkClass=service.status=="Active"?'':' visibility-hidden';currentPackageFullName=service.serviceName;return service.type=='Principal'});if(primaryService.length>1)
primaryService=primaryService.filter((service)=>{return service.status=='Active'})
primaryService=primaryService[0];if(primaryService!=undefined||primaryService!=null&&package.smartcardNumber==app.smartcard){app.CardStatus=primaryService.status;app.MonthlyPrice=primaryService.price;app.ProductCode=primaryService.productCode;app.currentPackageFullName=primaryService.serviceName;if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))
app.MonthlyPriceDualCurrency=primaryService.localPrice?primaryService.localPrice.amount:null;}
addonServiceList=package.services.filter((service)=>{return(service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on'))&&service.status=='Active'});addonService=package.services.filter((service)=>{return(service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on'))&&service.status=='Active'});addonService=addonService[0]?(addonService[0].serviceName||addonService[0].description):'N/A';app.AddOnService=addonService;app.SmartCardNumber=package.smartcardNumber;app.addonServiceListForSubscription=addonServiceList;window.SessionSave("app",app);}
return{SerialNumber:package.smartcardNumber,smartcardName:package.smartcardName,primaryService:primaryService,addonService:addonService,Status:package.Status,psnr:package.psnr,serviceId:package.serviceId,isPrimarySmartcard:package.isPrimarySc,isXtraView:package.isXtraView,isDvsSc:self.isDvsSc};})
if(app.isCurrDVSSmartcard&&!dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)){$('#packageMainSection').addClass('dvsapplied');$('.top-package-card').addClass('dvsapplied');self.isPremiumStatusApplicable=false;}
$('#packageMainSection').addClass('dvsapplied');$('.top-package-card').addClass('dvsapplied');app.smartcards=self.packages;app.loadedpackages=true;app.currentSmartcard=app.smartcards.filter(x=>(x.SerialNumber==app.smartcard));app.noServicesLoaded=app.currentSmartcard.filter(x=>(x.primaryService!==undefined&&x.primaryService.length!==0&&x.primaryService!=='')).length==0;let sm=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)
app.showTerminatedBouquetScreen=null;if(sm.length&&sm[0].primaryService&&dstvApp.BouquetTermination){app.showTerminatedBouquetScreen=sm[0].primaryService.isExpired}
self.packages=self.packages.filter(x=>x.primaryService);app.currentSmartcardPackage=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0];self.getAvailableUmbracoPackages();self.getAvailableUmbracoDecoders();if(!app.selectedCurrentPackageDetails&&app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService){app.selectedCurrentPackageDetails=app.currentSmartcardPackage.primaryService
app.selectedCurrentPackageDetails.PackageCode=app.currentSmartcardPackage.primaryService.productCode?app.currentSmartcardPackage.primaryService.productCode:'';app.selectedCurrentPackageDetails.PackageName=app.currentSmartcardPackage.primaryService.productName?app.currentSmartcardPackage.primaryService.productName:'';app.selectedCurrentPackageDetails.PackagePrice=app.currentSmartcardPackage.primaryService.price?app.currentSmartcardPackage.primaryService.price:'';app.selectedCurrentPackageDetails.PackageDesc=app.currentSmartcardPackage.primaryService.description?app.currentSmartcardPackage.primaryService.description:'';}
if(app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService)
app.isNotPrimePackage=!app.currentSmartcardPackage.primaryService.productName.includes("premium");self.update();window.SessionSave("app",app);if(app.showTerminatedBouquetScreen){riot.mount('tag-payments-new');$('#paymentModal').modal('show');}
if(app.accountsInfo&&app.accountsInfo[0]&&app.accountsInfo[0].AccountBalance){if(app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0]!=undefined){self.availableAccountBalance=app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0].AccountBalance.Value;}
if(app.accountsInfo.filter(d=>d.AccountType=='DStvComm')[0]!=undefined){self.availableAccountBalance=app.accountsInfo.filter(d=>d.AccountType=='DStvComm')[0].AccountBalance.Value;}
if(dstvApp.DualCurrency&&dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)){if(app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0]!=undefined){self.availableAccountBalanceDualCurrency=app.accountsInfo.filter(d=>d.AccountType=='DStvRes')[0].AccountBalance.LocalPrice.Amount.toString();}
if(app.accountsInfo.filter(d=>d.AccountType=='DStvComm')[0]!=undefined){self.availableAccountBalanceDualCurrency=app.accountsInfo.filter(d=>d.AccountType=='DStvComm')[0].AccountBalance.LocalPrice.Amount.toString();}}}
else{self.availableAccountBalance='NA';}
let smLength=dvsSMLength=0;smLength=app.smartcards.filter(x=>x.primaryService).length;dvsSMLength=app.smartcards.filter(x=>x.isDvsSc==true).length;if(dvsSMLength!=0&&dvsSMLength!=smLength){app.isDvsHybridCustomer=true;app.isDvsCustomer=false;}
else if(dvsSMLength==1&&dvsSMLength==smLength){app.isDvsHybridCustomer=false;app.isDvsCustomer=true;}
else if(dvsSMLength==0)
app.isDvsHybridCustomer=app.isDvsCustomer=false;app.hideFixError=app.isDvsCustomer;self.packageLoaded=true;self.update();riot.update()
jcf.replaceAll();jcf.refreshAll();window.SessionSave("app",app);riot.mount('tag-showmax-card',{showComponent:true});riot.mount('tag-account-self-service');self.onMovieCardLoad();self.SubscriberStatus();window.dataLayer=window.dataLayer||[];dataLayer.push({event:'signin',package:app.currentPackageFullName,smartcard:app.smartcard,customernumber:app.customernumber})
if(navigator.standalone||window.matchMedia('(display-mode: standalone)').matches){console.log('Thanks for using our PWA!')
dataLayer.push({event:'PWASignin',package:app.currentPackageFullName,smartcard:app.smartcard,customernumber:app.customernumber})}
if(dstvApp.countryabbreviation=="ng"){app.isNotPrimePackage=true;}}
app.reconnectBtnText=self.reconnectBtnText='Reconnect';self.onMovieCardLoad=function(){if(app.viewSubscriptionResponse&&app.viewSubscriptionResponse.length>0){self.smartcardForMovieAddon=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard)[0];let sc=app.viewSubscriptionResponse.filter(sc=>sc.smartcardNumber==app.smartcard)[0];movieAddonProductDetails=[];if(sc){dstvApp.movieAddonProductCodes.forEach(productCode=>{sc.services.map(service=>{if(service.serviceName.includes(productCode)){movieAddonProductDetails.push(service);}})})}
app.movieAddonStatusDetails=movieAddonProductDetails[0];}
window.SessionSave("app",app);if(self.smartcardForMovieAddon==undefined){self.noServicesLoadedOnCard=true;self.movieAddonDataFetched=true;self.update();return;}
let smartcardStatus=self.smartcardForMovieAddon&&self.smartcardForMovieAddon.primaryService?self.smartcardForMovieAddon.primaryService.status.toUpperCase():null;self.disconnectedSmartcard=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';if(self.disconnectedSmartcard){app.primaryPackageDisconnected=self.primaryPackageDisconnected=true;self.initializeSlickSLider();}else{app.isMovieAddonAdded=self.isMovieAddonAdded=false;app.isMovieAddonActive=self.isMovieAddonActive=false;}
if(movieAddonProductDetails.length>0&&!self.disconnectedSmartcard){let movieAddonStatusDetails=app.movieAddonStatusDetails.status.toUpperCase();if(movieAddonStatusDetails=='ACTIVE'){app.isMovieAddonAdded=self.isMovieAddonAdded=true;app.isMovieAddonActive=self.isMovieAddonActive=true;app.hideMovieAddonCard=true;app.isHideMovieAddonSelfserviceCard=true;self.removeSlider();if(app.hideMovieAddonCard&&app.selfServiceAction&&app.selfServiceAction.toLowerCase().includes('movie'))
app.showAlertsAndMessages=false;}
else if(movieAddonStatusDetails=='DISCONNECTED'||movieAddonStatusDetails=='PENDING'){app.isMovieAddonAdded=self.isMovieAddonAdded=true;app.isMovieAddonActive=self.isMovieAddonActive=false;app.hideMovieAddonCard=false;app.isHideMovieAddonSelfserviceCard=false;if(movieAddonStatusDetails=='PENDING')
app.reconnectBtnText=self.reconnectBtnText='Add Movies';self.update();self.initializeSlickSLider();}
else{self.fetchAddonsList();}}
else{smartcardStatus!=undefined?self.fetchAddonsList():""}
self.getMovieAddonContent();self.update();}
self.fetchAddonsList=function(){var reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"packageName":self.smartcardForMovieAddon.primaryService.serviceName};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}${dstvApp.DSOChangePackageURL}?searchCust=${app.customernumber}`;site.factory.Post(url,reqBody,null,self.onFetchAddonsListSuccess,self.onFetchAddonsListError,false,false,false,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=`${dstvApp.DSOAPIUrl}${dstvApp.DSOChangePackageURL}`;site.factory.Post(url,reqBody,self.token,self.onFetchAddonsListSuccess,self.onFetchAddonsListError);});}}
self.onFetchAddonsListSuccess=function(data){self.movieAddonDataFetched=true;filteredAddOns=[];if(data){dstvApp.movieAddonProductCodes.forEach(productCode=>{data.map(service=>{if(service.isAddOn===true&&service.name.includes(productCode)){filteredAddOns.push(service);}})})
app.movieAddOnDetails=filteredAddOns[0];window.SessionSave("app",app);}
self.update();if(app.movieAddOnDetails){app.isMovieAddonAdded=self.isMovieAddonAdded=false;app.isMovieAddonActive=self.isMovieAddonActive=false;app.hideMovieAddonCard=false;}
else{app.hideMovieAddonCard=true;if(app.hideMovieAddonCard&&app.selfServiceAction&&app.selfServiceAction.toLowerCase().includes('movie'))
app.showAlertsAndMessages=false;self.removeSlider();self.update();return;}
self.update();self.initializeSlickSLider();self.update();if(app.selfServiceAction&&app.selfServiceAction.toLowerCase().includes('movie'))
self.ManageAlertsAndMessagesSection();}
self.onFetchAddonsListError=function(err){self.movieAddonDataFetched=true;if(err.responseJSON&&err.responseJSON.StatusCode==422){console.log(err.responseJSON.Message);}
self.update();}
self.linkMovieAddon=function(){filteredSmartcard=app.smartcards.filter(sc=>sc.SerialNumber==app.smartcard);window.HandleActiveTab("showChangePackage");riot.mount('tag-change-package-service',{linkMovieAddon:true});}
self.payReconnect=function(){window.HandleActiveTab("showPayment");}
self.getMovieAddonContent=function(){fetch(dstvApp.targetDomain+"/api-services/movie-addon-web/ujson?children=true&select=title,coverImage,additionalImages&resolveMedia=coverImage,additionalImages&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetMovieContentSuccess(commits));}
self.onGetMovieContentSuccess=function(data){console.log('Movie Addon : Success in fetching Umbraco content');self.movieAddonUmbracoContent=data.entities[0].properties;self.update();}
self.GoToAddonDetailsPage=function(e){var selectedPackage='dstv-movie-bundle-add-on';var packageDetailsURL=window.culture+"/packages/"+selectedPackage;window.RedirectTargetOrgin(e,packageDetailsURL);}
self.ManageAlertsAndMessagesSection=function(){if(self.primaryPackageDisconnected){$('.custom-button-headers')[0].innerText='Pay / Reconnect';}
else if(!self.primaryPackageDisconnected&&!self.isMovieAddonAdded&&!self.isMovieAddonActive){$('.custom-button-headers')[0].innerText='Add Movies';}
else if(!self.primaryPackageDisconnected&&self.isMovieAddonAdded&&!self.isMovieAddonActive){$('.custom-button-headers')[0].innerText=app.reconnectBtnText;}}
self.ViewSubscriptionError=function(err){console.log('Account : ViewSubscription completed with error');console.log(err);self.getAvailableUmbracoPackages();self.getAvailableUmbracoDecoders();}
self.FetchAmountToPay=function(forceReload){if(!app.amounttopayloaded||app.forceReload){console.log('Account : FetchAmountToPay started...')
app.amounttopayloaded=false;self.update();if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,null,self.OnFetchAmountToPaySuccess,self.OnFetchAmountToPayError,false,true,true);}else{let url=`${dstvApp.DSOAPIUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,self.token,self.OnFetchAmountToPaySuccess,self.OnFetchAmountToPayError)}}
else
console.log('Account : FetchAmountToPay already loaded')}
self.OnFetchAmountToPaySuccess=function(data){console.log('Account : FetchAmountToPay completed')
app.amounttopayloaded=true;app.forceReload=false;app.paymentduedetails.properties.dueDate={value:data.DueDate.split('T')[0]};if(app.isMauritius){app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.LocalPrice.Currency}}else{app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.Value*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.CurrencyCode}}
app.paymentduedetails.properties.amountToPayEtb=data.TotalAmountToPay.LocalPrice?{value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}:null
app.BOAccount=data.Accounts.filter(x=>x.AccountType=="Box Office")[0];app.IsBOCustomer=app.BOAccount&&Object.keys(app.BOAccount).length>0
app.accounts=data.Accounts.map(x=>({AccountNumber:x.AccountNumber,AccountType:x.AccountType}))
app.accountsInfo=data.Accounts;app.primaryaccountnumber=data.Accounts.filter(x=>x.IsDefault)[0].AccountNumber;if(data.Accounts.filter(x=>x.AccountType=='DStvRes')!=undefined){app.qouteLineItems=data.Accounts.filter(x=>x.AccountType=='DStvRes');}else{app.qouteLineItems=data.Accounts.filter(x=>x.AccountType=='DStvComm');}
app.qouteLineItems=app.qouteLineItems.map(x=>({AccountBalance:x.AccountBalance,AmountToPay:x.AmountToPay,DueAmount:x.DueAmount,Quotes:x.Quotes}))[0];if(app.qouteLineItems!=undefined){if(app.qouteLineItems.Quotes)
app.qouteLineItems.Quotes[0].LineItems=app.qouteLineItems.Quotes[0].LineItems.map((x)=>{if(x.InvoiceText.includes('Discount'))
x.DiscountItem=true
return x;})}
window.SessionSave("app",app);self.update();}
self.OnFetchAmountToPayError=function(err){console.log('Account : FetchAmountToPay completed with error');console.log(err);}
self.getAvailableUmbracoPackages=function(){if(app.isCurrDVSSmartcard){self.getUnificationUmbracoPackages();}
else{if((self.isWebUni||self.noDthNoWebUni)&&(!dstvApp.countryabbreviation.includes('zm')&&!dstvApp.countryabbreviation.includes('mz'))){self.configPackagesSuccess(dstvApp.packages);}else if(self.isDualBand){self.getUmbracoPackagesFromAPI();self.getDsoPackagesData();}
else{console.log('Account : Fetching available umbraco packages started...');fetch(dstvApp.targetDomain+window.culture+"/packages/ujson?descendants=Package&where=canCompare%20eq%20true&select=code,description,Name,Price,packageColor,Id,packageLogo,productMoreLink,packageName,price,productImage,productDetail,description,currency,channelCount,PriceLetter,packageFeatures,canCompare&resolvemedia=productImage,packageLogo&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetPackageSuccess(commits)).catch(error=>self.onGetPackageError(error));}}}
self.getUmbracoPackagesFromAPI=function(){var reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"packageName":app.currentPackageFullName};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}${dstvApp.DSOChangePackageURL}?searchCust=${app.customernumber}`;site.factory.Post(url,reqBody,null,self.ongetUmbracoPackagesFromAPISuccess,self.ongetUmbracoPackagesFromAPIError,false,false,false,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=`${dstvApp.DSOAPIUrl}${dstvApp.DSOChangePackageURL}`;site.factory.Post(url,reqBody,self.token,self.ongetUmbracoPackagesFromAPISuccess,self.ongetUmbracoPackagesFromAPIError);});}}
self.ongetUmbracoPackagesFromAPISuccess=function(data){data=data.filter(d=>d.isAddOn===false).reverse();let packageArr=[];data.forEach(package=>{let prop={Name:package.name,Code:package.name.split(' ')[0],Price:package.price.value,isAddon:package.isAddOn}
let properties={'properties':prop}
packageArr.push(properties)})
self.umbracopackages=packageArr;self.principalPackages=self.umbracopackages.filter(p=>p.properties.isAddon==false)
self.addonPackages=self.umbracopackages.filter(p=>p.properties.isAddon==true)
self.umbracopackages=[...self.principalPackages,...self.addonPackages]
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.Name.toLowerCase().includes('premium')&&(x=>!x.properties.Name.toLowerCase().includes('streaming'))&&(x=>!x.properties.Name.includes('+')))[0].properties.Code;if(dstvApp.languageAbbreviation=='pt')
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.Name.toLowerCase().includes('bu')&&(x=>!x.properties.Name.toLowerCase().includes('streaming'))&&(x=>!x.properties.Name.includes('+')))[0].properties.Code;app.PremiumPackagePrice=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.Price;if(app.dualCurrencyApplicable&&!self.notDualCurrency)
app.PremiumPackagePriceEtb=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.localPrice.price;self.InitializePackageSlider();}
self.ongetUmbracoPackagesFromAPIError=function(data){console.log("Change package API Error :-"+data.responseJSON.Message);}
self.getDualCurrencyUmbracoPackages=function(){console.log('Account : Fetching available dual currency umbraco packages started...');fetch(dstvApp.targetDomain+window.culture+"/dual-currency-packages/ujson?descendants=dualCurrencyPackage&select=packageName,packageCode,Currency,price&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetDualCurrencyPackageSuccess(commits)).catch(error=>self.onGetDualCurrencyPackageError(error));}
self.configPackagesSuccess=function(data){console.log('Account : Config packages fetching completed');if(!self.isMovieAddonApplicable){data=data.filter((item)=>item.title!=="movie bundle add-on");}
self.umbracopackages=data;if(app.isCurrDVSSmartcard){self.umbracopackages=self.umbracopackages.filter((x=>x.properties.IsOTT)&&(x=>x.properties.Name.toLowerCase().includes(dstvApp.countryabbreviation+' ')));}
else if(!app.isCurrDVSSmartcard)
self.umbracopackages=self.umbracopackages.filter(x=>!x.properties.Code.toLowerCase().includes('ott'));app.umbracopackages=self.umbracopackages;var pkgImpressionArr=[];if(app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService){self.umbracopackages.forEach(package=>{if(app.currentSmartcardPackage!==undefined){if(package.properties.Code!=app.currentSmartcardPackage.primaryService.productCode){var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|w/afr|is20|standalone|e/afr|e36| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}}else{var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}});}
window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productImpressionGetnow',ecommerce:{impressions:pkgImpressionArr}});if(!app.isCurrDVSSmartcard)
self.getDsoPackagesData();else
self.InitializePackageSlider();}
self.onGetPackageSuccess=function(data){console.log('Account : Fetching available umbraco packages completed');if(!self.isMovieAddonApplicable){data.entities=data.entities.filter((item)=>item.title!=="DStv Movie Bundle Add-On");}
self.umbracopackages=data.entities;var pkgImpressionArr=[];self.umbracopackages.forEach(package=>{if(app.currentSmartcardPackage!==undefined){if(package.properties.Code!=app.currentSmartcardPackage.primaryService.productCode){var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|w/afr|is20|standalone|e/afr|e36| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}}else{var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}});window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productImpressionGetnow',ecommerce:{impressions:pkgImpressionArr}});if(app.isCurrDVSSmartcard)
self.umbracopackages=self.umbracopackages.filter(x=>x.properties.Code.toLowerCase().includes('ott'));else if(!app.isCurrDVSSmartcard)
self.umbracopackages=self.umbracopackages.filter(x=>!x.properties.Code.toLowerCase().includes('ott'));app.umbracopackages=self.umbracopackages;if(dstvApp.DTHCountries.includes(dstvApp.countryabbreviation)){self.getDthCountriesUmbracoPackages();}
else{if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation)&&!self.notDualCurrency){self.getDualCurrencyUmbracoPackages();}
else{self.update();self.getDsoPackagesData();}}}
self.onGetPackageError=function(err){console.log('Account : Fetching available umbraco packages completed with error.');console.log(err);self.umbracopackages=[];self.InitializePackageSlider();}
self.getUnificationUmbracoPackages=function(){console.log('DVS : Fetching available Unification streaming packages');if(app.uniDvsPackages&&app.uniDvsPackages!=undefined&&!window.reloadData){console.log('DVS : Umbraco Unification DVS Package already exists');self.configPackagesSuccess(app.uniDvsPackages);}
else{fetch(dstvApp.UnificationUmbracoUrl+(new Date().getTime())).then(response=>response.json()).then(commits=>self.OnGetUniPackageSuccess(commits)).catch(error=>self.OnGetUniPackageError(error));}}
self.OnGetUniPackageSuccess=function(data){console.log('DVS : Unification Umbraco packages fetch successful');console.log(data);self.umbracopackages=data.entities;self.umbracopackages=self.umbracopackages.filter((x=>x.properties.IsOTT)&&(p=>p.properties.Name.split(' ')[0].toLowerCase()==dstvApp.countryabbreviation))
app.uniDvsPackages=app.umbracopackages=self.umbracopackages;var pkgImpressionArr=[];self.umbracopackages.forEach(package=>{if(app.currentSmartcardPackage!==undefined){if(package.properties.Code!=app.currentSmartcardPackage.primaryService.productCode){var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|w/afr|is20|standalone|e/afr|e36| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}}else{var impression={};impression["id"]=package.properties.Code;impression["name"]=package.properties.Name.toLowerCase().replaceAll(new RegExp('dStv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim();impression["category"]="DP Change Package";impression["list"]="Self Service";pkgImpressionArr.push(impression);}});window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productImpressionGetnow',ecommerce:{impressions:pkgImpressionArr}});self.getDsoPackagesData();if(dstvApp.DsoChannels)
self.getDsoChannelsData();}
self.OnGetUniPackageError=function(){console.log('DVS : Error fetching Unification Umbraco packages');}
self.onGetDualCurrencyPackageSuccess=function(data){console.log('Account : Fetching available dual currency umbraco packages completed');self.dualcurrencyumbracopackages=data.entities;self.update();self.getDsoPackagesData();}
self.onGetDualCurrencyPackageError=function(err){console.log('Account : Fetching available dual currency umbraco packages completed with error.');console.log(err);self.getDsoPackagesData();}
self.addDualPackagesToObject=function(){if((self.umbracopackages&&self.umbracopackages!=='undefined')&&(self.dualcurrencyumbracopackages&&self.dualcurrencyumbracopackages!=='undefined')){for(var i=0;i<self.umbracopackages.length;i++)
{try{let packageCode=self.umbracopackages[i].properties.Code;let dualCurrencyArray=dstvApp.DualCurrenciesList.filter(item=>item.includes(dstvApp.countryabbreviation));let dualCurrency=dualCurrencyArray[0].split('-')[1];let dualCurrencyPackagePrice=self.dualcurrencyumbracopackages.filter(a=>a.properties.PackageCode.toLowerCase()===packageCode.toLowerCase())[0].properties.Price;self.umbracopackages[i].properties.localPrice={'currency':dualCurrency,'price':dualCurrencyPackagePrice};}
catch(e){}}}}
self.getDsoPackagesData=function(){if(!dstvApp.DsoPackagePricing){self.InitializePackageSlider();return;}
if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apipackageguide/api/v1/PackageGuide/GetPackagePriceDetails?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}`;site.factory.Get(url,null,self.onGetDsoPackagesSuccess,self.onGetDsoPackagesError,false,false,true);}else{let url=dstvApp.DSOAPIUrl+`/apipackageguide/api/v1/PackageGuide/GetPackagePriceDetails?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}`;site.factory.Get(url,self.token,self.onGetDsoPackagesSuccess,self.onGetDsoPackagesError);}}
self.onGetDsoPackagesSuccess=function(data){console.log('Account: Fetching packages data from DSO successful');app.showmaxNormalPrice=data.find(p=>p.name.toLowerCase().includes('showmax'))
window.SessionSave("app",app);if(self.isDualBand&&!app.isDvsCustomer)return true;self.modifyPackagesObject(data);self.InitializePackageSlider();if(dstvApp.DsoChannels)
self.getDsoChannelsData();}
self.onGetDsoPackagesError=function(err){console.log('Account: Error in Fetching packages data from DSO');self.InitializePackageSlider();}
self.modifyPackagesObject=function(dsoData){if((self.umbracopackages&&self.umbracopackages!=='undefined')&&(dsoData&&dsoData!=='undefined')){self.umbracopackages.map((package)=>{try{package.properties.Price=0;package.properties.ChannelCount=0;let packageCode=package.properties.Code.toLowerCase().trim();let dsoItem=dsoData?dsoData.filter(a=>a.prodUserKey.toLowerCase()==packageCode)[0]:null;if(app.isMauritius){package.properties.Price=dsoItem?dsoItem.localPrice.amount:0;}else
package.properties.Price=dsoItem?dsoItem.price.value:0;package.properties.ChannelCount=2*Math.trunc(dsoItem.channelCount/2)+' +';package.properties.isAddon=dsoItem.productCategory.toLowerCase()=="principal"?false:true
if(app.dualCurrencyApplicable&&!self.notDualCurrency)
package.properties.localPrice={'currency':dsoItem.localPrice.currency,'price':dsoItem.localPrice.amount};}
catch(e){console.log('Exception occured :'+e)}})
if(self.isWebUni||self.noDthNoWebUni){if(self.umbracopackages){if(app.isCurrDVSSmartcard){self.filteredPackage=self.umbracopackages.filter(x=>x.properties.ProductName.toLowerCase().includes('premium')&&(x=>x.properties.ProductName.toLowerCase().includes('streaming'))&&(x=>!x.properties.ProductName.includes('+')));app.premPackageCode=self.filteredPackage&&self.filteredPackage.length>0?self.filteredPackage[0].properties.Code:'';if(dstvApp.languageAbbreviation=='pt')
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.ProductName.toLowerCase().includes('bu')&&(x=>x.properties.ProductName.toLowerCase().includes('streaming'))&&(x=>!x.properties.ProductName.includes('+')))[0].properties.Code;app.PremiumPackagePrice=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.Price;if(app.dualCurrencyApplicable&&!self.notDualCurrency)
app.PremiumPackagePriceEtb=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.localPrice.price;}
else{app.premPackageCode=self.umbracopackages.filter(x=>x.properties.Name.toLowerCase().includes('premium')&&(x=>!x.properties.Name.toLowerCase().includes('streaming'))&&(x=>!x.properties.Name.includes('+')))[0].properties.Code;if(dstvApp.languageAbbreviation=='pt')
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.Name.toLowerCase().includes('bu')&&(x=>!x.properties.Name.toLowerCase().includes('streaming'))&&(x=>!x.properties.Name.includes('+')))[0].properties.Code;app.PremiumPackagePrice=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.Price;if(app.dualCurrencyApplicable&&!self.notDualCurrency)
app.PremiumPackagePriceEtb=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.localPrice.price;}}}
else{if(self.umbracopackages){if(app.isCurrDVSSmartcard){self.filteredPackage=self.umbracopackages.filter(x=>x.properties.ProductName.toLowerCase().includes('premium')&&(x=>x.properties.ProductName.toLowerCase().includes('streaming'))&&(x=>!x.properties.ProductName.includes('+')))[0].properties.Code;app.premPackageCode=self.filteredPackage&&self.filteredPackage.length>0?self.filteredPackage[0].properties.Code:'';if(dstvApp.languageAbbreviation=='pt')
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.ProductName.toLowerCase().includes('bu')&&(x=>x.properties.ProductName.toLowerCase().includes('streaming'))&&(x=>!x.properties.ProductName.includes('+')))[0].properties.Code;app.PremiumPackagePrice=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.Price;if(app.dualCurrencyApplicable&&!self.notDualCurrency)
app.PremiumPackagePriceEtb=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.localPrice.price;}
else{app.premPackageCode=self.umbracopackages.filter(x=>x.properties.PackageName.toLowerCase().includes('premium')&&(x=>!x.properties.PackageName.toLowerCase().includes('streaming'))&&(x=>!x.properties.PackageName.includes('+')))[0].properties.Code;if(dstvApp.languageAbbreviation=='pt')
app.premPackageCode=self.umbracopackages.filter(x=>x.properties.PackageName.toLowerCase().includes('bu')&&(x=>!x.properties.PackageName.toLowerCase().includes('streaming'))&&(x=>!x.properties.PackageName.includes('+')))[0].properties.Code;app.PremiumPackagePrice=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.Price;if(app.dualCurrencyApplicable&&!self.notDualCurrency)
app.PremiumPackagePriceEtb=self.umbracopackages.filter(x=>x.properties.Code==app.premPackageCode)[0].properties.localPrice.price;}}}
if(self.umbracopackages){self.umbracopackages=self.umbracopackages.sort(function(a,b){return b.properties.Price-a.properties.Price});self.principalPackages=self.umbracopackages.filter(p=>p.properties.isAddon==false)
self.addonPackages=self.umbracopackages.filter(p=>p.properties.isAddon==true)
self.umbracopackages=[...self.principalPackages,...self.addonPackages]}}}
self.getDthCountriesUmbracoPackages=function(){console.log('Account : Fetching DTH Countries available umbraco packages started...');fetch(dstvApp.targetDomain+'/en-dth'+"/packages/ujson?descendants=Package&where=canCompare%20eq%20true&select=code,Name,packageName&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetDthPackageSuccess(commits)).catch(error=>self.onGetDthPackageError(error));}
self.onGetDthPackageSuccess=function(data){console.log('Account : Fetching available DTH Countries umbraco packages completed');self.dthUmbracopackages=data.entities;self.umbracopackages.map((package)=>{try{let pkgName=package.properties.PackageName.toLowerCase().trim();let packageItem=data?data.entities.filter(a=>a.properties.PackageName.toLowerCase().trim()==pkgName)[0]:null;package.properties.Code=packageItem?packageItem.properties.Code:'';if(pkgName.toLowerCase().includes('premium')&&dstvApp.DthWithDiffPremium.includes(dstvApp.countryabbreviation))
package.properties.Code="PREE36";}
catch(e){console.log('Exception occured :'+e)}})
self.update();self.getDsoPackagesData();}
self.onGetDthPackageError=function(err){console.log('Account : Fetching available DTH Countries umbraco packages completed with error.');console.log(err);self.dthUmbracopackages=[];self.InitializePackageSlider();}
self.InitializePackageSlider=function(){console.log('Umbraco package initialization..')
app.umbracoPackagesLoaded=true;if(self.isWebUni||self.noDthNoWebUni||self.isDualBand){if(app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService){let currPKGName=app.currentSmartcardPackage.primaryService.productName.toLowerCase();self.umbracopackages=self.umbracopackages.map((x)=>{x.properties.Name.replace(/ /g,'')
return x;})
self.umbracopackages=self.umbracopackages.filter(x=>(dstvApp.languageAbbreviation=='en'&&x.properties.Code!=app.currentSmartcardPackage.primaryService.productCode)||(dstvApp.languageAbbreviation=='pt'&&x.properties.Code!=app.currentSmartcardPackage.primaryService.productCode));if(app.currentSmartcardPackage.primaryService.serviceName.toLowerCase().includes('premium')&&dstvApp.movieAddonProductCodes){dstvApp.movieAddonProductCodes.forEach(productCode=>{self.umbracopackages=self.umbracopackages.filter(x=>!x.properties.Code.includes(productCode));})}
app.umbracopackages=self.umbracopackages;self.update();}}else{if(app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService){let currPKGName=app.currentSmartcardPackage.primaryService.productName.toLowerCase();self.umbracopackages=self.umbracopackages.map((x)=>{x.pName=x.title.toLowerCase().replace('dstv','').replace(/ /g,'')
return x;})
self.umbracopackages=self.umbracopackages.filter(x=>(dstvApp.languageAbbreviation=='en'&&x.properties.Code!=app.currentSmartcardPackage.primaryService.productCode)||(dstvApp.languageAbbreviation=='pt'&&x.properties.Code!=app.currentSmartcardPackage.primaryService.productCode));if(app.currentSmartcardPackage.primaryService.serviceName.toLowerCase().includes('premium')&&dstvApp.movieAddonProductCodes){dstvApp.movieAddonProductCodes.forEach(productCode=>{self.umbracopackages=self.umbracopackages.filter(x=>!x.properties.Code.includes(productCode));})}
jcf.replaceAll();self.update();}}
riot.mount('tag-dash-package-section');$(".package-slider-new").not('.slick-initialized').slick({dots:false,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',infinite:false,slidesToShow:3.1,slidesToScroll:1,focusOnSelect:true,responsive:[{breakpoint:1480,settings:{slidesToShow:3.1,}},{breakpoint:1280,settings:{slidesToShow:2,}},{breakpoint:1024,settings:{slidesToShow:2,}},{breakpoint:600,settings:{slidesToShow:1.2,}},{breakpoint:480,settings:{slidesToShow:1,}},{breakpoint:320,settings:{slidesToShow:1,}}]});self.update();self.showHidePackagePrices();}
self.getAvailableUmbracoDecoders=function(){if(dstvApp.decoders.length>0&&dstvApp.configPackagesCountryList.includes(dstvApp.countryabbreviation)){self.configDecoderSuccess(dstvApp.decoders)}else{console.log('Account : Fetching available umbraco decoders started...');var decUrl=dstvApp.targetDomain+window.culture+"/decoders/ujson?descendants=Package&where=canCompare%20eq%20true&select=code,description,Name,newPrice,packageColor,Id,packageLogo,productMoreLink,packageName,price,productImage,productDetail,description,currency,channelCount,PriceLetter,packageFeatures,canCompare&resolvemedia=productImage,packageLogo&cdv="+(new Date().getTime());fetch(dstvApp.targetDomain+window.culture+"/decoders/ujson?descendants=Package&where=canCompare%20eq%20true&select=code,description,Name,newPrice,packageColor,Id,packageLogo,productMoreLink,packageName,price,productImage,productDetail,description,currency,channelCount,PriceLetter,packageFeatures,canCompare&resolvemedia=productImage,packageLogo&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetDecoderSuccess(commits));}}
self.configDecoderSuccess=function(data){console.log('Account : Fetching available umbraco decoders completed');self.umbracodecoders=data;self.update();self.InitializeDecoderSlider();}
self.onGetDecoderSuccess=function(data){console.log('Account : Fetching available umbraco decoders completed');self.umbracodecoders=data.entities;self.update();self.InitializeDecoderSlider();}
self.onGetDecoderError=function(err){console.log('Account : Fetching available umbraco decoders completed with error.');console.log(err);self.umbracodecoders=[];self.InitializeDecoderSlider();}
self.InitializeDecoderSlider=function(){console.log('Umbraco decoder initialization..')
app.umbracoDecodersLoaded=true;setTimeout(function(){$(".decoder-slider-new").not('.slick-initialized').slick({dots:false,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',infinite:false,slidesToShow:4,slidesToScroll:1,focusOnSelect:true,responsive:[{breakpoint:1480,settings:{slidesToShow:3.6,}},{breakpoint:1280,settings:{slidesToShow:2,}},{breakpoint:1024,settings:{slidesToShow:2,}},{breakpoint:600,settings:{slidesToShow:1.2,}},{breakpoint:480,settings:{slidesToShow:1.1,}},{breakpoint:320,settings:{slidesToShow:1.1,}}]});},1500);self.update();self.showHidePackagePrices();}
self.DecoderGetNow=function(e){var packageDetailsURL=e.item.decoder.properties.ProductMoreLink;window.RedirectTargetOrgin(e,packageDetailsURL);}
self.showHidePackagePrices=function(){if(app.dualCurrencyApplicable&&!self.notDualCurrency){$('.price.dual-currency').show();$('.price.single-currency').hide();$('.dual').show();$('.single').hide();}
else{$('.price.dual-currency').hide();$('.price.single-currency').show();$('.dual').hide();$('.single').show();}
self.update();}
self.FixErrorNow=function(e){self.parent.HandleActiveTab("showFixError")}
self.PackageGetNow=function(e){self.hideChangePackage=dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(self.hideChangePackage){site.factory.ShowModelPopup('success','','Option for change of package is currently not available online. Please call us on the 4668585 or send an email to DStvcustomerservice@vitiro.org','',false,true);}else{window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:'eec.productClickGetnow',ecommerce:{click:{actionField:{list:'Self Service'},products:[{id:e.item.package.properties.Code,name:e.item.package.properties.Name.toString().toLowerCase().replaceAll(new RegExp('dstv|bouquet|add-on|is20|e36|standalone|e/afr|w/afr| ','gi'),'').trim(),price:e.item.package.properties.Price,brand:'DStv',category:'DP Change Package',variant:'',position:''}]}}});self.parent.HandleActiveTab("showChangePackage")}}
self.PackageKnowMore=function(e){let packageDetailsURL,selectedPackage='';if(self.isWebUni){selectedPackage=e.item.package.properties.Name.replace(/\s+/g,'-');packageDetailsURL=`https://www.dstv.com${window.culture}/buy/dstv-packages/dstv-${selectedPackage}`;}else{selectedPackage=e.item.package.title.replace(/\s+/g,'-');packageDetailsURL=`${window.culture}/packages/${selectedPackage}`;}
window.RedirectTargetOrgin(e,packageDetailsURL);}
self.AmountToPay=function(){if(app.dualCurrencyApplicable)
return app.paymentduedetails.properties.amountToPayEtb.value;return app.paymentduedetails.properties.amountToPay.value;}
self.onSmartcardDropdownChange=function(e){let selectedItem=$(ddlSmartcards).val();app.smartcard=selectedItem;app.forceReload=true;self.ViewSubscription()
self.FetchAmountToPay()
self.update();jcf.replaceAll();window.SessionSave("app",app);}
self.OnGetStreamingLive=function(e){let params={showmodel:true,showclosebutton:true};riot.mount('tag-dash-get-streaming-live',params);}
self.getDsoChannelsData=function(){self.dsoChannelCount=0;self.dsoAudioChannelsCount=0;self.update();if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apipackageguide/api/v1/PackageGuide/GetChannelsByPackage?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}&Package=`+app.premPackageCode;site.factory.Get(url,null,self.onGetDsoChannelsSuccess,self.onGetDsoChannelsError,false,false,true);}else{let url=dstvApp.DSOAPIUrl+`/apipackageguide/api/v1/PackageGuide/GetChannelsByPackage?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}&Package=`+app.premPackageCode;site.factory.Get(url,self.token,self.onGetDsoChannelsSuccess,self.onGetDsoChannelsError);}}
self.onGetDsoChannelsSuccess=function(data){console.log('Account: Fetching channels data from DSO successful');if(data){self.dsoChannelCount=2*Math.trunc(data.channelCount/2);let audioChannelsData=data.genres.filter(x=>x.genrename.toLowerCase().trim()=='audio')[0];if(audioChannelsData)
self.dsoAudioChannelsCount=audioChannelsData.channels.length;}
self.update();}
self.onGetDsoChannelsError=function(err){console.log('Account: Error in Fetching channels data from DSO');}
self.SubscriberStatus=function(){self.smartcardForSubscriberStatus=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard)[0];let smartcardStatus=self.smartcardForSubscriberStatus?self.smartcardForSubscriberStatus.primaryService.status.toUpperCase():null;self.disconnectedSmartcard=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';if(self.disconnectedSmartcard){self.primaryPackageDisconnected=true;app.score=0;}
if((!app.subsStatusLoaded||app.forceReload)&&dstvApp.ShowPremiumStatus&&self.isPremiumStatusApplicable&&!self.primaryPackageDisconnected){console.log('Account : Fetching subscriber status started...');app.subsStatusLoaded=false;self.update();var reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"customerNumber":app.customernumber,"accountNumber":app.primaryaccountnumber.toString()};if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+'/apisubscriberpremiumstatus/api/v1/SubscriberPremiumStatus/GetSubscriberStatus';site.factory.Post(url,reqBody,null,self.onSubscriberStatusSuccess,self.onSubscriberStatusError,false,false,true,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=dstvApp.DSOAPIUrl+'/apisubscriberpremiumstatus/api/v1/SubscriberPremiumStatus/GetSubscriberStatus';site.factory.Post(url,reqBody,self.token,self.onSubscriberStatusSuccess,self.onSubscriberStatusError);});}}
else{console.log('Account : Subscriber status already loaded OR disconnected user');app.showUpgradeSection=false;app.subsStatusLoaded=true;riot.mount('tag-header-premium-status');}}
self.onSubscriberStatusSuccess=function(data){console.log('Account : Subscriber status loaded.');app.subscriberPremiumStatus=data;app.subsStatusLoaded=true;app.showUpgradeSection=false;if(data.subscriberStatus&&data.subscriberStatus.length>0){self.showActiveInactiveIcons(data);}
riot.mount('tag-header-premium-status');self.update();}
self.showActiveInactiveIcons=function(data){try{app.subsStatus=data.subscriberStatus.map((status)=>{if(status){activePremiumClass=status.activePrinciple>0?'active':'inactive';exploraClass=status.explora>0?'active':'inactive';showmaxPlayClass=status.showmaxPlay>0?'active':'inactive';dstvNowPlayClass=status.dStvNowPlay>0?'active':'inactive';boxOfficeRentalClass=status.boxOfficeRental>0?'active':'inactive';pvrClass=status.pvr>0?'active':'inactive';score=status.score?status.score:0;}
return{activePremiumClass:activePremiumClass,exploraClass:exploraClass,showmaxPlayClass:showmaxPlayClass,dstvNowPlayClass:dstvNowPlayClass,boxOfficeRentalClass:boxOfficeRentalClass,pvrClass:pvrClass,score:score}});app.subsStatus=app.subsStatus[0];$('#premStatusBar')[0].value=app.subsStatus.score;if(app.subsStatus&&app.subsStatus.activePremiumClass=='inactive')
app.showUpgradeSection=true;}
catch{console.log('Account : Error while mapping Subscriber Premium status data.');}
window.SessionSave("app",app);self.update();}
self.onSubscriberStatusError=function(err){console.log('Account : Error while fetching Subscriber status.');app.subsStatusLoaded=true;app.subscriberPremiumStatus=null;app.subsStatus=null;if(err.responseJSON&&err.responseJSON.StatusCode==404){console.log(err.responseJSON.StatusCode+' - '+err.responseJSON.Message);app.showUpgradeSection=true;$('#premStatusBar')[0].value=0;}
else{}
riot.mount('tag-header-premium-status');self.update();}
self.onFindOutMore=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showChangePackage");riot.mount('tag-dash-premium-status',{showComponent:true});}
self.onUpgradeNow=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showChangePackage");if(app.subsStatus)
riot.mount('tag-dash-premium-status',{showComponent:true});else
riot.mount('tag-dash-premium-status',{showComponent:true,showOnlyPremiumCard:true});}
self.onReconnectNow=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showPayment");}
self.onEditClick=function(){window.HandleActiveTab("showMore");riot.mount('tag-update-user-details',{showComponent:true});}
self.LogAnalyticsData=function(e){let action=e.currentTarget.attributes["action"].value;let dataForAnalytics=app.subscriberPremiumStatus?app.subscriberPremiumStatus.subscriberStatus[0]:null;if(dataForAnalytics){window.dataLayer=window.dataLayer||[];dataLayer.push({event:'100Percent_Premium_'+action,customernumber:dataForAnalytics.customerNumber,accountnumber:dataForAnalytics.accountNumber});}}})
riot.tag2('tag-account-self-service','<section class="section self-service clearfix collapsible3"> <span id="close-message3" class="close-message3"> </span><div class="d-flex relative align-items-center justify-content-between"> <div class="mb-4 main"><h4>{langTranslateApp.dashTryoutSelfService}</h4></div><span class="arrows-selfService"></span></div><div class="self-service-slider self-service-main-content"><div class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><img class="dstv-now-icon-img" src="/media/11116/dstv-now.png"></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="WATCHNOWSTREAMING"><span class="btn btn-primary"><span class="heading">{langTranslateApp.menuWatch}</span><span>{langTranslateApp.dashDStvOnline}</span></span></div></div></a></div><div class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-manage-profile"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="UPDATEDETAILS"><span class="btn btn-primary"><span class="heading">{langTranslateApp.edit}</span><span>{langTranslateApp.dashDetails}</span></span></div></div></a></div><div if="{hideChangePackage}" class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-change-package"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="CHANGEPACKAGE"><span class="btn btn-primary"><span class="heading">{langTranslateApp.dashChangeWord}</span><span>{langTranslateApp.dashfixerrorPackage}</span></span></div></div></a></div><div class="self-service-content" if="{!app.isCurrDVSSmartcard && !app.isLiberia}"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><img class="show-max-img-icons show" src="/media/11115/boxoffice-small.png"></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="RENTMOVIES"><span class="btn btn-primary"><span class="heading">{langTranslateApp.dashRent}</span><span>{langTranslateApp.dashMovies}</span></span></div></div></a></div><div class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-payment"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="PAYMENTHISTORY"><span class="btn btn-primary"><span class="heading">{langTranslateApp.dashTransaction}</span><span>{langTranslateApp.dashHistory}</span></span></div></div></a></div><div class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-payment"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="MAKEPAYMENT"><span class="btn btn-primary"><span class="heading">{langTranslateApp.make}</span><span>{langTranslateApp.awareness3dHeaderText1}</span></span></div></div></a></div><div if="{airtime}" class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><img class="show-max-img-icons show air" src="/media/11642/icon-airtimex3-1.png"></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="TOPUPAIRTIME"><span class="btn btn-primary"><span class="heading">Top Up!</span><span>{langTranslateApp.subairtimes}</span></span></div></div></a></div><div if="{isDvsApplicable && !app.isCurrDVSSmartcard}" class="self-service-content"><a href="javascript:void(0);"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-DStv-icon-DvS-icon"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="GETSTREAMINGACC"><span class="btn btn-primary"><span class="heading">{langTranslateApp.MorePageCardStreamingPrimaryHeading}</span><span>{langTranslateApp.MorePageCardStreamingSecondaryHeading}</span></span></div></div></a></div><div class="self-service-content" if="{showShowmax && showShowmaxRibbon}"><a href="javascript:void(0);"><div class="ssItem addbx"><div class="ribbon-bx"><img if="{app.showmaxDiscountValue == \'50\'}" src="/media/11387/ribbon-50.png"> <img if="{app.showmaxDiscountValue == \'100\'}" src="/media/11388/ribbon-100.png"></div><div class="content"><div class="iconDiv"><img class="show-max-img-icons" src="/media/11110/showmax_logo-w.svg"></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="ADDSHOWMAX"><span class="btn btn-primary"><span class="heading">{app.showmaxCardCaption}</span><span>Showmax</span></span></div></div></a></div><div if="{!app.isCurrDVSSmartcard}" class="self-service-content"><a><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-fix-errors"></i></div></div><div class="btnDiv" onclick="{SelfServiceClick}" action="FIXERROR"><span class="btn btn-primary"><span class="heading">{langTranslateApp.fix}</span><span>{langTranslateApp.error}</span></span></div></div></a></div><div class="self-service-content"><a href="javascript:void(0)" action="LIVECHAT" class="content_adjustment" onclick="window.openChatWindow()" if="{!showChatPopup}"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-wechat-outline"></i></div></div><div class="btnDiv"><span class="btn btn-primary"><span class="heading">{langTranslateApp.NeedHelptxt}</span><span>{langTranslateApp.Chattxt}</span></span></div></div></a></div><div class="self-service-content"><a href="{dstvApp.ContactUsURL}" onclick="window.RedirectTargetOrgin"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-contact"></i></div></div><div class="btnDiv"><span class="btn btn-primary"><span class="heading">{langTranslateApp.contact}</span><span>{langTranslateApp.us}</span></span></div></div></a></div><span if="{showRewards && !app.isCurrDVSSmartcard}"><div class="self-service-content"><a href="{dstvApp.ContactUsURL}" target="_blank"><div class="ssItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-find-a-installer"></i></div></div><div class="btnDiv"><span class="btn btn-primary"><span class="heading">{langTranslateApp.dashBoxOfficeGetYour1}</span><span>{langTranslateApp.menuRewards}</span></span></div></div></a></div></span></div></section>','tag-account-self-service,[riot-tag="tag-account-self-service"],[data-is="tag-account-self-service"]{ visibility: visible; } tag-account-self-service select,[riot-tag="tag-account-self-service"] select,[data-is="tag-account-self-service"] select{ display: none !important; }','',function(opts){var self=this;self.showShowmax=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);self.showShowmaxRibbon=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);if(app.isCurrDVSSmartcard){self.showShowmax=dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)}
self.showRewards=dstvApp.RewardCountryList.includes(dstvApp.countryabbreviation);self.airtime=dstvApp.AirtimeCountryList.includes(dstvApp.countryabbreviation);self.hideChangePackage=!dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);self.isMovieAddonApplicable=dstvApp.movieAddonCountryList.includes(dstvApp.countryabbreviation);self.hideDStvOnline=!dstvApp.NoDStvOnlineCountryList.includes(dstvApp.countryabbreviation);self.isDvsApplicable=dstvApp.DvsCountries.includes(dstvApp.countryabbreviation)&&dstvApp.EnableDvsOnDashboard;self.on('mount',function(){if(app.isHideMovieAddonSelfserviceCard==undefined){self.movieAddonFlag="MOVIEADDONCHANGEPACKAGE";}
else{self.movieAddonFlag="MOVIEADDON";}
self.InitializeSlider();})
self.InitializeSlider=function(){$(".self-service-slider").not('.slick-initialized').slick({dots:false,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',infinite:false,slidesToShow:4.1,slidesToScroll:1,focusOnSelect:false,responsive:[{breakpoint:1280,settings:{slidesToShow:4.1,}},{breakpoint:1024,settings:{slidesToShow:3,}},{breakpoint:600,settings:{slidesToShow:2,}},{breakpoint:480,settings:{slidesToShow:1.1,}}]});}
self.SelfServiceClick=function(e){let action=e.currentTarget.attributes["action"].value;switch(action){case 'PAYMENTHISTORY':console.log(action);window.HandleActiveTab("showMore");riot.mount('tag-transaction-history',{showComponent:true});break;case 'UPDATEDETAILS':console.log(action);window.HandleActiveTab("showMore")
riot.mount('tag-update-user-details',{showComponent:true});break;case 'MAKEPAYMENT':console.log(action);window.HandleActiveTab("showPayment")
break;case 'CHANGEPACKAGE':console.log(action);window.HandleActiveTab("showChangePackage")
break;case 'FIXERROR':console.log(action);window.HandleActiveTab("showFixError")
break;case 'ADDSHOWMAX':console.log(action);window.HandleActiveTab("showMore")
$('#more-tab-showmax-section').show();riot.mount('tag-showmax-card',{showComponent:true});break;case 'RENTMOVIES':console.log(action);window.HandleActiveTab("showMore")
riot.mount('tag-dash-boxoffice',{showComponent:true});break;case 'TOPUPAIRTIME':window.HandleActiveTab("showMore")
riot.mount('tag-buy-airtime',{showComponent:true,showNotice:true});break;case 'MOVIEADDON':window.HandleActiveTab("showPayment");break;case 'MOVIEADDONCHANGEPACKAGE':window.HandleActiveTab("showChangePackage");break;case 'GETSTREAMINGACC':$('#commonModalPopup2').modal('show');break;case 'CANCELSTREAMING':$('#commonModalPopup3').modal('show');break;case 'WATCHNOWSTREAMING':window.open(dstvApp.DstvNowURL,'_blank');break;default:console.log(action);break;}}})
riot.tag2('tag-dash-view-all-subscription','<div class="modal fade dashboardModal view-sub-add-onns" id="commonModalPopup1" role="dialog"> <div class="webform container modal-dialog modal-lg feedback-dialog"> <div class="modal-content"> <div class="modal-body"> <div class="container-fluid main-section"> <div class="popup {indicatorTypeClass}"> <div class="row"> <div class="modal-content-inner"> <div> <button type="button" class="payment-close movie-add-button" href="javascript:void(0)" onclick={ModalClose0101} data-dismiss="modal">X</button> <div class="My-Subscriptions">{langTranslateApp.myPackages}</div> <section class="Change-package-section-main ViewSubscription-add-on" id="ViewSubscription"> <div class="movie-add-on-title"><span>{langTranslateApp.primaryPackage}</span></div> <div class="main-view-subscription"> <div class="master-top-package-info"> <div class="main-top-package-info add-on-sub {app.currentSmartcardPackage.primaryService.productName}"> <div class="package-info-left col-lg-5 col-xs-5 col-sm-5 col-md-5 movie-add-on-left"><span class="icon-pack icon-{app.currentSmartcardPackage.primaryService.productCode}"></span></div> <div class="package-info-right {app.currentSmartcardPackage.primaryService.productCode} {app.currentSmartcardPackage.primaryService.productName} col-lg-7 col-xs-7 col-sm-7 col-md-7"> <div class="backgroundimg movie-sub-img"></div> <div class="smartcard-add"> </div> </div> </div> <div class="second-top-package-info PRWE36 col-lg-12 col-xs-12 col-sm-12 col-md-12 Premium W/Afr E36 {app.currentSmartcardPackage.primaryService.productCode} {app.currentSmartcardPackage.primaryService.productName}"> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-first"> <div class="package-text-price">{langTranslateApp.accountcardpackageprice}</div> <div if="{!app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {app.currentSmartcardPackage.primaryService.price || 0.00}</div> <div if="{app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {app.currentSmartcardPackage.primaryService.localPrice.amount || 0.00}</div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-second"> <div class="smartcardStatus">{langTranslateApp.dashChangePackageStatus}</div> <div class="Status-info {app.currentSmartcardPackage.primaryService.status}"><img class="icon-background-img" src="/media/8268/icon-tick.svg" /><span class="icon-icon-warning"></span><span id="status" if="{dstvApp.language == \'English\'}">{app.currentSmartcardPackage.primaryService.status}</span><span id="status" if="{dstvApp.language == \'Portuguese\' && dashSmartCardNumberStatus == \'Active\'}">Activo</span><span id="status" if="{dstvApp.language == \'Portuguese\' && dashSmartCardNumberStatus == \'Disconnected\'}">Desconectado</span></div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-third"> <div class="package-box-bottom-right-bottom add-bottom"><a href="javascript:void(0)" onclick="{ChangePackage}"> <span class="viewall"><strong>{langTranslateApp.dashChangeWord}</strong> {langTranslateApp.dashfixerrorPackage}</span> <span class="iconDiv"><i class="icon icon-icon-change-package"></i></span> </a></div> </div> </div> </div> <div class="clearfix"></div> <div class="master-top-package-info"> <div class="movie-add-on-title main" if="{app.AddOnService && app.AddOnService.length > 0 && app.AddOnService != \'N/A\' || addonPackageListItem.length > 0}"><span class="">Add-on</span></div> <div class="clearfix"></div> <div class="master-top-addon-list" each="{currentAddOn in addonPackageListItem}"> <div class="main-top-package-info add-on-sub {currentAddOn.description}"> <div class="package-info-left col-lg-5 col-xs-5 col-sm-5 col-md-5 movie-add-on-left"><span class="icon-pack icon-{currentAddOn.productCode}"></span></div> <div class="package-info-right {currentAddOn.productCode} col-lg-7 col-xs-7 col-sm-7 col-md-7"> <div class="backgroundimg movie-sub-img"></div> <div class="smartcard-add"> </div> </div> </div> <div class="second-top-package-info PRWE36 col-lg-12 col-xs-12 col-sm-12 col-md-12 Premium W/Afr E36 {currentAddOn.productCode} {currentAddOn.description}"> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-first"> <div class="package-text-price">{langTranslateApp.accountcardpackageprice}</div> <div if="{!app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {currentAddOn.price || 0.00}</div> <div if="{app.dualCurrencyApplicable}" class="package-price">{dstvApp.countrycurrency.toUpperCase()} {currentAddOn.localPrice.amount || 0.00}</div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-second"> <div class="smartcardStatus">{langTranslateApp.dashChangePackageStatus}</div> <div class="Status-info {currentAddOn.status}"><img class="icon-background-img" src="/media/8268/icon-tick.svg" /><span class="icon-icon-warning"></span><span id="status" if="{dstvApp.language == \'English\'}">{currentAddOn.status}</span><span id="status" if="{dstvApp.language == \'Portuguese\' && currentAddOn.status == \'Active\'}">Activo</span><span id="status" if="{dstvApp.language == \'Portuguese\' && currentAddOn.status == \'Disconnected\'}">Desconectado</span></div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 col-md-4 second-top-third"> <div class="package-box-bottom-right-bottom add-bottom"><a href="javascript:void(0)" onclick="{ChangePackage}"> <span class="viewall"><strong>Manage</strong> Add-on</span> <span class="iconDiv"><i class="icon icon-icon-change-package"></i></span> </a></div> </div> </div> <div class="clearfix add-on-package"></div> </div> </div> </div> </section> </div> </div> <div class="modal-cta" if="{opts.showclosebutton}"><a id="modalClose0101" href="javascript:void(0)" onclick={ModalClose0101} class="cta " data-dismiss="modal">{opts.closebuttontext || "Close"}</a> </div> </div> </div> </div> <div class="clearfix"></div> </div> </div> </div></div>','tag-dash-view-all-subscription,[riot-tag="tag-dash-view-all-subscription"],[data-is="tag-dash-view-all-subscription"]{ visibility: visible; } tag-dash-view-all-subscription select,[riot-tag="tag-dash-view-all-subscription"] select,[data-is="tag-dash-view-all-subscription"] select{ display: none !important; }','',function(opts){var self=this;self.on('mount',function(){if(opts.showmodel){$('#commonModalPopup1').modal('show');self.addonPackageListItem=app.viewSubscriptionResponse.filter(sc=>sc.smartcardNumber==app.smartcard)[0].services.filter((service)=>{return((service.type=='Addon'||service.description.toLowerCase().includes('add-on'))&&service.status.includes('Active'));});self.update();}});self.ChangePackage=function(){self.hideChangePackage=dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(self.hideChangePackage){site.factory.ShowModelPopup('success','','Option for change of package is currently not available online. Please call us on the 4668585 or send an email to DStvcustomerservice@vitiro.org','',false,true);}else{if(app.packageLoaded)
{$('#commonModalPopup1').modal('hide');window.HandleActiveTab("showChangePackage");}}}
self.ModalClose0101=function(e){if(typeof opts.callback==='function')
opts.callback();}})
riot.tag2('tag-whats-hot','<section class="you-may-like-section clearfix collapsible6"><span id="close-message6" class="close-message6"></span><h3>{app.whatsHotHeading}</h3><div class="topPic whats-hot-slider"><a class="no-ajaxy media-url slider-item whats-hot-card {item.title}" href="{item.link}" onclick="{window.RedirectTargetOrgin}" target="_blank" each="{item, index in app.whatsHot}"><div class="figure"><div class="tpopics-main"><img src="{item.imageURL}" alt="" /><div class="img-overlay text-white"><div class="figcaption"><ul class="list-inline d-flex align-items-center justify-content-between"><li class="list-inline-item"> <i class="icon-play s-48"></i></li></ul><div class="text-center mt-5 BO_{item.title}"><h5>{item.title}</h5></div></div></div><div class="toppics-item-text"><div class="toppics-heading"><h5>{site.factory.decodeHtmlEntities(item.title)} </h5></div></div></div></div></a></div></section>','tag-whats-hot,[riot-tag="tag-whats-hot"],[data-is="tag-whats-hot"]{ visibility: visible; } tag-whats-hot select,[riot-tag="tag-whats-hot"] select,[data-is="tag-whats-hot"] select{ display: none !important; }','',function(opts){var self=this;self.on('mount',function(){if(app.whatsHot){app.whatsHot.map(x=>{x.title=site.factory.replaceAmpersand(site.factory.decodeHtmlEntities(x.title))});self.update();self.InitializeWhatsHotSlider();}})
$(".close-message6").click(function(){$(".collapsible6").toggleClass("collapsed");});self.InitializeWhatsHotSlider=function(){$(".whats-hot-slider").not('.slick-initialized').slick({dots:false,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',slidesToShow:4.1,slidesToScroll:1,focusOnSelect:true,responsive:[{breakpoint:1480,settings:{slidesToShow:4.1,}},{breakpoint:1280,settings:{slidesToShow:4,}},{breakpoint:1024,settings:{slidesToShow:3,}},{breakpoint:600,settings:{slidesToShow:2.2,}},{breakpoint:480,settings:{slidesToShow:1,}},{breakpoint:320,settings:{slidesToShow:1,}}]});$(".whats-hot-card").click(function(e){window.RedirectTargetOrgin(e);})
self.update();}})
riot.tag2('tag-you-may-like-section','<section class="you-may-like-section clearfix collapsible5"> <span id="close-message5" class="close-message5"></span> <h3>{app.ymlHeading}</h3> <div class="you-may-like-slider"> <div class="slide-item" each="{item, index in app.youMayAlsoLike}"> <div class="slide-wrapper"> <a href="{item.link}" onclick="{window.RedirectTargetOrgin}" target="_blank"> <div class="slide-content"> <img src="{item.imageURL}" alt="Card Image" class="slider-img"> <div class="slide-caption YML_{item.title}">{item.title}</div> </div> </a> </div> </div> </div></section>','tag-you-may-like-section,[riot-tag="tag-you-may-like-section"],[data-is="tag-you-may-like-section"]{ visibility: visible; } tag-you-may-like-section select,[riot-tag="tag-you-may-like-section"] select,[data-is="tag-you-may-like-section"] select{ display: none !important; }','',function(opts){var self=this;self.on('mount',function(){if(app.ymlHeading)
app.ymlHeading=site.factory.decodeHtmlEntities(app.ymlHeading);if(app.youMayAlsoLike)
app.youMayAlsoLike.map(x=>{x.title=site.factory.decodeHtmlEntities(x.title),x.imageURL=site.factory.decodeHtmlEntities(x.imageURL)});self.update();setTimeout(()=>{$(".you-may-like-slider").not('.slick-initialized').slick({dots:false,arrows:true,prevArrow:'<button class="slick-prev"><span class="icon-ico-arrow-next"></span></button>',nextArrow:'<button class="slick-next"><span class="icon-ico-arrow-next"></span></button>',slidesToShow:4.1,slidesToScroll:1,focusOnSelect:true,responsive:[{breakpoint:1480,settings:{slidesToShow:4.1,}},{breakpoint:1280,settings:{slidesToShow:4,}},{breakpoint:1024,settings:{slidesToShow:3,}},{breakpoint:600,settings:{slidesToShow:2.2,}},{breakpoint:480,settings:{slidesToShow:1,}},{breakpoint:320,settings:{slidesToShow:1,}}]});},1500)})
$(".close-message5").click(function(){$(".collapsible5").toggleClass("collapsed");});})
riot.tag2('tag-more-service','<div class="full-view-ss"> <div class="container"> <div class="content-wrapper more-details-wrapper main-top-Details-info clearfix"> <div class="update-details-inner"> <div class="row"> <div class="col-lg-6 col-lg-offset-3 more-user-bx"> <div class="update-details-top text-center"> <div class="profile-picture-box"> <div class="update-photo-wrapper"> <div class="profile-photo-box"> <div class="profile-photo-box-inner"><img src="/media/11090/user-default.jpg" alt="Profile Photo" /></div> <a href="javascript:void(0)" class="photo-edit-icon hidden"><span class="pic-edit"> <img src="/media/8619/materialicon-1.svg" class="pic-edit-icon"></span></a> </div> </div> </div> <div class="profile-details clearfix"> <h3>{app.customername}</h3> </div> <div class="progress-bx progress-bx-two"> <div class="progressBar"><progress id="file" value="{score}" max="100"></progress></div> </div> <div class="premium-bx-bottom"> <div if="{!primaryPackageDisconnected}" class="title">Get your <span class="bold">100% </span> Experience</div> <div if="{primaryPackageDisconnected}" class="title title-two">Reconnect to see your PREMIUM STATUS</div> </div> </div> <div class="premium-bx-top mb-3"> <div class="row"> <div class="col-lg-12 text-center"> <div if="{!hasReachedPremium}" class="title"><span class="txt-one">You are </span><span class="bold txt-three"> {100-app.subsStatus.score}% </span> <span class="txt-four">away </span></div> <div if="{hasReachedPremium}" class="title"><strong>Congratulations</strong> On Reaching <strong>100% Premium!</strong></div> </div> <div if="{!primaryPackageDisconnected}" class=" col-lg-12 text-left mt-1"> <div class="icon-status icon-status-two test"> <div class="icon-bx-top"> <div class="icon-ppremium {app.subsStatus.activePremiumClass}"></div> <div class="icon-streaming {app.subsStatus.dstvNowPlayClass}"></div> <div class="icon-showmax {app.subsStatus.showmaxPlayClass}"></div> <div if="{!app.isLiberia}" class="icon-bxoffice {app.subsStatus.boxOfficeRentalClass}"></div> <div class="icon-explore {app.subsStatus.exploraClass}"></div> <div class="icon-pvr {app.subsStatus.pvrClass}"></div> </div> <div class="clearfix"></div> </div> </div> </div> </div> </div> <div class="col-lg-12"><div class="more-content"> <a if="{hideDStvOnline}" href="javascript:void(0)" action="WATCHNOWSTREAMING" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img src="/media/11116/dstv-now.png"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.watch}</span> <span>{langTranslateApp.dashDStvOnline}</span> </span> </div> </div> </a> <a  href="javascript:void(0)" action="UPDATEDETAILS" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-os-ios"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.edit}</span> <span>{langTranslateApp.myDetails}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="CHANGEPACKAGE" onclick="{OnCardClick}" if="{showBoxoffice}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-change-package"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashChangePackage}</span> <span>Package</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="TRANSACTIONHISTORY" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img src="/media/11117/icon-payment-history.svg"></img> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashTransaction}</span> <span>{langTranslateApp.dashHistory}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="PAYMENTS" onclick="{OnCardClick}" if="{showMakePayment}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-payment"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.make}</span> <span>{langTranslateApp.awareness3dHeaderText1}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="TOPUPAIRTIME" onclick="{OnCardClick}" if="{showAirtime}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img class="show-max-img-icons show air time" src="/media/11642/icon-airtimex3-1.png"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashBoxOfficeTop}</span> <span>{langTranslateApp.dashAirtime}</span> </span> </div> </div> </a> <a if="{isDvsApplicable && !app.isCurrDVSSmartcard}" href="javascript:void(0)" action="GETSTREAMINGACC" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-streaming-circle"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.MorePageCardStreamingPrimaryHeading}</span> <span>{langTranslateApp.MorePageCardStreamingSecondaryHeading}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="RENTMOVIES" onclick="{OnCardClick}" if="{showBoxoffice && !app.isCurrDVSSmartcard && !app.isLiberia}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img src="/media/11115/boxoffice-small.png"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashRent}</span> <span>{langTranslateApp.dashMovies}</span> </span> </div> </div> </a> <!--<a href="{dstvApp.USSDCode}" action="" onclick="" if="{airtime}"><div class="msItem"><div class="content"><div class="iconDiv"><img class= "show-max-img-icons show air time" src="/media/11642/icon-airtimex3-1.png"></div></div><div class="btnDiv"><span class="btn btn-primary"><span class="heading">{langTranslateApp.airtimesmain}</span><span>{langTranslateApp.subairtimes}</span></span></div></div></a>--> <a href="javascript:void(0)" action="ADDSHOWMAX" onclick="{OnCardClick}" if="{showShowmax && showShowmaxRibbon}"> <div class="msItem addbx"> <div class="ribbon-bx ribbon-more"> <img if="{app.showmaxDiscountValue == \'50\'}" src="/media/11387/ribbon-50.png"> <img if="{app.showmaxDiscountValue == \'100\'}" src="/media/11388/ribbon-100.png"> </div> <div class="content"> <div class="iconDiv"> <img src="/media/11110/showmax_logo-w.svg"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{app.showmaxCardCaption}</span> <span>Showmax</span> </span> </div> </div> </a> <a if="{!!app.isCurrDVSSmartcard}" href="javascript:void(0)" action="CANCELSTREAMING" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-cancel-streaming"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.MorePageCardCancelStreamingPrimaryHeading}</span> <span>{langTranslateApp.MorePageCardStreamingSecondaryHeading}</span> </span> </div> </div> </a> <a if="{!app.isCurrDVSSmartcard}" href="javascript:void(0)" action="FIXERROR" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-fix-errors"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.fix}</span> <span>{langTranslateApp.error}</span> </span> </div> </div> </a> <a href="{dstvApp.ContactUsURL}" target="blank"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-contact"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.contact}</span> <span>{langTranslateApp.us}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="CLAIMREWARDS" onclick="{OnCardClick}" if="{showRewards}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img src="/media/11114/dstv-thanks.svg"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashBoxOfficeGetYour3}</span> <span>{langTranslateApp.dashRewards}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="CHANGESETTING" onclick="{OnCardClick}" if="{showChangeSettings}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-settings"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashChangeWord}</span> <span>Settings</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="BUYDATA" onclick="{OnCardClick}" if="{showBuyData}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-find-a-installer"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashBuy}</span> <span>{langTranslateApp.dashData}</span> </span> </div> </div> </a> <a href="#" target="blank" if="{showLegalDocuments}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <img src="/media/11113/group-9823.svg"> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashLegal}</span> <span>{langTranslateApp.Documents}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="POWERBALL" onclick="{OnCardClick}" if="{showPowerBall}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-find-a-installer"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashPlay}</span> <span>{langTranslateApp.dashPowerball}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="LIVECHAT" class="veiws" onclick="{OnCardClick}" if="{showChatPopup}"> <div class="msItem livechat"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-wechat-outline"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.liveChatMsg}</span> <span>{langTranslateApp.liveChatOut}</span> </span> </div> </div> </a><!-- <a href="https://api.whatsapp.com/send?phone={dstvApp.whatsAppNumber}&amp;text=%20Hi%20DStv" target="_blank"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-whatsapp-outline"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.NeedHelptxt}</span> <span>{langTranslateApp.Chattxt}</span> </span> </div> </div> </a> --> <a href="javascript:void(0)" action="LIVECHAT" class=" content_adjustment" onclick="{OnCardClick}" if="{showChatPopup}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon icon-icon-wechat-outline"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.NeedHelptxt}</span> <span>{langTranslateApp.Chattxt}</span> </span> </div> </div> </a> <a href="javascript:void(0)" action="LOGOUT" onclick="{OnCardClick}"> <div class="msItem"> <div class="content"> <div class="iconDiv"> <i class="icon login-person-icon"></i> </div> </div> <div class="btnDiv"> <span class="btn btn-primary"> <span class="heading">{langTranslateApp.dashSign}</span> <span>{langTranslateApp.dashOut}</span> </span> </div> </div> </a></div> </div> <div class="clearfix"></div> </div> </div> </div> </div></div><tag-dash-get-streaming-live></tag-dash-get-streaming-live><tag-dash-cancel-streaming></tag-dash-cancel-streaming>','','',function(opts){var self=this;self.showShowmax=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);self.showShowmaxRibbon=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);if(app.isCurrDVSSmartcard){self.showShowmax=dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)}
self.showAirtime=dstvApp.AirtimeCountryList.includes(dstvApp.countryabbreviation)
self.showRewards=dstvApp.RewardCountryList.includes(dstvApp.countryabbreviation)
self.showBoxoffice=!dstvApp.NoBoxOfficeCountryList.includes(dstvApp.countryabbreviation);self.showChangeSettings=[].includes(dstvApp.countryabbreviation)
self.showBuyData=[].includes(dstvApp.countryabbreviation)
self.showLegalDocuments=[].includes(dstvApp.countryabbreviation)
self.showPowerBall=[].includes(dstvApp.countryabbreviation)
self.showMakePayment=!dstvApp.NoOnlinePaymentCountryList.includes(dstvApp.countryabbreviation);self.showChatPopup=((dstvApp.liveChatCountries.includes(dstvApp.countryabbreviation)&&app.loggedin)&&!(dstvApp.liveChatWithComingSoonMessage.includes(dstvApp.countryabbreviation)));self.airtime=dstvApp.AirtimeCountryList.includes(dstvApp.countryabbreviation);self.hideDStvOnline=!dstvApp.NoDStvOnlineCountryList.includes(dstvApp.countryabbreviation);self.subscriberPremiumStatus=app.subscriberPremiumStatus?app.subscriberPremiumStatus.subscriberStatus:null;self.hasReachedPremium=self.subscriberPremiumStatus?(self.subscriberPremiumStatus[0].score==100?true:false):false;self.isDvsApplicable=dstvApp.DvsCountries.includes(dstvApp.countryabbreviation)&&dstvApp.EnableDvsOnDashboard;app.score=0;if(dstvApp.countryabbreviation=='mu')
{self.notDualCurrency=true;app.dualCurrencyApplicable=false;}
self.on('mount',function(){const urlParams=new URLSearchParams(window.location.search);if(urlParams.has('email')&&urlParams.has('email_signature')){app.showmaxEmail=urlParams.get('email');app.showmaxEmailSig=urlParams.get('email_signature');window.SessionSave("app",app);if(app.isVIVR){window.history.pushState({},document.title,window.culture+"/mydstv-account"+app.vivrQueryStr);app.amounttopayloaded=true;}
else window.history.pushState({},document.title,window.culture+"/mydstv-account");window.history.pushState(null,"",window.location.href);window.onpopstate=function(){window.history.pushState(null,"",window.location.href);};window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showComponent:true,showmaxSignUp:true});}});self.OnCardClick=function(e){let action=e.currentTarget.attributes["action"].value;console.log(action);switch(action){case 'FIXERROR':self.parent.HandleActiveTab("showFixError")
break;case 'PAYMENTS':self.parent.HandleActiveTab("showPayment")
break;case 'CHANGEPACKAGE':self.parent.HandleActiveTab("showChangePackage")
break;case 'RENTMOVIES':self.parent.HandleActiveTab("showMore")
riot.mount('tag-dash-boxoffice',{showComponent:true});break;case 'TRANSACTIONHISTORY':self.parent.HandleActiveTab("showMore")
riot.mount('tag-transaction-history',{showComponent:true});break;case 'UPDATEDETAILS':self.parent.HandleActiveTab("showMore")
riot.mount('tag-update-user-details',{showComponent:true});break;case 'ADDSHOWMAX':self.parent.HandleActiveTab("showMore")
$('#more-tab-showmax-section').show()
riot.mount('tag-showmax-card',{showComponent:true});break;case 'LOGOUT':site.trigger('logout');window.location.href=dstvApp.SignInURL;break;case 'LIVECHAT':window.openChatWindow()
break;case 'TOPUPAIRTIME':window.HandleActiveTab("showMore")
riot.mount('tag-buy-airtime',{showComponent:true,showNotice:true});break;case 'GETSTREAMINGACC':$('#commonModalPopup2').modal('show');break;case 'CANCELSTREAMING':$('#commonModalPopup3').modal('show');break;case 'WATCHNOWSTREAMING':window.open(dstvApp.DstvNowURL,'_blank');break;default:break;}}})
riot.tag2('tag-showmax-card','<div if="{showShowmaxSection && showShowmaxCard}" class="showmax {newClass} {showmaxAddonClass} {smaxStatusClass}" style="background-image: url({dstvApp.targetDomain+showmaxUmbracoContent.ShowmaxCardImage});"> <div> <div class="" style="z-index: 9999;height: 200px;" if="{!showMaxLoaded}"> <div class="loading-loader loading"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.dashShowmaxLoading}...</div> </div> </div> </div> <div class="showmax-top-section" if="{noServicesLoadedOnCard}"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p>Remember <b>DStv Premium <span if="{app.isCurrDVSSmartcard}">Streaming</span> </b>includes <b><span class="showmax-color">Showmax</span></b> at</p> <h1><span class="showmax-color">NO COST</span></h1> </div> </div> <div class="txt-wrapper noservice danger-box" if="{noServicesLoadedOnCard}"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax">{langTranslateApp.showmaxdashNoServiceMessage}.</p> <div class="errorUpgradeButtons"><a href="{dstvApp.ContactUsURL}" onclick="{window.RedirectTargetOrgin}" class="cta callnowButton"> {langTranslateApp.subMenuContactUs} <span class="icon-ico-arrow-next"></span></a></div> </div> <div if="{noServicesLoadedOnCard}" class="terms noservice"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> <div if="{showMaxLoaded && isShowMaxApplicable && dstvPremium && !noServicesLoadedOnCard}"> <div if="{!isShowmaxAdded && !primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p>Remember <b>DStv Premium <span if="{app.isCurrDVSSmartcard}">Streaming</span></b> includes <b><span class="showmax-color">Showmax</span></b> at</p> <h1 class="mt-3"><span class="showmax-color">NO COST</span></h1> </div> </div> <div class="txt-wrapper noservice success-box"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>CONGRATULATIONS!</b> <br> You qualify for showmax at 100% discount.</p> </div> <div class="terms noservice"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> </div> <div if="{isShowmaxAdded && isShowmaxActive}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p> Enjoy Your <b>DStv Premium <span if="{app.isCurrDVSSmartcard}">Streaming</span></b> that  Includes <b><span class="showmax-color">Showmax</span><b></p> <!-- <div class="smax-text-box"> <div class="white-head">DO NOT MISS OUT ON</div> <div>the <span class="showmax-color">latest local</span></div> <div>and <span class="showmax-color">international</span></div> <div>shows on <span class="showmax-color">Showmax</span></div> <div>that you get at</div> </div> --> <h1 style="margin-top:5.5em"> <!--<span class="showmax-color">NO COST</span>  <div class="dp-customer">for being a <b>DStv Premium</b> customer !</div>--> <span class="showmax-color">NO COST</span></h1> </div> </div> <div class="terms"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> </div> <div if="{primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p>Remember <b>DStv Premium <span if="{app.isCurrDVSSmartcard}">Streaming</span></b> <br>includes <b><span class="showmax-color">Showmax</span></b> at</p> <!--<h2><span class="showmax-color">100%</span> DISCOUNT</h2>--> <h1><span class="showmax-color">NO COST</span></h1> </div> </div> <div class="txt-wrapper noservice warning-box test"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>YOUR PACKAGE IS DISCONNECTED</b> <br> Please make a payment to reconnect your account.</p> </div> <div class="terms noservice"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> <div class="glass"> <a if="{!isShowmaxAdded && primaryPackageDisconnected}" href="javascript:void(0);" onclick="{onDashPayReconnectShowmax}" class="clearfix">Pay / Reconnect <span class="arrow-next-circle"></span></a> </div> </div> <div if="{isShowmaxAdded && !isShowmaxActive && !primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <h2>Pay and reconnect</h2> <p>To continue watching <br><span class="showmax-color">Showmax</span> at</p> <h1 class="h1-prem"><span class="showmax-color">NO COST</span></h1> </div> </div> <div class="terms"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> </div> </div>  <div if="{showMaxLoaded && isShowMaxApplicable && dstvPremium && !noServicesLoadedOnCard}" class="glass"> <div if="{isShowmaxAdded && isShowmaxActive}" class="clearfix"> <div class="watch-showmax-btn"><a if="{app.showmaxActivationUrlHasAccessCode}" href="javascript:void(0);" onclick="{onDashWatchNowShowmax}"><b>Complete</b>Activation</a><a if="{!app.showmaxActivationUrlHasAccessCode}" href="javascript:void(0);" onclick="{onDashWatchNowShowmax}"><b>Watch</b>Showmax</a></div> <div class="manage-showmax-btn"><a href="javascript:void(0);" onclick="{onDashManageShowmax}"><b>Manage</b>Your Account</a></div> <div class="or-text">Or</div> </div> <a if="{!isShowmaxAdded && !primaryPackageDisconnected}" href="javascript:void(0);" class="clearfix" onclick="{onDashActivateShowmax}">Activate Now<span class="arrow-next-circle"></span></a> <!-- <a id="payReconnectShowmax" if="{(isShowmaxAdded && !isShowmaxActive) || primaryPackageDisconnected}" href="javascript:void(0);" onclick={onDashPayReconnectShowmax} class="clearfix">{langTranslateApp.menuPay+" / "+langTranslateApp.dashReconnect}<span class="arrow-next-circle"></span></a> -->  <div if="{isShowmaxAdded && !isShowmaxActive || primaryPackageActive}" class="clearfix"> <div class="watch-showmax-btn"><a href="javascript:void(0);" onclick="{onShowmaxPending}"><b>Reconnect</b>Showmax</a></div><div class="manage-showmax-btn"><a href="javascript:void(0);" onclick="{onDashManageShowmax}"><b>Manage</b>Your Account</a></div>            <div class="or-text">Or</div>         </div>   </div> <div if="{showMaxLoaded && isShowMaxApplicable && !dstvPremium && !noServicesLoadedOnCard}"> <div if="{!isShowmaxAdded && !primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p>In order to add <span class="showmax-color">Showmax</span> <br> to your {formattedPackageName} at</p> <h2 if="{app.showmaxDiscountValue == \'50\'}"><span class="showmax-color">50%</span> DISCOUNT</h2><h3  if="{app.showmaxDiscountValue == \'50\' && !app.dualCurrencyApplicable}">        <span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.price.value} p/m</span></h3> <h3 if="{app.showmaxDiscountValue == \'50\' && app.dualCurrencyApplicable}"><span class="single" style="display:none"><span class="showmax-price"><span>USD</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>USD</span> {app.showmaxNormalPrice.price.value} p/m</span></span> <span class="dual"><span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.localPrice.amount}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.localPrice.amount} p/m</span></span></h3><h3 if="{app.showmaxDiscountValue == \'0\'}"><span if="{!app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</span><span if="{app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.localPrice.amount} p/m</span> </h3> </div> </div>   <div if="{app.showmaxDiscountValue == \'50\'}" class="txt-wrapper noservice success-box"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>CONGRATULATIONS!</b> <br> You qualify for showmax at 50% discount.</p> </div>           <div class="terms noservice"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div>     <div if="{app.showmaxDiscountValue == \'0\'}" class="txt-wrapper noservice success-box"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>Showmax add-on</b> is compatible with your package, allowing you to activate now !</p> </div>               </div> <div if="{isShowmaxAdded && isShowmaxActive}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p> Enjoy Your <b><span class="casefrmt">{formattedPackageName}<span></b> that <br/>Includes <b><span class="showmax-color">Showmax</span></b> at </p><!-- <div class="smax-text-box"> <div class="white-head">DO NOT MISS OUT ON</div> <div>the <span class="showmax-color">latest local</span></div> <div>and <span class="showmax-color">international</span></div> <div>shows on <span class="showmax-color">Showmax</span></div> <div>that you get at</div> </div> --> <!-- <h2 if="{app.showmaxDiscountValue == \'50\'}"><span class="showmax-color">50%</span> DISCOUNT</h2> --> <h3  if="{app.showmaxDiscountValue == \'50\' && !app.dualCurrencyApplicable}">        <span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.price.value} p/m</span></h3> <h3 if="{app.showmaxDiscountValue == \'50\' && app.dualCurrencyApplicable}"><span class="single" style="display:none"><span class="showmax-price"><span>USD</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>USD</span> {app.showmaxNormalPrice.price.value} p/m</span></span> <span class="dual"><span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.localPrice.amount}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.localPrice.amount} p/m</span></span></h3> </div> </div>            <div class="terms"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> </div> <div if="{primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div> <p>In order to add <span class="showmax-color">Showmax</span> <br> to your {formattedPackageName} at</p> <h2 if="{app.showmaxDiscountValue == \'50\'}"><span class="showmax-color">50%</span> DISCOUNT</h2> <h3  if="{app.showmaxDiscountValue == \'50\' && !app.dualCurrencyApplicable}">        <span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.price.value} p/m</span></h3> <h3 if="{app.showmaxDiscountValue == \'50\' && app.dualCurrencyApplicable}"><span class="single" style="display:none"><span class="showmax-price"><span>USD</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>USD</span> {app.showmaxNormalPrice.price.value} p/m</span></span> <span class="dual"><span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.localPrice.amount}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.localPrice.amount} p/m</span></span></h3> <h3 if="{app.showmaxDiscountValue == \'0\'}"><span if="{!app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</span><span if="{app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.localPrice.amount} p/m</span> </h3> </div> </div> <div class="txt-wrapper noservice warning-box test"> <span class="icon icon-icon-fix-errors errorUpgradeIcon package showmax-errorUpgradeIcon"></span> <p class="noServiceMessage-showmax"><b>YOUR PACKAGE IS DISCONNECTED</b> <br> Please make a payment to reconnect your account.</p> </div> <div class="terms noservice"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> <div class="glass"> <a if="{!isShowmaxAdded && primaryPackageDisconnected}" href="javascript:void(0);" onclick="{onDashPayReconnectShowmax}" class="clearfix">Pay / Reconnect <span class="arrow-next-circle"></span></a> </div></div> <div if="{isShowmaxAdded && !isShowmaxActive && !primaryPackageDisconnected}"> <div class="showmax-top-section"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <div class="percent-off"> <h2>Pay and reconnect</h2> <p>To continue watching Showmax at</p> <h4 if="{app.showmaxDiscountValue == \'50\'}"><span class="showmax-color">50%</span> DISCOUNT</h4> <h3 if="{app.showmaxDiscountValue == \'50\'}"><span class="showmax-price"><span>{dstvApp.countrycurrency}</span> {app.showmaxAddOnDetails.price.value}  p/m</span> <span class="showmax-discount"><span>{dstvApp.countrycurrency}</span> {app.showmaxNormalPrice.price.value} p/m</span> </h3> <h3 if="{app.showmaxDiscountValue == \'0\'}"><span if="{!app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</span><span if="{!app.dualCurrencyApplicable}" class="showmax-price">{dstvApp.countrycurrency.toUpperCase()} {app.showmaxNormalPrice.price.value} p/m</span> </h3> </div> </div> <div class="terms"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">Terms &amp; Conditions Apply </a></div> </div> </div> <div if="{noServicesLoadedOnCard}" class="glass"><a href="{dstvApp.ContactUsURL}" class="clearfix" onclick="{window.RedirectTargetOrgin}"> {langTranslateApp.subMenuContactUs} <span class="arrow-next-circle"></span></a></div> <div if="{showMaxLoaded && isShowMaxApplicable && !dstvPremium && !noServicesLoadedOnCard}" class="glass"> <div if="{isShowmaxAdded && isShowmaxActive}" class="clearfix"> <div class="watch-showmax-btn"><a if="{app.showmaxActivationUrlHasAccessCode}" href="javascript:void(0);" onclick="{onDashWatchNowShowmax}"><b>Complete</b>Activation</a><a if="{!app.showmaxActivationUrlHasAccessCode}" href="javascript:void(0);" onclick="{onDashWatchNowShowmax}"><b>Watch</b>Showmax</a></div> <div class="manage-showmax-btn"><a href="javascript:void(0);" onclick="{onDashManageShowmax}"><b>Manage</b>Your Account</a></div> <div class="or-text">Or</div> </div> <a if="{((!isShowmaxAdded && !primaryPackageDisconnected) || (app.showAddShowmaxBtn && !primaryPackageDisconnected)) && !showMaxStatusPending}" href="javascript:void(0);" class="clearfix" onclick="{onDashActivateShowmax}">Add Showmax <span class="arrow-next-circle"></span></a> <a if="{showMaxStatusPending}" href="javascript:void(0);" class="clearfix" onclick="{onShowmaxPending}">Pay Now<span class="arrow-next-circle"></span></a>         <!--<a id="payReconnectShowmax" if="{(isShowmaxAdded && !isShowmaxActive) || primaryPackageDisconnected}" href="javascript:void(0);" onclick={onDashPayReconnectShowmax} class="clearfix">{langTranslateApp.menuPay+" / "+langTranslateApp.dashReconnect}<span class="arrow-next-circle"></span></a> -->        <div if="{isShowmaxAdded && !isShowmaxActive || primaryPackageActive}" class="clearfix"> <div class="watch-showmax-btn"><a href="javascript:void(0);" onclick="{onDashPayReconnectShowmax}"><b>Reconnect</b>Showmax</a></div>            <div class="manage-showmax-btn" ><a href="javascript:void(0);" onclick="{onDashManageShowmax}"><b>Manage</b>Your Account</a></div>            <div class="or-text">Or</div>         </div>   </div> <div if="{app.showSysErrorMsg && !primaryPackageDisconnected}" onclick={onRefresh} class="glass"><span class="sm-card-status-msg">An error occurred getting Showmax Status.</span><a href="javascript:void(0);" class="sm-card-cta clearfix"><span class="arrow-next-circle"></span>Refresh</a></div> <div if="{!isShowMaxApplicable && showMaxLoaded && !app.noServicesLoaded && !noServicesLoadedOnCard}"> <div class="showmax-top-section no-card-loaded"> <img src="/media/10049/layer1-2x.png" alt="Showmax Logo" class="showmax-icon"> <!-- <h2>{langTranslateApp.dashShowmaxGet}</h2>--> <div> <p>{langTranslateApp.dashShowmaxBestShows}<br><span class="" style="font-size: 12px;">{langTranslateApp.dashShowmaxWatchAnywhere}</span> <br> <span class="terms"><a href="https://showmax.akamaized.net/f/legal/doc/ShowmaxTermsConditions-global-2023-04.pdf" title="Terms and Conditions" target="_blank">{langTranslateApp.dashShowmaxTandC}</a></span></p> <a class="cta" href={showmaxTrialSignUpURL} target="blank" style="background:#fff; margin-top:10px;">{langTranslateApp.dashShowmaxTrial}<span class="icon-ico-arrow-next">&nbsp;</span></a></div> </div> <div class="glass"><a href={showmaxGetItNowURL} target="blank">{langTranslateApp.dashShowmaxGetItNow}<span class="arrow-next-circle">&nbsp;</span></a></div>  </div> <!--<div class="glass"> <a href="javascript:void(0);">Activate Showmax <span class="arrow-next-circle"></span></a><!--<img src="/media/7593/showmax_logo_white.png" alt="ShowMax"> </div>--> </div></div>','','',function(opts){var self=this;self.showShowmaxSection=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation);self.isShowMaxApplicable=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);if(app.isCurrDVSSmartcard){self.isShowMaxApplicable=dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)}
let dotcom=site.env=='PROD'?'.com':'.io';self.showmaxGetItNowURL=`https://secure.showmax${dotcom}/v133.0/website/signup`;self.showmaxTrialSignUpURL=`https://secure.showmax${dotcom}/v133.0/website/signup`
self.showmaxWebsiteLink=`https://secure.showmax${dotcom}`;app.showmaxActivationUrlHasAccessCode=false;app.showAddShowmaxBtn=false;app.showSysErrorMsg=false;self.on('before-mount',function(){});self.on('mount',function(){if(app.loginUrlHasQueryString&&app.loginUrlQueryString.includes("showmax")&&!app.isShowmaxCardLoaded){site.factory.GetJWT().then(function(token){self.token=token;self.showShowmaxCard=true;self.ViewSubscription();self.FetchAmountToPay();});}else{if(!opts.showComponent){self.showShowmaxCard=false;return;}
if(app.isCurrDVSSmartcard){self.showShowmaxCard=dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)?true:false;$('tag-more-service').hide();}
else{self.showShowmaxCard=true;$('tag-more-service').hide();}
self.getAvailableShowmaxContent();self.LoadShowMaxDetails();self.getOrCreateSubscription();}
setTimeout(function(){if(self.dstvPremium){self.newClass=self.isShowmaxActive?"PremiumShowmaxClass":"premShowMaxDisc"}else if(!self.dstvPremium){self.newClass=app.showmaxDiscountValue=='50'?"non-premiumUpper":"non-premiumLower"
if(app.showmaxDiscountValue=='50'){self.smaxStatusClass=self.isShowmaxActive?'activeUpper':'disconnectUpper'}else{self.smaxStatusClass=self.isShowmaxActive?'activeLower':'disconnectLower'}}
self.isShowMaxApplicable=self.isShowMaxApplicable&&!dstvApp.showmaxPackagesNotApplicable.includes(app.selectedCurrentPackageDetails.productCode)?true:false
self.update()
self.isShowMaxApplicable=app.selectedCurrentPackageDetails&&self.isShowMaxApplicable&&!dstvApp.showmaxPackagesNotApplicable.includes(app.selectedCurrentPackageDetails.productCode)?true:false
self.update()},5000)});self.ViewSubscription=function(){if(!app.packageLoaded||app.forceReload){console.log('Account : ViewSubscription started...')
if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,null,self.ViewSubscriptionSuccess,self.ViewSubscriptionError,false,true,true);}else{let url=dstvApp.DSOAPIUrl+`/apiviewsubscription/api/v1/Subscription?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`
site.factory.Get(url,self.token,self.ViewSubscriptionSuccess,self.ViewSubscriptionError);}}
else{console.log('Account : ViewSubscription already loaded')
riot.mount('tag-showmax-card',{showComponent:true});self.getAvailableUmbracoPackages();self.getAvailableUmbracoDecoders();}}
self.ViewSubscriptionSuccess=function(data){console.log('Account : ViewSubscription completed')
app.viewSubscriptionResponse=data;app.forceReload=false;self.packages=data.map((package)=>{if(package.smartcardNumber==app.smartcard)
app.viewingDaysLeft=package.viewingDaysLeft
if(package.services!==null){if(package.services.length>1)
package.services=package.services.sort(function(x,y){return x.psnr-y.psnr})
primaryService=package.services.filter((service)=>{serviceName=service.serviceName.split('-');if(service.serviceName.includes('-')){serviceName=service.serviceName.split('-');}
else if(service.serviceName.toUpperCase().includes('SHOWMAX')){serviceName[0]=service.serviceName.toUpperCase().trim().substring(0,7).trim();serviceName[1]=service.serviceName.toUpperCase().trim().substring(15,7).trim();}
service.productCode=serviceName[0].trim();let pckNameArray=packageName=serviceName[1].toLowerCase().replace('dstv','').trim().split(' ')
service.productName=pckNameArray[0];service.productName+=packageName[1]=='plus'?'plus':'';service.productName=service.productName.replace("'","");service.hideAddonLinkClass=service.status=="Active"?'':' visibility-hidden';currentPackageFullName=service.serviceName;return service.type=='Principal'});if(primaryService.length>1)
primaryService=primaryService.filter((service)=>{return service.status=='Active'})
primaryService=primaryService[0];if(primaryService!=undefined||primaryService!=null&&package.smartcardNumber==app.smartcard){app.CardStatus=primaryService.status;app.MonthlyPrice=primaryService.price;app.ProductCode=primaryService.productCode;app.currentPackageFullName=primaryService.serviceName;if(dstvApp.DualCurrencyCountryList.includes(dstvApp.countryabbreviation))
app.MonthlyPriceDualCurrency=primaryService.localPrice?primaryService.localPrice.amount:null;}
addonServiceList=package.services.filter((service)=>{return(service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on'))&&service.status=='Active'});addonService=package.services.filter((service)=>{return(service.type=='Addon'||service.description.includes('Add-on')||service.description.includes('add-on'))&&service.status=='Active'});addonService=addonService[0]?(addonService[0].serviceName||addonService[0].description):'N/A';app.AddOnService=addonService;app.SmartCardNumber=package.smartcardNumber;app.addonServiceListForSubscription=addonServiceList;window.SessionSave("app",app);}
return{SerialNumber:package.smartcardNumber,smartcardName:package.smartcardName,primaryService:primaryService,addonService:addonService,Status:package.Status,psnr:package.psnr,serviceId:package.serviceId,isPrimarySmartcard:package.isPrimarySc,isXtraView:package.isXtraView,isDvsSc:self.isDvsSc};})
if(app.isCurrDVSSmartcard&&!dstvApp.dvsShowmaxCountries.includes(dstvApp.countryabbreviation)){$('#packageMainSection').addClass('dvsapplied');$('.top-package-card').addClass('dvsapplied');}
app.smartcards=self.packages;app.loadedpackages=true;app.noServicesLoaded=app.smartcards.filter(x=>(x.primaryService!==undefined&&x.primaryService.length!==0&&x.primaryService!=='')).length==0;let sm=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)
app.showTerminatedBouquetScreen=null;if(sm.length&&sm[0].primaryService&&dstvApp.BouquetTermination){app.showTerminatedBouquetScreen=sm[0].primaryService.isExpired}
self.packages=self.packages.filter(x=>x.primaryService);app.currentSmartcardPackage=app.smartcards.filter(x=>x.SerialNumber==app.smartcard)[0];if(!app.selectedCurrentPackageDetails&&app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService){app.selectedCurrentPackageDetails=app.currentSmartcardPackage.primaryService
app.selectedCurrentPackageDetails.PackageCode=app.currentSmartcardPackage.primaryService.productCode?app.currentSmartcardPackage.primaryService.productCode:'';app.selectedCurrentPackageDetails.PackageName=app.currentSmartcardPackage.primaryService.productName?app.currentSmartcardPackage.primaryService.productName:'';app.selectedCurrentPackageDetails.PackagePrice=app.currentSmartcardPackage.primaryService.price?app.currentSmartcardPackage.primaryService.price:'';app.selectedCurrentPackageDetails.PackageDesc=app.currentSmartcardPackage.primaryService.description?app.currentSmartcardPackage.primaryService.description:'';}
if(app.currentSmartcardPackage&&app.currentSmartcardPackage.primaryService)
app.isNotPrimePackage=!app.currentSmartcardPackage.primaryService.productName.includes("premium");self.update();window.SessionSave("app",app);self.getAvailableShowmaxContent();self.LoadShowMaxDetails();self.getOrCreateSubscription();}
self.ViewSubscriptionError=function(err){console.log('Account : ViewSubscription completed with error');console.log(err);}
self.FetchAmountToPay=function(forceReload){if(!app.amounttopayloaded||app.forceReload){console.log('Account : FetchAmountToPay started...')
app.amounttopayloaded=false;self.update();if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,null,self.OnFetchAmountToPaySuccess,self.OnFetchAmountToPayError,false,true,true);}else{let url=`${dstvApp.DSOAPIUrl}atp/api/v1/AmountToPay?country=${dstvApp.country}&customerNumber=${app.customernumber}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,self.token,self.OnFetchAmountToPaySuccess,self.OnFetchAmountToPayError)}}
else
console.log('Account : FetchAmountToPay already loaded')}
self.OnFetchAmountToPaySuccess=function(data){console.log('Account : FetchAmountToPay completed')
app.amounttopayloaded=true;app.forceReload=false;app.paymentduedetails.properties.dueDate={value:data.DueDate.split('T')[0]};if(app.isMauritius){app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.LocalPrice.Currency}}else{app.paymentduedetails.properties.amountToPay={value:Math.round(data.TotalAmountToPay.Value*100)/100}
app.paymentduedetails.properties.currencyCode={value:data.TotalAmountToPay.CurrencyCode}}
app.paymentduedetails.properties.amountToPayEtb=data.TotalAmountToPay.LocalPrice?{value:Math.round(data.TotalAmountToPay.LocalPrice.Amount*100)/100}:null
app.BOAccount=data.Accounts.filter(x=>x.AccountType=="Box Office")[0];app.IsBOCustomer=app.BOAccount&&Object.keys(app.BOAccount).length>0
app.accounts=data.Accounts.map(x=>({AccountNumber:x.AccountNumber,AccountType:x.AccountType}))
app.accountsInfo=data.Accounts;app.primaryaccountnumber=data.Accounts.filter(x=>x.IsDefault)[0].AccountNumber;if(data.Accounts.filter(x=>x.AccountType=='DStvRes')!=undefined){app.qouteLineItems=data.Accounts.filter(x=>x.AccountType=='DStvRes');}else{app.qouteLineItems=data.Accounts.filter(x=>x.AccountType=='DStvComm');}
app.qouteLineItems=app.qouteLineItems.map(x=>({AccountBalance:x.AccountBalance,AmountToPay:x.AmountToPay,DueAmount:x.DueAmount,Quotes:x.Quotes}))[0];if(app.qouteLineItems!=undefined){if(app.qouteLineItems.Quotes)
app.qouteLineItems.Quotes[0].LineItems=app.qouteLineItems.Quotes[0].LineItems.map((x)=>{if(x.InvoiceText.includes('Discount'))
x.DiscountItem=true
return x;})}
window.SessionSave("app",app);self.update();}
self.OnFetchAmountToPayError=function(err){console.log('Account : FetchAmountToPay completed with error');console.log(err);}
window.getOrCreateSubscription=self.getOrCreateSubscription=function(){if(!self.smartcardForShowmax)return;var reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"smartCardNumber":app.smartcard,"customerNumber":app.customernumber,"packageName":self.smartcardForShowmax.primaryService.serviceName};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}${dstvApp.getOrCreateSubscriptionURL}`;site.factory.Post(url,reqBody,null,self.ongetOrCreateSubscriptionSuccess,self.ongetOrCreateSubscriptionError,false,false,true,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=`${dstvApp.DSOAPIUrl}${dstvApp.getOrCreateSubscriptionURL}`;site.factory.Post(url,reqBody,self.token,self.ongetOrCreateSubscriptionSuccess,self.ongetOrCreateSubscriptionError);});}}
self.ongetOrCreateSubscriptionSuccess=function(data){if(data){app.showmaxActivationUrl=data.redirectUrl;if(app.showmaxActivationUrl.includes('access_code'))
app.showmaxActivationUrlHasAccessCode=true;window.SessionSave("app",app);}
self.update();}
self.ongetOrCreateSubscriptionError=function(err){if(err.responseJSON&&err.responseJSON.StatusCode==500){app.showSysErrorMsg=true;console.log(err.responseJSON.Message);}
if(err.responseJSON&&err.responseJSON.StatusCode==404&&showmaxProductDetails&&showmaxProductDetails.length==0){app.showAddShowmaxBtn=true;console.log(err.responseJSON.Message);}
self.update();}
window.getAvailableShowmaxContent=self.getAvailableShowmaxContent=function(){console.log("showmax-content"+dstvApp.targetDomain+"/api-services-showmax/showmax-content/ujson?select=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&resolveMedia=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&cdv="+(new Date().getTime()));fetch(dstvApp.targetDomain+"/api-services-showmax/showmax-content/ujson?select=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&resolveMedia=showmaxCardImage,showmaxSignupImage,firstImage,secondImage,thirdImage,fourthImage,manageShowmaxImage,showmaxLinkedImage&cdv="+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetAvailableContentSuccess(commits));}
self.onGetAvailableContentSuccess=function(data){console.log('Showmax : Success in fetching Showmax Umbraco content');self.showmaxUmbracoContent=data.properties;self.update();}
window.LoadShowMaxDetails=self.LoadShowMaxDetails=function(){console.log('Show max: Loading details...')
if(true||!app.showMaxDetails){console.log('Show max: Loading...')
app.smartcards=app.smartcards||[];app.smartcards.map(function(x){if(!self.isActiveCustomer&&x.primaryService)
self.isActiveCustomer=x.primaryService.status=="Active"&&x.primaryService.productName.includes("premium")})
self.dstvPremium=app.smartcards.some(x=>x.primaryService&&x.primaryService.productName.includes("premium"))
self.packageLoaded=true;self.update();app.isShowmaxCardLoaded=true;self.LoadViewSubscriptionForShowmax();}
else
{console.log('Show max: Details Already loaded')
self.showMaxLoaded=true;if(self.dstvPremium&&self.isActiveCustomer&&(!app.showMaxDetails.isPremiumCustomer))
self.showShowmaxSection=true;if(dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation))
self.showShowmaxSection=false;self.update();}}
self.LoadViewSubscriptionForShowmax=function(){var data=app.viewSubscriptionResponse;app.showmaxStatusDetails='';self.smartcardForShowmax='';if(data&&data.length>0){self.smartcardForShowmax=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard);self.dstvPremium=self.smartcardForShowmax.some(x=>x.primaryService.productName.includes("premium"));self.smartcardForShowmax=self.smartcardForShowmax[0];let sc=data.filter(sc=>sc.smartcardNumber==app.smartcard)[0];if(sc){showmaxProductDetails=sc.services.filter((service)=>{return service.serviceName.toUpperCase().includes('SHOWMAX');});}
else{showmaxProductDetails=[];}
app.showmaxStatusDetails=showmaxProductDetails[0];}
window.SessionSave("app",app);if(self.smartcardForShowmax==undefined)
{self.noServicesLoadedOnCard=true;self.showMaxLoaded=true;self.update();window.SessionSave("app",app);return;}
var wordsToRemove=['bouquet','e36','is20','Standalone','Subscription'];let expStr=wordsToRemove.join("|");if(self.smartcardForShowmax){self.formattedPackageName=self.smartcardForShowmax.primaryService.description.replace(new RegExp('\\b('+expStr+')\\b','gi'),' ').replace(/\s{2,}/g,' ');if(self.formattedPackageName.trim()=="DStv Access Streaming"&&dstvApp.countryabbreviation=='ng'){self.formattedPackageName="DStv Yanga Streaming"}else if(self.formattedPackageName.trim()=="DStv Family Streaming"&&dstvApp.countryabbreviation=='ng'){self.formattedPackageName="DStv Confam Streaming"}}
if(self.smartcardForShowmax&&(dstvApp.country.toLowerCase()=='tanzania'||dstvApp.country.toLowerCase()=='ethiopia')&&!app.isCurrDVSSmartcard){self.formattedPackageName=dstvApp.packages.find(p=>p.properties.Code==self.smartcardForShowmax.primaryService.productCode).properties.Name}
let smartcardStatus=self.smartcardForShowmax.primaryService?self.smartcardForShowmax.primaryService.status.toUpperCase():null;self.disconnectedSmartcard=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';if(self.disconnectedSmartcard){self.primaryPackageDisconnected=true;}
else{self.isShowmaxAdded=false;self.isShowmaxActive=false;}
if(showmaxProductDetails.length>0&&!self.disconnectedSmartcard){if(app.showmaxStatusDetails.status.toUpperCase()=='ACTIVE'){self.isShowmaxAdded=true;self.isShowmaxActive=true;}
else if(app.showmaxStatusDetails.status.toUpperCase()=='PENDING'||app.showmaxStatusDetails.status.toUpperCase()=='SUSPENDED'){self.isShowmaxAdded=false;self.isShowmaxActive=false;}
else{self.isShowmaxAdded=true;self.isShowmaxActive=false;}}
self.update();self.loadAddonsList();app.showmaxCardCaption=langTranslateApp.add
if(self.isShowmaxAdded&&self.isShowmaxActive)
app.showmaxCardCaption='Manage'
else if(!self.isShowmaxAdded&&!self.dstvPremium&&!self.primaryPackageDisconnected){app.showmaxCardCaption=langTranslateApp.add}
else if(!self.isShowmaxAdded&&self.dstvPremium&&!self.primaryPackageDisconnected){app.showmaxCardCaption='Add'}
self.getShowmaxDiscountInfo();self.update();}
self.loadShowmaxSubsStatus=function(){if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v1/Showmax/Status?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}&SmartCardNumber=${app.smartcard}&CustomerNumber=${app.customernumber}`;site.factory.Get(url,null,self.onSubsStatusCheckSuccess,self.onSubsStatusCheckerror,false,true,true);}else{let url=dstvApp.DSOAPIUrl+`/apishowmax/api/v1/Showmax/Status?BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}&Country=${dstvApp.country}&SmartCardNumber=${app.smartcard}&CustomerNumber=${app.customernumber}`;site.factory.Get(url,self.token,self.onSubsStatusCheckSuccess,self.onSubsStatusCheckerror);}}
self.loadAddonsList=function(){var reqBody={"businessUnit":dstvApp.businessunit,"channel":dstvApp.channel,"country":dstvApp.country,"packageName":self.smartcardForShowmax.primaryService.serviceName};if(dstvApp.EnableSecurityAuth){let url=`${dstvApp.SecurityAuthBaseUrl}${dstvApp.DSOChangePackageURL}?searchCust=${app.customernumber}`;site.factory.Post(url,reqBody,null,self.onLoadAddonsListSuccess,self.onLoadAddonsListError,false,false,false,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=`${dstvApp.DSOAPIUrl}${dstvApp.DSOChangePackageURL}`;site.factory.Post(url,reqBody,self.token,self.onLoadAddonsListSuccess,self.onLoadAddonsListError);});}}
self.onSubsStatusCheckSuccess=function(data){self.showMaxLoaded=true;if(data){}
self.update();}
self.onSubsStatusCheckerror=function(err){self.showMaxLoaded=true;if(err.responseJSON&&err.responseJSON.StatusCode==422){console.log(err.responseJSON.Message);}
self.update();}
self.onLoadAddonsListSuccess=function(data){self.showMaxLoaded=true;if(data){filteredAddOns=data.filter(x=>x.isAddOn===true&&x.name.toUpperCase().includes('SHOWMAX'));app.showmaxAddOnDetails=filteredAddOns[0];window.SessionSave("app",app);}
self.update();}
self.onLoadAddonsListError=function(err){self.showMaxLoaded=true;if(err.responseJSON&&err.responseJSON.StatusCode==422){console.log(err.responseJSON.Message);}
self.update();}
self.onDashActivateShowmax=function(){window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showActivate:true,showComponent:true});}
self.onShowmaxPending=function(){window.HandleActiveTab('showPayment')}
self.onDashManageShowmax=function(){console.log('Showmax : Initiating Manage section');window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showManage:true,showComponent:true});}
self.onRefresh=function(){riot.mount('tag-showmax-card',{showComponent:true});}
self.onDashPayReconnectShowmax=function(){console.log('Showmax : Initiating Reconnect Showmax');let smartcardStatus=self.smartcardForShowmax.primaryService.status.toUpperCase();let smartcardStatusFlag=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';let showmaxProductDetails=app.viewSubscriptionResponse.filter(sc=>sc.smartcardNumber==app.smartcard)[0].services.filter((service)=>{return service.serviceName.toUpperCase().includes('SHOWMAX');});if(smartcardStatusFlag&&showmaxProductDetails.length==0){let amount=self.AmountToPay();window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{payReconnectShowmax:true,amount:amount});}
else if(smartcardStatusFlag&&(showmaxProductDetails.length>0&&(showmaxProductDetails[0].status.toUpperCase()=='DISCONNECTED'||showmaxProductDetails[0].status.toUpperCase()=='SUSPENDED'))){window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{paySmartcardReconnectShowmax:true});}
else{window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{handlePayReconnect:true,showComponent:true});}}
self.onDashWatchNowShowmax=function(){console.log('Showmax : Initiating Watch now Showmax');let showmaxUrl=app.showmaxActivationUrl;window.open(showmaxUrl,'_blank');}
self.AmountToPay=function(){if(app.dualCurrencyApplicable)
return app.paymentduedetails.properties.amountToPayEtb.value;return app.paymentduedetails.properties.amountToPay.value;}
self.getShowmaxDiscountInfo=function(){if(dstvApp.EnableSecurityAuth){let url=dstvApp.SecurityAuthBaseUrl+`/apishowmax/api/v1/Showmax/GetShowmaxDiscount?Country=${dstvApp.country}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,null,self.onGetShowmaxDiscSuccess,self.onGetShowmaxDiscError,false,false,true);}else{site.factory.GetJWT().then(function(token){self.token=token;let url=dstvApp.DSOAPIUrl+`/apishowmax/api/v1/Showmax/GetShowmaxDiscount?Country=${dstvApp.country}&BusinessUnit=${dstvApp.businessunit}&Channel=${dstvApp.channel}`;site.factory.Get(url,self.token,self.onGetShowmaxDiscSuccess,self.onGetShowmaxDiscError);});}}
self.onGetShowmaxDiscSuccess=function(data){console.log('Showmax : Fetch Showmax discount data success');self.showmaxDiscountPercent=0;app.showmaxDiscountValue=0;if(data&&data.length>0){self.showmaxDiscountInfo=data.filter(x=>x.name.split('-')[0].trim()==app.currentSmartcardPackage.primaryService.serviceName.split('-')[0].trim());if(self.showmaxDiscountInfo&&self.showmaxDiscountInfo.length>0)
self.showmaxDiscountPercent=self.showmaxDiscountInfo[0].discountValue;else
self.showmaxDiscountPercent=0;app.showmaxDiscountValue=self.showmaxDiscountPercent;self.update();}}
self.onGetShowmaxDiscError=function(err){console.log('Showmax : Error on fetching Showmax discount data');}})
riot.tag2('tag-what-to-watch-section','<section class="you-may-like-section clearfix hide" if="{enableWhatToWatchSection && !app.isLiberia}"><h3>What to Watch</h3><div class="wtw-wrapper more-details-wrapper main-top-Details-info clearfix"><div class="wtw-details-inner"><div class="wtw-outer-bx"><div class="menu-wrapper"><ul class="wtw-menu nav navbar-nav" id="whatToWatchTab" style="display: flex;"><li class="item" each="{item in app.whatToWatch}" id={item.tabId}> <a href="javascript:void(0);" class={activeTabMovies} onclick="{ShowSelectedTab}" action="{item.action}">{item.tabTitel}</a></li></ul><div class="paddles"><button class="left-paddle paddle hidden">&lt;</button><button class="right-paddle paddle">&gt;</button></div></div><div class="wtw-bx" id="latest-movies" if="{enableLatestMoviesTab}"><div class="row"><div class="col-12 LogoWd"><img class="bxLogo" src="{boxofficeTabsLogo}" alt="Box Office"></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two box-office-main " if="{!EnableTopUpScreen}"><div class="container-fluid main-section box-office"><div class="popup"><div><div style="padding-bottom: 25px;"><span class="boxoffice-logo"><b>CONGRATULATIONS!</b></span></div><div class="rentMovie"> <br><h2><span class="font-weight-normal">Here    s Your</span> First Movie FREE.</h2> <a class="cta" target="_blank" onclick={OnBoxofficeRegister}>REGISTER<span class="icon icon-ico-movietype"></span></a></div></div></div><div class="clearfix"></div></div></div><div class="col-sm-12 col-md-7 col-lg-7 watch mt-xs-3"><div class="video-bg"><div class="controls" if="{showPlayButton}"><ul><li><img src="/media/6369/playicon.png" width="auto" height="65" onclick={playVideo} alt="" style="cursor: pointer;"></li></ul></div> <video id="videoPlayer" width="100%" height="auto" poster={openSelectedShowImage} controls="" disablePictureInPicture controlsList="nodownload"> <source src={openSelectedShow} type="video/mp4"> </video></div></div><div class="clearfix"></div><div class="col-lg-12"> <section class="third-slider"> <section class="regular slider"><div each="{item in boxOfficeMovies}"><div><a href="javascript:void(0)" onclick="{onShowsAndMovieClick}" value="{item.trailerLink}"><img src="{dstvApp.targetDomain+item.thumbPrintImage}" title="{item.name}"></a></div></div> </section> </section></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn" if="{EnableTopUpScreen}"> <div class="account-wrapper"> <div class="col-xs-6 col-sm-4 col-md-6 col-lg-6 col-sm-offset-2 col-md-offset-0"> <div class="title-wtw mt-xs-1 mt-sm-1">Amount Available:</div> <div if="{app.dualCurrencyApplicable && !self.notDualCurrency}" class="text-wtw mb-3">{dstvApp.countrycurrency.toUpperCase()} {bOBalance}</div><div if="{!app.dualCurrencyApplicable && !self.notDualCurrency}" class="text-wtw mb-3">{dstvApp.countrycurrency.toUpperCase()} {bOBalanceLocal}</div> </div> <div class="col-xs-6 col-sm-4 col-md-6 col-lg-6"> <div class="title-wtw mt-xs-1 mt-sm-1">Account Number:</div> <div class="text-wtw mb-3">{app.BOAccount.AccountNumber}</div> </div> <div class="cta-section"> <div class="col-xs-6 col-sm-4 col-md-6 col-lg-6 col-sm-offset-2 col-md-offset-0"> <div class="more-content"> <a target="_blank" onclick="{OnTopupAccount}" action="TOPUPACCOUNT"> <div class="msItem"> <div class="content"> <div class="iconDiv"><i class="icon icon-icon-watch-dstv"><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt="Top Up"></i></div> </div> <div class="btnDiv"> <span class="btn btn-primary manage-account"><strong>{topUpAccountBoxofficeCaptionCardTextFirst}</strong> {topUpAccountBoxofficeCaptionCardTextSecond}</span></div> </div> </a> </div> </div> <div class="col-xs-6 col-sm-4 col-md-6 col-lg-6"> <div class="more-content"> <a target="_blank" onclick="{OnRentNow}" action="RENTNOW"> <div class="msItem"> <div class="content"> <div class="iconDiv"><i class="icon icon-icon-watch-dstv"><img class="rn-icon pull-right" src="/media/11613/rentnow.svg" alt="Rent Now"></i></div> </div> <div class="btnDiv"> <span class="btn btn-primary watch-how"><strong>{rentNowBoxofficeCaptionCardTextFirst}</strong> {rentNowBoxofficeCaptionCardTextSecond}</span></div> </div> </a> </div> </div> </div> <div class="view-more-link"><a href="https://boxoffice.dstv.com/browse-movies" target="_blank">View All Movies</a></div> </div> </div><div class="clearfix"></div></div></div><div id="cpoverlay"> <div class="cv-spinner"> <span class="cpspinner"></span></div> </div><div class="wtw-bx showmax-series" id="hottest-series" if="{enableHottestSeriesTab}"><div class="row"><div class="col-12 LogoWd"><img class="bxLogo" src="{showmaxTabsLogo}" alt="Box Office"></div><div class="col-sm-12 col-md-7 col-lg-7 watch mt-xs-3"><div class="video-bg"><div class="controls" if="{showPlayButton}"><ul><li><img src="/media/11607/sm-play.png" width="auto" height="65" onclick={playVideo} alt="" style="cursor: pointer;"></li></ul></div> <video id="videoPlayer" width="100%" height="auto" poster={openSelectedShowImage} class="{hideControls}" controls="" disablePictureInPicture controlsList="nodownload"> <source src={openSelectedShow} type="video/mp4"> </video></div></div><div class="clearfix"></div><div class="col-lg-12"> <section class="third-slider"> <section class="regular slider"><div each="{item in boxOfficeMovies}"><div><a href="javascript:void(0)" onclick="{onShowsAndMovieClick}" value="{item.trailerLink}"><img src="{dstvApp.targetDomain+item.thumbPrintImage}" title="{item.name}"></a></div></div> </section> </section></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn" if="{showShowmaxGenericMSG}"><div class=""><div class="text-center"><h2 class="wtwTabHeadingTitle">GET SHOWMAX</h2><h4 class="genericTitle">The best shows.<b> No interruptions.</b></h4><p class="generictxt">Watch anywhere. <b>No contracts.</b></p></div><div class="row"><div class="col-md-6 col-xs-8 text-center"><div class="more-content"><a target="_blank" href={getItNowCaptionCardLink}><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{getItNowCaptionCardTextFirst}</span><span>{getItNowCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div></a></div></div><div class="col-md-6 col-xs-8 text-center"><div class="more-content"><a target="_blank" href={tryItFreeCaptionCardLink}><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{tryItFreeCaptionCardTextFirst}</span><span>{tryItFreeCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div></a></div></div></div></div></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn" if="{showWatchNowBtn}"><div class=""><div if="{isManageShowmaxMSGSection}" class="text-center"><h2 class="wtwTabHeadingTitle">WATCH SHOWMAX</h2><p class="mb-2">The best shows. <b>No Interruptions.</b><br><span class="watch-showmax-text">Watch anywhere. <b>No Contracts.</b></span></p></div><div class="col-xs-6 col-sm-4 col-md-6 col-lg-6 col-sm-offset-2 col-md-offset-0"><div class="title-wtw mt-xs-1 mt-sm-1 hidden">Amount Available:</div><div class="text-wtw mb-3 hidden">$ {app.BOAccount.AccountBalance.Value}</div><div class="more-content"> <a target="_blank" onclick="{OnManageAccount}" action="MANAGEACCOUNT"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{app.showmaxCardCaption}</span><span>Showmax</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div></div><div class="clearfix" if="{!showWatchNowBtn}"></div><div class="col-xs-6 col-sm-4 col-md-6 col-lg-6"><div class="title-wtw mt-xs-1 mt-sm-1 hidden">Account Number:</div><div class="text-wtw mb-3 hidden">&nbsp;{app.BOAccount.AccountNumber}</div><div class="more-content" if="{showWatchNowBtn}"> <a target="_blank" onclick="{OnWatchNow}" action="WATCHNOW"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">{watchNowShowmaxCaptionCardTextFirst}</span><span>{watchNowShowmaxCaptionCardTextSecond}</span></span><img class="rn-icon pull-right" src="/media/11613/rentnow.svg" alt=""></div></div> </a></div></div></div></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn-two" if="{!showWatchNowBtn}"><div class="" if="{!app.viewSubscriptionResponse}"><div class="loading-loader loading" style="z-index: 999;"><div class="col-sm-12 text-center white"><div class="spinner black"></div><div class="loading-message">Showmax Loading...</div></div></div></div><div class="" if="{app.viewSubscriptionResponse}"><div if="{isAddShowmaxMSGSection}" class="text-center"><div if="{app.showmaxCardPremiumRibbon == \'0\'}"><h2 class="wtwTabHeadingTitle">GET SHOWMAX</h2><p class="mb-1">The best shows. <b>No Interruptions.</b><br><span class="watch-showmax-text">Watch anywhere. <b>No Contracts.</b></span></p><h2 class="ShowmxdiscountHeadTitle">for only <b>{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</b></h2></div><div if="{app.showmaxCardPremiumRibbon != \'0\'}"><h2 class="wtwTabHeadingTitle">GET SHOWMAX</h2><p>In order to add <b>Showmax</b> to your DStv account at</p><h2 class="discountHeadTitle"><b>50%</b> DISCOUNT</h2></div></div><div if="{isPayAndReconnectShowmaxMSGSection}" class="text-center"><div if="{app.showmaxCardPremiumRibbon == \'0\'}"><h2 class="wtwTabHeadingTitle">GET SHOWMAX</h2><p class="mb-1">The best shows. <b>No Interruptions.</b><br><span class="watch-showmax-text">Watch anywhere. <b>No Contracts.</b></span></p><h2 class="ShowmxdiscountHeadTitle">for only <b>{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</b></h2></div><div if="{app.showmaxCardPremiumRibbon != \'0\'}"><h2 class="wtwTabHeadingTitle">CONGRATULATIONS !</h2><p>In order to add <b>Showmax</b> to your DStv account at</p><h2 class="discountHeadTitle"><b>50%</b> DISCOUNT</h2></div></div><div if="{isActivateShowmaxMSGSection}" class="text-center"><div if="{app.showmaxCardPremiumRibbon == \'0\'}"><h2 class="wtwTabHeadingTitle">GET SHOWMAX</h2><p class="mb-1">The best shows. <b>No Interruptions.</b><br><span class="watch-showmax-text">Watch anywhere. <b>No Contracts.</b></span></p><h2 class="ShowmxdiscountHeadTitle">for only <b>{dstvApp.countrycurrency.toUpperCase()} {app.showmaxAddOnDetails.price.value} p/m</b></h2></div><div if="{app.showmaxCardPremiumRibbon != \'0\'}"><h2 class="wtwTabHeadingTitle">CONGRATULATIONS !</h2><p> You qualify for <b>Showmax</b> at</p><h2 class="discountHeadTitle"><b>100%</b> DISCOUNT</h2></div></div><div class="col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2 text-center"><div class="more-content" if="{isActivateShowmaxAction}"> <a target="_blank" onclick="{OnActivateShowmax}" action="MANAGEACCOUNT"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{app.showmaxCardCaption}</span><span>Showmax</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div><div class="more-content" if="{isAddShowmaxAction}"> <a target="_blank" onclick="{OnAddShowmax}" action="MANAGEACCOUNT"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{app.showmaxCardCaption}</span><span>Showmax</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div><div class="more-content" if="{isPayAndReconnectShowmaxAction}"> <a target="_blank" onclick="{OnPayAndReconnectShowmax}" action="MANAGEACCOUNT"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary manage-account"><span class="heading">{app.showmaxCardCaption}</span><span>Showmax</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div></div><div class="clearfix" if="{!showWatchNowBtn}"></div></div></div><div class="clearfix"></div></div></div><div class="wtw-bx greatest-sports" id="greatest-sports" if="{enableGreatestSportTab}"><div class="row"><div class="col-12 LogoWd"><img class="bxLogo superSportLogo" src="{superSportTabsLogo}" alt="Box Office"></div><div class="col-sm-12 col-md-7 col-lg-7 watch mt-xs-3"><div class="video-bg"><div class="controls" if="{showPlayButton}"><ul><li><img src="/media/11608/playicon-ss.png" width="auto" height="65" onclick={playVideo} alt="" style="cursor: pointer;"></li></ul></div> <video id="videoPlayer" class="{hideControls}" width="100%" height="auto" poster={openSelectedShowImage} controls="" disablePictureInPicture controlsList="nodownload"> <source src={openSelectedShow} type="video/mp4"> </video></div></div><div class="clearfix"></div><div class="col-lg-12"> <section class="third-slider"> <section class="regular slider"><div each="{item in boxOfficeMovies}"><div><a href="javascript:void(0)" onclick="{onShowsAndMovieClick}" value="{item.trailerLink}"><img src="{dstvApp.targetDomain+item.thumbPrintImage}" title="{item.name}"></a></div></div> </section> </section></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn-two" if="{!dstvPremiumCustomerSports}"><div class=""><div class="text-center"><h2 class="wtwTabHeadingTitle">Live Sport</h2><p class="mt-2 mb-2"><b>DStv </b>Subscribers get to watch all their </br><b>Favorite Sports LIVE</b></p></div><div class="col-xs-6 col-sm-4 col-md-6 col-lg-6 col-sm-offset-2 col-md-offset-0"><div class="more-content"> <a target="_blank" onclick="{OnUpgradeNowSport}"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">{upgradeNowSportsCaptionCardTextFirst}</span><span>{upgradeNowSportsCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div></div><div class="col-xs-6 col-sm-4 col-md-6 col-lg-6"><div class="more-content"> <a target="_blank" href={streamLiveSportCaptionCardLink}><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">{streamLiveSportCaptionCardTextFirst}</span><span>{streamLiveSportCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11613/rentnow.svg" alt=""></div></div> </a></div></div></div></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn-two" if="{dstvPremiumCustomerSports}"><div class=""><div class="text-center"><h2 class="wtwTabHeadingTitle">Live Sport</h2><p class="mt-2 mb-2"><b>DStv </b>Subscribers get to watch all their </br><b>Favorite Sports LIVE</b></p></div><div class="col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2 text-center"><div class="more-content"> <a target="_blank" href={streamLiveSportCaptionCardLink}><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">{streamLiveSportCaptionCardTextFirst}</span><span>{streamLiveSportCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11613/rentnow.svg" alt=""></div></div> </a></div></div></div></div><div class="clearfix"></div></div></div><div class="wtw-bx tv-go" id="tv-go" if="{enableTvOnTheGoTab}"><div class="row"><div class="col-12 LogoWd"><img class="bxLogo tvOnTheGoLogo" src="{dstvNowTabsLogo}" alt="Box Office"></div><div class="col-sm-12 col-md-7 col-lg-7 watch mt-xs-3"><div class="video-bg"><div class="controls" if="{showPlayButton}"><ul><li><img src="/media/11609/playicon-tv.png" width="auto" height="65" onclick={playVideo} alt="" style="cursor: pointer;"></li></ul></div> <video id="videoPlayer" width="100%" height="auto" poster={openSelectedShowImage} controls="" disablePictureInPicture controlsList="nodownload"> <source src={openSelectedShow} type="video/mp4"> </video></div></div><div class="clearfix"></div><div class="col-lg-12"> <section class="third-slider"> <section class="regular slider"><div each="{item in boxOfficeMovies}"><div><a href="javascript:void(0)" onclick="{onShowsAndMovieClick}" value="{item.trailerLink}"><img src="{dstvApp.targetDomain+item.thumbPrintImage}" title="{item.name}"></a></div></div> </section> </section></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two wth-btn-two"><div class=""><div class="text-center"><h2 class="wtwTabHeadingTitle">TV ON THE GO</h2><p class="mt-2 mb-2">Watch your <b>DStv online,</b> anywhere,anytime </br><b>at no additional cost</b></p></div><div class="col-md-6 col-md-offset-3 col-xs-8 col-xs-offset-2 text-center"><div class="title-wtw mt-xs-1 mt-sm-1 hidden">Account Number:</div><div class="text-wtw mb-3 hidden">&nbsp;{app.BOAccount.AccountNumber}</div><div class="more-content"> <a target="_blank" href={streamLiveCaptionCardLink}><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">{streamLiveCaptionCardTextFirst}</span><span>{streamLiveCaptionCardTextSecond}</span></span><img class="acc-icon pull-right" src="/media/11613/rentnow.svg" alt=""></div></div> </a></div></div></div></div><div class="clearfix"></div></div></div><div class="wtw-bx shows-and-reality" id="shows-and-reality" if="{enableShowsAndRealityTab}"><div class="row"><div class="col-12 LogoWd"><img class="bxLogo mNetLogo" src="/media/11489/mnet.png" alt="Box Office"></div><div class="col-sm-12 col-md-5 col-lg-5 watch-two"><div class=""><div class="col-md-6 col-md-offset-3"><div class="title-wtw mt-xs-1 mt-sm-1 hidden">Account Number:</div><div class="text-wtw mb-3 hidden">&nbsp;{app.BOAccount.AccountNumber}</div><div class="more-content"> <a target="_blank" href="https://m-net.dstv.com/South/home"><div class="msItem"><div class="content"><div class="iconDiv"><i class="icon icon-icon-watch-dstv"></i></div></div><div class="btnDiv"> <span class="btn btn-primary watch-how"><span class="heading">Stream</span><span>Live</span></span><img class="acc-icon pull-right" src="/media/11612/topup.svg" alt=""></div></div> </a></div></div></div></div><div class="col-sm-12 col-md-7 col-lg-7 watch mt-xs-3"><div class="video-bg"><div class="controls" if="{showPlayButton}"><ul><li><img src="/media/11490/playicon-now.png" width="auto" height="65" onclick={playVideo} alt="" style="cursor: pointer;"></li></ul></div> <video id="videoPlayer" width="100%" height="auto" poster={openSelectedShowImage} controls="" disablePictureInPicture controlsList="nodownload"> <source src={openSelectedShow} type="video/mp4"> </video></div></div><div class="clearfix"></div><div class="col-lg-12"> <section class="third-slider"> <section class="regular slider"><div each="{item in boxOfficeMovies}"><div><a href="javascript:void(0)" onclick="{onShowsAndMovieClick}" value="{item.trailerLink}"><img src="{item.thumbPrintImage}" title="{item.name}"></a></div></div> </section> </section></div><div class="clearfix"></div></div></div></div></div></div> </section> ','tag-what-to-watch-section,[riot-tag="tag-what-to-watch-section"],[data-is="tag-what-to-watch-section"]{ visibility: visible; } tag-what-to-watch-section select,[riot-tag="tag-what-to-watch-section"] select,[data-is="tag-what-to-watch-section"] select{ display: none !important; }','',function(opts){var self=this;self.play=opts.play;self.vPlayer=null;self.initialTabInput="movies";self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;self.enableShowsAndRealityTab=false;self.bOBalance=0;self.bOBalanceLocal=0;self.videoControls="controls";self.on('before-mount',function(){});self.on('mount',function(){setTimeout(function(){self.enableWhatToWatchSection=dstvApp.WhatToWatchSectionCountries.includes(dstvApp.countryabbreviation);console.log("What To Watch Section: started mount");if(app.BOAccount&&app.BOAccount.AccountBalance){self.bOBalance=app.BOAccount.AccountBalance.Value.replace('-','');self.bOBalanceLocal=parseFloat(self.bOBalance*dstvApp.DualCurrencyConversionRate).toFixed(2);}
if(app.whatToWatch){self.GetActionFromUmbraco();}
self.FirstTabInitiate();self.vPlayer=$('#videoPlayer')[0];self.InitializeShow(self.initialTabInput);self.play=true;self.vPlayerAction('LOAD')
if(app.BOAccount&&app.BOAccount.AccountNumber>0)
self.EnableTopUpScreen=true;else
self.EnableTopUpScreen=false;self.update();},50);setTimeout(function(){$("#whatToWatchTab .item:first-child").addClass("active");},1000);});$(".close-message4").click(function(){$(".collapsible4").toggleClass("collapsed");});self.ShowSelectedTab=function(e){self.InitiateShowsSlider();$("#cpoverlay").fadeIn();console.log(e);$('#whatToWatchTab li').click(function(){$(this).parent('ul').find('li').removeClass('active');$(this).addClass('active');})
let currentTabToShow=e.currentTarget.attributes["action"].value;switch(currentTabToShow){case 'HottestSeries':console.log("Hottest series Tab initialize..");self.tabInput="hottest-series";self.enableHottestSeriesTab=true;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;self.enableShowsAndRealityTab=false;self.activeTabHottestSeries="active-tab2";self.activeTabMovies="showmaxTab active";self.activeTabGreatestSports="";self.activeTabTvOnTheGo="";self.activeTabShowsandReality="";self.GetShowmaxStatus();break;case 'LatestMovies':console.log("Boxoffice Movies Tab initialize..");self.tabInput="movies";self.enableLatestMoviesTab=true;self.enableHottestSeriesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;self.enableShowsAndRealityTab=false;self.activeTabHottestSeries="active-tab1";self.activeTabMovies="boxofficeTab active";self.activeTabGreatestSports="";self.activeTabTvOnTheGo="";self.activeTabShowsandReality="";break;case 'GreatestSport':console.log("Greatest sports Tab initialize..");self.tabInput="greatest-sports";self.enableGreatestSportTab=true;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableTvOnTheGoTab=false;self.enableShowsAndRealityTab=false;self.activeTabHottestSeries="";self.activeTabMovies="sportsTab active";self.activeTabGreatestSports="active-tab3";self.activeTabTvOnTheGo="";self.activeTabShowsandReality="";self.dstvPremiumCustomerSports=app.smartcards.some(x=>x.primaryService&&x.primaryService.productName.includes("premium"))
break;case 'TvOnTheGo':console.log("Dstv Now Tab initialize..");self.tabInput="tv-on-the-go";self.enableTvOnTheGoTab=true;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableShowsAndRealityTab=false;self.activeTabHottestSeries="";self.activeTabMovies="active-tab4";self.activeTabGreatestSports="";self.activeTabTvOnTheGo="dstvNowTab active";self.activeTabShowsandReality="";break;case 'ShowsAndReality':console.log(currentTabToShow);self.tabInput="shows-and-reality";self.enableShowsAndRealityTab=true;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;self.activeTabHottestSeries="";self.activeTabMovies="";self.activeTabGreatestSports="";self.activeTabTvOnTheGo="";self.activeTabShowsandReality="active-tab5";break;}
self.InitializeShow(self.tabInput);}
self.GetActionFromUmbraco=function(){for(var i=0;i<app.whatToWatch.length;i++)
{self.linksSet="";self.ShowmaxLinks="";let actionName=app.whatToWatch[i].action;switch(actionName){case 'HottestSeries':self.showmaxTabsLogo=app.whatToWatch[i].logo;self.linksSet=app.whatToWatch[i];self.ShowmaxLinks=self.linksSet.links;var watchShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='watchNowShowmax')[0];if(watchShowmaxOption){self.watchNowCaptionCardText=watchShowmaxOption.title;self.watchNowCaptionCardText=self.watchNowCaptionCardText.split(",");self.watchNowShowmaxCaptionCardTextFirst=self.watchNowCaptionCardText[0];self.watchNowShowmaxCaptionCardTextSecond=self.watchNowCaptionCardText[1];}
var manageShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='manageShowmax')[0];if(manageShowmaxOption){self.ManageCaptionCardText=manageShowmaxOption.title;}
var addShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='addShowmax')[0];if(addShowmaxOption){self.addShowmaxCaptionCardText=addShowmaxOption.title;}
var activateShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='activateShowmax')[0];if(activateShowmaxOption){self.activateCaptionCardText=activateShowmaxOption.title;}
var payAndReconnectShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='payReconnectShowmax')[0];if(payAndReconnectShowmaxOption){self.payReconnectCaptionCardText=payAndReconnectShowmaxOption.title;}
var getItNowShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='showmaxGetItNow')[0];if(getItNowShowmaxOption){self.getItNowCaptionCardText=getItNowShowmaxOption.title;self.getItNowCaptionCardText=self.getItNowCaptionCardText.split(",");self.getItNowCaptionCardTextFirst=self.getItNowCaptionCardText[0];self.getItNowCaptionCardTextSecond=self.getItNowCaptionCardText[1];self.getItNowCaptionCardLink=getItNowShowmaxOption.link;}
var tryItFreeShowmaxOption=self.ShowmaxLinks.filter(x=>x.class=='showmaxTryItFree')[0];if(tryItFreeShowmaxOption){self.tryItFreeShowmaxOptionText=tryItFreeShowmaxOption.title;self.tryItFreeCaptionCardText=self.tryItFreeShowmaxOptionText.split(",");self.tryItFreeCaptionCardTextFirst=self.tryItFreeCaptionCardText[0];self.tryItFreeCaptionCardTextSecond=self.tryItFreeCaptionCardText[1];self.tryItFreeCaptionCardLink=tryItFreeShowmaxOption.link;}
break;case 'LatestMovies':self.boxofficeTabsLogo=app.whatToWatch[i].logo;self.linksSet=app.whatToWatch[i];self.ShowmaxLinks=self.linksSet.links;var topUpAccount=self.ShowmaxLinks.filter(x=>x.class=='topUpAccount')[0];if(topUpAccount){self.topUpAccountCaptionCardText=topUpAccount.title;self.topUpAccountCaptionCardText=self.topUpAccountCaptionCardText.split(",");self.topUpAccountBoxofficeCaptionCardTextFirst=self.topUpAccountCaptionCardText[0];self.topUpAccountBoxofficeCaptionCardTextSecond=self.topUpAccountCaptionCardText[1];}
var rentNowCard=self.ShowmaxLinks.filter(x=>x.class=='rentNowCard')[0];if(rentNowCard){self.rentNowCaptionCardText=rentNowCard.title;self.rentNowCaptionCardText=self.rentNowCaptionCardText.split(",");self.rentNowBoxofficeCaptionCardTextFirst=self.rentNowCaptionCardText[0];self.rentNowBoxofficeCaptionCardTextSecond=self.rentNowCaptionCardText[1];}
break;case 'GreatestSport':self.superSportTabsLogo=app.whatToWatch[i].logo;self.linksSet=app.whatToWatch[i];self.ShowmaxLinks=self.linksSet.links;var streamLiveSportCard=self.ShowmaxLinks.filter(x=>x.class=='superSports')[0];if(streamLiveSportCard){self.streamLiveSportCaptionCardText=streamLiveSportCard.title;self.streamLiveSportCaptionCardText=self.streamLiveSportCaptionCardText.split(",");self.streamLiveSportCaptionCardTextFirst=self.streamLiveSportCaptionCardText[0];self.streamLiveSportCaptionCardTextSecond=self.streamLiveSportCaptionCardText[1];self.streamLiveSportCaptionCardLink=streamLiveSportCard.link;}
var upgradeNowCard=self.ShowmaxLinks.filter(x=>x.class=='superSportUpgradeNow')[0];if(upgradeNowCard){self.upgradeNowCaptionCardText=upgradeNowCard.title;self.upgradeNowCaptionCardText=self.upgradeNowCaptionCardText.split(",");self.upgradeNowSportsCaptionCardTextFirst=self.upgradeNowCaptionCardText[0];self.upgradeNowSportsCaptionCardTextSecond=self.upgradeNowCaptionCardText[1];}
break;case 'TvOnTheGo':self.dstvNowTabsLogo=app.whatToWatch[i].logo;self.linksSet=app.whatToWatch[i];self.ShowmaxLinks=self.linksSet.links;var streamLiveDstvNow=self.ShowmaxLinks.filter(x=>x.class=='dstvNow')[0];if(streamLiveDstvNow){self.streamLiveCaptionCardText=streamLiveDstvNow.title;self.streamLiveCaptionCardText=self.streamLiveCaptionCardText.split(",");self.streamLiveCaptionCardTextFirst=self.streamLiveCaptionCardText[0];self.streamLiveCaptionCardTextSecond=self.streamLiveCaptionCardText[1];self.streamLiveCaptionCardLink=streamLiveDstvNow.link;}
break;}}}
self.FirstTabInitiate=function(){let currentTabToShowInitial="";if(app.whatToWatch&&app.whatToWatch.length)
currentTabToShowInitial=app.whatToWatch[0].action;switch(currentTabToShowInitial){case 'HottestSeries':self.initialTabInput="hottest-series";self.showmaxTabsLogo=app.whatToWatch[0].logo;self.enableHottestSeriesTab=true;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;self.GetShowmaxStatus();break;case 'LatestMovies':self.initialTabInput="movies";self.boxofficeTabsLogo=app.whatToWatch[0].logo;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=true;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=false;break;case 'GreatestSport':self.initialTabInput="greatest-sports";self.superSportTabsLogo=app.whatToWatch[0].logo;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=true;self.enableTvOnTheGoTab=false;self.dstvPremiumCustomerSports=app.smartcards.some(x=>x.primaryService&&x.primaryService.productName.includes("premium"))
break;case 'TvOnTheGo':self.initialTabInput="tv-on-the-go";self.dstvNowTabsLogo=app.whatToWatch[0].logo;self.enableHottestSeriesTab=false;self.enableLatestMoviesTab=false;self.enableGreatestSportTab=false;self.enableTvOnTheGoTab=true;break;}}
self.InitializeShow=function(tabInput){console.log('what to Watch Section: Loading movies...')
boxofficeNode=dstvApp.language=='Portuguese'?'filmes':tabInput;console.log(boxofficeNode+': Loading movies API calling...')
$("#cpoverlay").fadeIn(300);let url=dstvApp.targetDomain+window.culture+`/api-services/${boxofficeNode}/ujson?children=true&select=Name,Type,YearReleased,prize,Episode,season,contentrating,coverImage,Id,summary,description,actors,genre,duration,trailerUrl,title,SubTitle,footerButtonUrl,footerButtonText,rentNowLink,additionalImages,videoPlayerImages,featuredBackground&resolveMedia=coverImage,additionalImages,videoPlayerImages,featuredBackground&cdv=${(new Date).getTime()}`;if(dstvApp.DTHCountries.includes(dstvApp.countryabbreviation)){url=dstvApp.targetDomain+"/en-dth"+`/api-services/${boxofficeNode}/ujson?children=true&select=Name,PublishToCountry,Type,YearReleased,prize,Episode,season,contentrating,coverImage,Id,summary,description,actors,genre,duration,trailerUrl,title,SubTitle,footerButtonUrl,footerButtonText,rentNowLink,additionalImages,videoPlayerImages,featuredBackground&resolveMedia=coverImage,additionalImages,videoPlayerImages,featuredBackground&cdv=${(new Date).getTime()}`;}
fetch(url).then(response=>response.json()).then(commits=>self.OnAPIServiceSuccess(commits));}
self.OnAPIServiceSuccess=function(response){self.boxOfficeLoaded=true;if(response.entities&&dstvApp.DTHCountries.includes(dstvApp.countryabbreviation)){response=response.entities.filter(x=>x.properties.PublishToCountry.includes(dstvApp.country.toLowerCase()))}
if(response.entities){response=self.GetFormattedResponse(response.entities);self.boxofficeOpacity=''
self.boxOfficeMovies=response;console.log('what to watch: Shows Loading done.')
if(response[0].trailerLink){self.openSelectedShowImage=dstvApp.targetDomain+response[0].additionalImages;self.openSelectedShow=response[0].trailerLink;self.showPlayButton=true
self.play=true;self.vPlayerAction('LOAD');}
else
{$('#videoPlayer').prop("controls",false);self.openSelectedShowImage=dstvApp.targetDomain+response[0].additionalImages;self.openSelectedShow=response[0].trailerLink;self.showPlayButton=false
self.play=false;self.vPlayerAction('');}
self.update();riot.update();self.InitiateShowsSlider();$("#cpoverlay").fadeOut(300);}
else{console.log('Error in loading Shows...');}}
self.OnAPIServiceError=function(e){$("#cpoverlay").fadeOut(300);console.log('WhatToWatch : Error in loading Shows...');}
self.GetShowmaxStatus=function(){let waitingInterval=setInterval(function(){console.log('What to Watch Showmax : waiting for view subscription...')
if(app.viewSubscriptionResponse){clearInterval(waitingInterval)
console.log('What to Watch Showmax : get view subscription response for showmax...')
InitiateProcess();}},200);function InitiateProcess(){self.showShowmaxGenericMSG=!dstvApp.NoShowmaxCountryList.includes(dstvApp.countryabbreviation)&&!dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);if(!self.showShowmaxGenericMSG){var data=app.viewSubscriptionResponse;let sc=data.filter(sc=>sc.smartcardNumber==app.smartcard)[0];if(sc){showmaxProductDetails=sc.services.filter((service)=>{return service.serviceName.toUpperCase().includes('SHOWMAX');});}
else{showmaxProductDetails=[];}
self.smartcardForShowmax=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard);self.dstvPremium=self.smartcardForShowmax.some(x=>x.primaryService.productName.includes("premium"));self.smartcardForShowmax=self.smartcardForShowmax[0];let smartcardStatus=self.smartcardForShowmax.primaryService?self.smartcardForShowmax.primaryService.status.toUpperCase():null;self.isShowMaxApplicable=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);if(!self.smartcardForShowmax)
{self.noServicesLoadedOnCard=true;self.showMaxLoaded=true;self.update();return;}
self.disconnectedSmartcard=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';if(self.disconnectedSmartcard){self.primaryPackageDisconnected=true;}
else
{self.isShowmaxAdded=false;self.isShowmaxActive=false;}
if(showmaxProductDetails.length>0&&!self.disconnectedSmartcard){var currentShowmax=app.showmaxStatusDetails.status.toUpperCase();if(currentShowmax=='ACTIVE'){self.isShowmaxAdded=true;self.isShowmaxActive=true;}
else if(currentShowmax=='PENDING'||currentShowmax=='SUSPENDED'){self.isShowmaxAdded=false;self.isShowmaxActive=false;}
else{self.isShowmaxAdded=true;self.isShowmaxActive=false;}}
app.showmaxCardCaption=langTranslateApp.add
if(self.isShowmaxAdded&&self.isShowmaxActive){self.showWatchNowBtn=true;app.showmaxCardCaption=self.ManageCaptionCardText;self.isManageShowmaxMSGSection=true;}
else if(!self.isShowmaxAdded&&!self.dstvPremium&&!self.primaryPackageDisconnected){self.showWatchNowBtn=false;app.showmaxCardCaption=self.addShowmaxCaptionCardText;self.isAddShowmaxAction=true;self.isAddShowmaxMSGSection=true;}
else if(!self.isShowmaxAdded&&self.dstvPremium&&!self.primaryPackageDisconnected){self.showWatchNowBtn=false;app.showmaxCardCaption=self.activateCaptionCardText;self.isActivateShowmaxAction=true;self.isActivateShowmaxMSGSection=true;}
else if(self.isShowmaxAdded&&!self.isShowmaxActive||self.primaryPackageDisconnected){self.showWatchNowBtn=false;app.showmaxCardCaption='Pay/Reconnect'
self.isPayAndReconnectShowmaxAction=true;self.isPayAndReconnectShowmaxMSGSection=true;}}}}
self.GetFormattedResponse=function(res){return res.map(m=>({name:m.properties.Title,price:m.properties.Prize,thumbPrintImage:m.properties.CoverImage,actors:m.properties.Actors,additionalImages:m.properties.AdditionalImages,videoPlayerImages:m.properties.videoPlayerImages,contentRating:m.properties.ContentRating,description:m.properties.Description,duration:m.properties.Duration,episode:m.properties.Episode,genre:m.properties.Genre,rentNowLink:m.properties.RentNowLink,season:m.properties.Season,summary:m.properties.Summary,trailerLink:m.properties.TrailerUrl,type:m.properties.Type,yearReleased:m.properties.YearReleased}));}
self.OnManageAccount=function(){console.log('Showmax : Initiating Manage section');window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showManage:true,showComponent:true});}
self.OnActivateShowmax=function(){console.log('Showmax : Initiating Manage section');window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showActivate:true,showComponent:true});}
self.OnAddShowmax=function(){console.log('Showmax : Initiating Manage section');window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{showActivate:true,showComponent:true});}
self.OnPayAndReconnectShowmax=function(){console.log('Showmax : Initiating Pay and Reconnect section');let smartcardStatus=self.smartcardForShowmax.primaryService.status.toUpperCase();let smartcardStatusFlag=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';let showmaxProductDetails=app.viewSubscriptionResponse.filter(sc=>sc.smartcardNumber==app.smartcard)[0].services.filter((service)=>{return service.serviceName.toUpperCase().includes('SHOWMAX');});if(smartcardStatusFlag&&showmaxProductDetails.length==0){let amount=self.AmountToPay();window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{payReconnectShowmax:true,amount:amount});}
else if(smartcardStatusFlag&&(showmaxProductDetails.length>0&&(showmaxProductDetails[0].status.toUpperCase()=='DISCONNECTED'||showmaxProductDetails[0].status.toUpperCase()=='SUSPENDED'))){window.HandleActiveTab("showPayment");riot.mount('tag-dashboard-payments',{paySmartcardReconnectShowmax:true});}
else{window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{handlePayReconnect:true,showComponent:true});}}
self.OnTopupAccount=function(){window.HandleActiveTab("showMore")
riot.mount('tag-dash-boxoffice',{showComponent:true,state:'topup'});}
self.OnRentNow=function(){window.HandleActiveTab("showMore")
riot.mount('tag-dash-boxoffice',{showComponent:true});}
self.OnBoxofficeRegister=function(){window.HandleActiveTab("showMore")
riot.mount('tag-dash-boxoffice',{showComponent:true});}
self.OnWatchNow=function(){window.HandleActiveTab("showMore");riot.mount('tag-showmax-atb',{createShowmaxAccount:true,showComponent:true});}
self.OnUpgradeNowSport=function(){window.HandleActiveTab("showChangePackage");}
self.onShowsAndMovieClick=function(e){self.vPlayerAction('PAUSE');console.log("What to Watch Section : Video pause..");if(e.item.item.trailerLink){self.hideControls="";self.openSelectedShow=e.item.item.trailerLink;self.openSelectedShowImage=dstvApp.targetDomain+e.item.item.additionalImages;self.showPlayButton=true
self.play=true;self.update();self.vPlayerAction('LOAD');}
else
{$('#videoPlayer').prop("controls",false);self.hideControls="hideVideoControls";self.openSelectedShow=e.item.item.trailerLink;self.openSelectedShowImage=dstvApp.targetDomain+e.item.item.additionalImages;self.showPlayButton=false
self.play=false;self.update();self.vPlayerAction('');}}
self.playVideo=function(){self.showPlayButton=false;self.update();self.vPlayerAction('PLAY');}
self.InitiateShowsSlider=function(){$(".regular").not('.slick-initialized').slick({dots:false,arrows:false,prevArrow:'<button class="slick-prev"><div class="icon-ico-arrow-next"></div></button>',nextArrow:'<button class="slick-next"><div class="icon-ico-arrow-next"></div></button>',infinite:true,slidesToShow:7,slidesToScroll:1,focusOnSelect:true,centerMode:false,responsive:[{breakpoint:1480,settings:{slidesToShow:7,}},{breakpoint:1280,settings:{slidesToShow:7,}},{breakpoint:1024,settings:{slidesToShow:7,}},{breakpoint:600,settings:{slidesToShow:3,}},{breakpoint:480,settings:{slidesToShow:3,}},{breakpoint:320,settings:{slidesToShow:3,}}]});$('.regular').on('afterChange',function(event,slick,currentSlide,nextSlide){if(currentSlide==-1)
return;var currSlide=self.boxOfficeMovies[currentSlide];var e={item:{item:{trailerLink:currSlide.trailerLink,additionalImages:currSlide.additionalImages}}};self.onShowsAndMovieClick(e);});}
self.vPlayerAction=function(action){let vPlayer=$('#videoPlayer')[0];let promise;try{switch(action){case 'PAUSE':promise=vPlayer.pause();break;case 'PLAY':promise=vPlayer.play();break;case 'LOAD':promise=vPlayer.load();break;}
if(promise!==undefined){promise.then(_=>{}).catch(error=>{});}}
catch(e){console.log('Unable to pause video player');}}
self.AmountToPay=function(){if(app.dualCurrencyApplicable)
return app.paymentduedetails.properties.amountToPayEtb.value;return app.paymentduedetails.properties.amountToPay.value;}})
riot.tag2('tag-header-premium-status','<div if="{isPremiumStatusApplicable && !app.noServicesLoaded}" class="progressBar"> <progress id="premStatusBar" value="{app.score}" max="100"></progress> </div><div if="{isPremiumStatusApplicable && !app.noServicesLoaded}" class="premium-bx-top"> <div class="row"> <div class="" if="{!app.subsStatusLoaded}"> <div class="loading-loader loading" style="z-index: 999;"> <div class="col-sm-12 text-center white"> <div class="spinner black"></div> <div class="loading-message">{langTranslateApp.premiumStatusLoading}...</div> </div> </div> </div> <div class="col-lg-4 col-xs-8 col-sm-4 text-left"> <div class="col-lg-4 col-xs-12 col-sm-4 text-left"> <div if="{!primaryPackageDisconnected}" class="title"><span> {langTranslateApp.premiumStatusSubTitle1} 100% {langTranslateApp.premiumStatusSubTitle2} </span></div> </div> <div if="{primaryPackageDisconnected}" class="col-lg-8 col-xs-8 col-sm-8 text-left"> <div class="title title-two">{langTranslateApp.premiumStatusTitle1}</div> </div> <div if="{!primaryPackageDisconnected}" class="col-lg-4 col-xs-12 col-sm-4 text-left"> <div class="icon-status"> <div class="icon-bx-top"> <div class="icon-ppremium {app.subsStatus.activePremiumClass}"> </div> <div class="icon-streaming {app.subsStatus.dstvNowPlayClass}"> </div> <div if="{isShowMaxApplicable}" class="icon-showmax {app.subsStatus.showmaxPlayClass}"> </div> <div if="{!app.isLiberia}" class="icon-bxoffice {app.subsStatus.boxOfficeRentalClass}"> </div> <div class="icon-explore {app.subsStatus.exploraClass}"> </div> <div class="icon-pvr {app.subsStatus.pvrClass}"> </div> </div> <div class="clearfix"></div> </div> </div> </div> <div class="col-lg-4 col-xs-4 col-sm-4 text-left premium-bx-top-last"> <a id="findOutMore" action="findoutmore" if="{!primaryPackageDisconnected && !app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onFindOutMore}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusFindOutMore}</span></span> </div> </a> <a id="upgrade" action="upgrade" if="{app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onUpgradeNow}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusUpgradeNow}</span></span> </div> </a> <a id="reconnect" action="reconnect" if="{primaryPackageDisconnected && !app.showUpgradeSection}" class="btnPremium" href="javascript:void(0);" onclick="{onReconnectNow}"> <div class="btnDiv"> <span class="btn btn-primary"><span>{langTranslateApp.premiumStatusReconnectNow}</span></span> </div> </a> </div> </div></div>','','',function(opts){var self=this;self.isPremiumStatusApplicable=dstvApp.ShowPremiumStatus&&dstvApp.premiumStatusCountryList.includes(dstvApp.countryabbreviation);self.isShowMaxApplicable=dstvApp.showmaxATBcountryList.includes(dstvApp.countryabbreviation);app.score=app.subsStatus?app.subsStatus.score:0;if(app.isCurrDVSSmartcard){self.isPremiumStatusApplicable=false;}
else{self.isPremiumStatusApplicable=true;}
if(app.smartcards){self.smartcardForSubscriberStatus=app.smartcards.filter(x=>x.primaryService&&x.SerialNumber==app.smartcard)[0];let smartcardStatus=self.smartcardForSubscriberStatus?self.smartcardForSubscriberStatus.primaryService.status.toUpperCase():null;self.disconnectedSmartcard=smartcardStatus=='DISCONNECTED'||smartcardStatus=='PENDING'||smartcardStatus=='SUSPENDED';if(self.disconnectedSmartcard){self.primaryPackageDisconnected=true;app.score=0;}}
self.onFindOutMore=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showChangePackage");riot.mount('tag-dash-premium-status',{showComponent:true});}
self.onUpgradeNow=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showChangePackage");if(app.subsStatus)
riot.mount('tag-dash-premium-status',{showComponent:true});else
riot.mount('tag-dash-premium-status',{showComponent:true,showOnlyPremiumCard:true});}
self.onReconnectNow=function(e){self.LogAnalyticsData(e);window.HandleActiveTab("showPayment");}
self.LogAnalyticsData=function(e){let action=e.currentTarget.attributes["action"].value;let dataForAnalytics=app.subscriberPremiumStatus?app.subscriberPremiumStatus.subscriberStatus[0]:null;if(dataForAnalytics){window.dataLayer=window.dataLayer||[];dataLayer.push({event:'100Percent_Premium_'+action,customernumber:dataForAnalytics.customerNumber,accountnumber:dataForAnalytics.accountNumber});}}})
riot.tag2('tag-dash-get-streaming-live','<div class="modal fade dashboardModal view-sub-add-onns sreamingPopupDash" id="commonModalPopup2" role="dialog"> <div class="webform container modal-dialog modal-lg feedback-dialog"> <div class="modal-content"> <div class="modal-body"> <div class="container-fluid main-section"> <div class="popup {indicatorTypeClass}"> <div class="row"> <div class="modal-content-inner"> <div class="center-holder"> <section class="streaming_account_new content-wrappers Fix-error-section-main clearfix responseWrapperFix do-you-know"><button type="button" class="payment-close streaming-live-button icon-Close_M" href="javascript:void(0)" onclick={ModalClose0101} data-dismiss="modal"></button> <div class="Fix-error-content-section"> <div class="Fix-error-package"> <div class="container-fluid main-section"> <div class="popup success dashBoardStreaminPopup"> <div class="row"> <h2 class="streaming-info-main">Did you know?</h2> <h5 class="streaming-info">With every DStv subscription, you get free <br>Streaming experience on upto 4 devices. <br> You can access it from "MORE" section.</h5> <div class="streaming-btn"> <span class="not-stream-activate">Streaming not activated ?</span> <!--<button class="btn btn-white non-activate-btn" id="not-activated-streaming"><span class="">Streaming not activated?</span> </button>--> <button class="btn btn-white activate-btn" id="activated-streaming" onclick={GetActivateStreaming}><span class="">Activate Streaming</span> </button> </div> </div> <div class="Wrapper-white"><p class="bottom-info">To enjoy streaming on more devices Subscribe to DStv via Streaming account.</p> <a href="javascript:void(0)" onclick={GetStreamingNow} class="cta success-btn did-streaming">Get DStv Streaming now</a> </div> </div> </div> </div> </div></section></div> </div></div> </div> </div> <div class="clearfix"></div> </div> </div> </div></div>','tag-dash-get-streaming-live,[riot-tag="tag-dash-get-streaming-live"],[data-is="tag-dash-get-streaming-live"]{ visibility: visible; } tag-dash-get-streaming-live select,[riot-tag="tag-dash-get-streaming-live"] select,[data-is="tag-dash-get-streaming-live"] select{ display: none !important; }           ','',function(opts){var self=this;self.on('mount',function(){if(opts.showmodel){$('#commonModalPopup2').modal('show');self.update();}});self.GetStreamingNow=function(){app.loggedin=false;window.SessionSave("app",app);window.open(window.location.origin+window.culture+'/mydstv-account?journey=dvs&product=PREMOTT','_blank')}
self.GetActivateStreaming=function(){window.open(dstvApp.DstvNowURL,'_blank');}
self.ModalClose0101=function(e){if(typeof opts.callback==='function')
opts.callback();}})
riot.tag2('tag-dash-cancel-streaming','<div class="modal fade sreamingPopupDash CancelStreamingModal view-sub-add-onns" id="commonModalPopup3" role="dialog"> <div class="webform container modal-dialog modal-lg feedback-dialog"> <div class="modal-content"> <div class="modal-body"> <div class="container-fluid main-section"> <div class="popup {indicatorTypeClass}"> <div class="row"> <div class="modal-content-inner"> <div> <button type="button" class="payment-close streaming-live-button icon-Close_M" href="javascript:void(0)" onclick={ModalClose002} data-dismiss="modal"></button> <section class="dashBoardStreaminPopup content-wrappers Fix-error-section-main clearfix responseWrapperFix do-you-know"> <div class="Fix-error-content-section"> <div class="Fix-error-package"> <div class="container-fluid main-section"> <div class="popup success "> <div class="row"> <h2 class="streaming-info-main">Cancellation</h2> <h5 class="streaming-info">Sorry to know you want to Cancel the subscription, <br> Please contact our customer care. <br> <strong>+254711066000</strong> </h5> <div class="streaming-btn"> <button class="btn btn-white activate-btn" onclick={ModalClose002} data-dismiss="modal" ><span class="">Okay</span></button> </div> </div> <div class="Wrapper-white"> <p class="bottom-info-main">Not a customer?</p> <p class="bottom-info">To enjoy streaming on more devices Subscribe to DStv via Streaming account.</p> <a href="javascript:void(0)" onclick={GetStreamingNow} class="cta success-btn did-streaming">Get DStv Streaming now</a> </div> </div> </div> </div> </div> </section> </div> </div> </div> </div> </div> <div class="clearfix"></div> </div> </div> </div></div>','tag-dash-cancel-streaming,[riot-tag="tag-dash-cancel-streaming"],[data-is="tag-dash-cancel-streaming"]{ visibility: visible; } tag-dash-cancel-streaming select,[riot-tag="tag-dash-cancel-streaming"] select,[data-is="tag-dash-cancel-streaming"] select{ display: none !important; }','',function(opts){var self=this;self.on('mount',function(){if(opts.showmodel){$('#commonModalPopup3').modal('show');self.update();}});self.GetStreamingNow=function(){app.loggedin=false;window.SessionSave("app",app);window.open(window.location.origin+window.culture+'/mydstv-account?journey=dvs','_blank')}
self.ModalClose002=function(e){if(typeof opts.callback==='function')
opts.callback();}})
riot.tag2('tag-dash-package-section','<section class="package-section-main clearfix collapsible2"> <span id="close-message2" class="close-message2"></span> <div class="d-flex relative align-items-center justify-content-between"> <div class="mb-4"> <h4>{langTranslateApp.accountmessage1}</h4> </div> <span class="arrows-package"></span> </div> <div class="package-slider-new package-slider"> <div class="packageItem {package.title || package.properties.Name}" each="{package, index in currentUmbracoPackages}"> <div class="backgroun-img"></div> <div class="dvs-packages"> <i class="icon-pack icon-{package.properties.Code}"></i> <img if="{app.isCurrDVSSmartcard}" src="/media/11918/streaming-icon.svg" alt="Decoder Explora Image" class="live-stream-img pull-right"> </div> <div class="price single-currency"><span if="{dstvApp.countryabbreviation == \'et\'}" class="text-uppercase">{"USD  "+package.properties.Price}</span><span if="{dstvApp.countryabbreviation != \'et\'}" class="text-uppercase">{dstvApp.countrycurrency+" "+package.properties.Price}</span></div> <div class="price dual-currency" if="{package.properties.localPrice}"><span class="text-uppercase">{package.properties.localPrice.currency+" "+package.properties.localPrice.price}</span></div> <div class="bottomBar pricebar"> <div class="Get-now"><a href="javascript:void(0)" class="btn-package package_{package.title}" onclick="{PackageGetNow}" package="{package.title}">{langTranslateApp.accountcardgetnow}</a></div> <div class="Konw-more"><a href="javascript:void(0)" class="btn-package" onclick="{PackageKnowMore}" package="{package.title}">{langTranslateApp.knowMore}</a></div> </div> </div> </div> </div></section>','tag-dash-package-section,[riot-tag="tag-dash-package-section"],[data-is="tag-dash-package-section"]{ visibility: visible; } tag-dash-package-section select,[riot-tag="tag-dash-package-section"] select,[data-is="tag-dash-package-section"] select{ display: none !important; }','',function(opts){var self=this;self.isDualBand=dstvApp.dualBandCountries.includes(dstvApp.countryabbreviation);self.on('mount',function(){self.currentUmbracoPackages=app.umbracopackages;self.update();});self.PackageGetNow=function(e){self.hideChangePackage=dstvApp.NoChangePackageCountryList.includes(dstvApp.countryabbreviation);if(self.hideChangePackage){site.factory.ShowModelPopup('success','','Option for change of package is currently not available online. Please call us on the 4668585 or send an email to DStvcustomerservice@vitiro.org','',false,true);return;}
window.HandleActiveTab("showChangePackage")}
self.PackageKnowMore=function(e){let packageDetailsURL='';let selectedPackage='';let selectedPackageCode='';let selectedPackageObj='';if(app.isCurrDVSSmartcard){selectedPackage=e.item.package.properties.Terms.split('/').pop()
packageDetailsURL=`https://www.dstv.com${window.culture}/buy/dstv-packages/${selectedPackage}`;if(dstvApp.language.toLowerCase()=='portuguese')
packageDetailsURL=`https://www.dstv.com${window.culture}/adira/pacotes/${selectedPackage}`;}else if(dstvApp.packages&&dstvApp.packages.length>0&&dstvApp.configPackagesCountryList.includes(dstvApp.countryabbreviation)){if(!self.isDualBand)
selectedPackage=e.item.package.properties.Name.toLowerCase().replaceAll(new RegExp('streaming|subscription','gi'),'').trim().replace(/\s+/g,'-');else{selectedPackageCode=e.item.package.properties.Code.replaceAll('-','');selectedPackageObj=dstvApp.packages.filter(x=>x.properties.Code.toLowerCase()==selectedPackageCode.toLowerCase());selectedPackage=selectedPackageObj?selectedPackageObj[0].properties.Name.toLowerCase().replaceAll(new RegExp('streaming|subscription|dstv','gi'),'').trim().replace(/\s+/g,'-'):'';}
packageDetailsURL=`https://www.dstv.com${window.culture}/buy/dstv-packages/dstv-${selectedPackage}`;if(dstvApp.language.toLowerCase()=='portuguese')
packageDetailsURL=`https://www.dstv.com${window.culture}/adira/pacotes/dstv-${selectedPackage}`;}else{selectedPackageCode=e.item.package.properties.Code.replaceAll('-','');selectedPackageObj=dstvApp.packages.filter(x=>x.properties.Code.toLowerCase()==selectedPackageCode.toLowerCase());selectedPackage=selectedPackageObj?selectedPackageObj[0].properties.Name.toLowerCase().replaceAll(new RegExp('streaming|subscription|dstv','gi'),'').trim().replace(/\s+/g,'-'):'';packageDetailsURL=`${window.culture}/packages/dstv-${selectedPackage}`;}
window.RedirectTargetOrgin(e,packageDetailsURL);}})
window.getErrorCodes=function(){if(dstvApp.EnableSecurityAuth){let ErrorCodesUrl=dstvApp.SecurityAuthBaseUrl+`apifixerror/api/v2/GetErrorCodeList?BusinessUnit=${dstvApp.businessunit}&Channel=mydstv&Country=${dstvApp.country}&LanguageCode=${dstvApp.languageAbbreviation}`;site.factory.Get(ErrorCodesUrl,null,self.onGetPremContentSuccessNew,self.onGetPremContentErrorNew,false,false,true);}
else{if(dstvApp.enableFixErrorAPI){if(!self.token){site.factory.GetJWT().then(function(token){self.token=token;let ErrorCodesUrl=dstvApp.DSOAPIUrl+`apifixerror/api/v2/GetErrorCodeList?BusinessUnit=${dstvApp.businessunit}&Channel=mydstv&Country=${dstvApp.country}&LanguageCode=${dstvApp.languageAbbreviation}`;site.factory.Get(ErrorCodesUrl,self.token,self.onGetPremContentSuccessNew,self.onGetPremContentErrorNew);});}else
{let ErrorCodesUrl=dstvApp.DSOAPIUrl+`apifixerror/api/v2/GetErrorCodeList?BusinessUnit=${dstvApp.businessunit}&Channel=mydstv&Country=${dstvApp.country}&LanguageCode=${dstvApp.languageAbbreviation}`;site.factory.Get(ErrorCodesUrl,self.token,self.onGetPremContentSuccessNew,self.onGetPremContentErrorNew);}}
else{if(window.culture.includes("pt")){fetch(`/generic-error-codes-pt/ujson?children=true&select=code,errorCodeName,errorCodeDetail,errorCodeHowToFix,isInstallerDriven,isCustomerDriven,isApiDriven,resetCode,videoLink&cdv=`+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetPremContentSuccess(commits));}else{fetch(`/generic-error-codes-en/ujson?children=true&select=code,errorCodeName,errorCodeDetail,errorCodeHowToFix,isInstallerDriven,isCustomerDriven,isApiDriven,resetCode,videoLink&cdv=`+(new Date().getTime())).then(response=>response.json()).then(commits=>self.onGetPremContentSuccess(commits));}}}}
self.onGetPremContentSuccess=function(data){console.log('Fix-Error : Success in fetching Umbraco content');if(data&&data.entities.length>0)
app.errorCodesList=data;console.log('Fix-Error : Error code list : '+app.errorCodesList);}
self.onGetPremContentSuccessNew=function(data){console.log('Fix-Error : Success in fetching API content');if(data&&data.ErrorCodeCollectionByBusinessUnit.length>0)
app.errorCodesList=data;console.log('Fix-Error : Error code list : '+app.errorCodesList);}
self.onGetPremContentErrorNew=function(data){console.log('Fix-Error : API Error');}